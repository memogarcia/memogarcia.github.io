import{r as e,a as t,R as r}from"./vendor-X31hiD63.js";import{c as s,C as n,a as o}from"./utils-C2KGuT2a.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var a={exports:{}},i={},c=e,l=Symbol.for("react.element"),d=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,m=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function h(e,t,r){var s,n={},o=null,a=null;for(s in void 0!==r&&(o=""+r),void 0!==t.key&&(o=""+t.key),void 0!==t.ref&&(a=t.ref),t)u.call(t,s)&&!p.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===n[s]&&(n[s]=t[s]);return{$$typeof:l,type:e,key:o,ref:a,props:n,_owner:m.current}}i.Fragment=d,i.jsx=h,i.jsxs=h,a.exports=i;var x=a.exports,f={},g=t;f.createRoot=g.createRoot,f.hydrateRoot=g.hydrateRoot;const b=[];for(let B=0;B<256;++B)b.push((B+256).toString(16).slice(1));let y;const v=new Uint8Array(16);const j={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function w(e,t,r){var s;if(j.randomUUID&&!e)return j.randomUUID();const n=(e=e||{}).random??(null==(s=e.rng)?void 0:s.call(e))??function(){if(!y){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");y=crypto.getRandomValues.bind(crypto)}return y(v)}();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=15&n[6]|64,n[8]=63&n[8]|128,function(e,t=0){return(b[e[t+0]]+b[e[t+1]]+b[e[t+2]]+b[e[t+3]]+"-"+b[e[t+4]]+b[e[t+5]]+"-"+b[e[t+6]]+b[e[t+7]]+"-"+b[e[t+8]]+b[e[t+9]]+"-"+b[e[t+10]]+b[e[t+11]]+b[e[t+12]]+b[e[t+13]]+b[e[t+14]]+b[e[t+15]]).toLowerCase()}(n)}function N(e){if(!e||"string"!=typeof e)return{isValid:!1,sanitized:"",error:"Title is required"};const t=e.trim();return 0===t.length?{isValid:!1,sanitized:"",error:"Title cannot be empty"}:t.length>100?{isValid:!1,sanitized:t.substring(0,100),error:"Title too long"}:{isValid:!0,sanitized:t,error:null}}function D(e){if("string"!=typeof e)return{isValid:!1,sanitized:"",error:"Content must be a string"};const t=e.trim();return t.length>5e3?{isValid:!1,sanitized:t.substring(0,5e3),error:"Content too long"}:{isValid:!0,sanitized:t,error:null}}function C(e,t){let r;const s=function(...s){clearTimeout(r),r=setTimeout(()=>{clearTimeout(r),e(...s)},t)};return s.cancel=function(){clearTimeout(r)},s.flush=function(){clearTimeout(r),e.apply(this,arguments)},s}const S={saveDocuments(e){try{localStorage.setItem("writer-documents",JSON.stringify(e))}catch(t){console.error("Failed to save documents:",t)}},loadDocuments(){try{const e=localStorage.getItem("writer-documents");return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load documents:",e),[]}},saveCurrentDocumentId(e){try{localStorage.setItem("writer-current-document",e||"")}catch(t){console.error("Failed to save current document ID:",t)}},loadCurrentDocumentId(){try{return localStorage.getItem("writer-current-document")}catch(e){return console.error("Failed to load current document ID:",e),null}},saveClipboard(e){try{localStorage.setItem("writer-clipboard",JSON.stringify(e))}catch(t){console.error("Failed to save clipboard:",t)}},loadClipboard(){try{const e=localStorage.getItem("writer-clipboard");return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load clipboard:",e),[]}}},k=()=>{if("undefined"==typeof window)return{documents:[],currentDocument:null,clipboard:[],isAuthenticated:!1,userInfo:null,editorSettings:{fontFamily:"system-ui, -apple-system, sans-serif",fontSize:16}};const e=S.loadDocuments(),t=S.loadCurrentDocumentId(),r=e.find(e=>e.id===t)||null,s=S.loadClipboard(),n=localStorage.getItem("editorSettings");return{documents:e,currentDocument:r,clipboard:s,history:[],isAuthenticated:!1,userInfo:null,editorSettings:n?JSON.parse(n):{fontFamily:"system-ui, -apple-system, sans-serif",fontSize:16}}},I=(e,t,r,s,n)=>{var o;const a={id:w(),timestamp:(new Date).toISOString(),action:t,documentId:(null==(o=e.currentDocument)?void 0:o.id)||"",description:r,previousValue:s,newValue:n};return{history:[...e.history.slice(-99),a]}},E=s((e,t)=>({...k(),selectedParagraphId:null,activeToolTab:"clipboard",globalPreviewMode:!1,editorMode:"edit",searchTerm:"",isLoading:!1,error:null,loadDocuments:async()=>{e({isLoading:!0,error:null});try{const t=S.loadDocuments();e({documents:t,isLoading:!1})}catch(t){e({error:t.message,isLoading:!1})}},createDocument:async r=>{const s=N(r);if(!s.isValid)return null;const n={id:w(),title:s.sanitized,paragraphs:[],createdAt:new Date,updatedAt:new Date};try{e(e=>({documents:[...e.documents,n],currentDocument:n}));const r=[...t().documents];return S.saveDocuments(r),S.saveCurrentDocumentId(n.id),n}catch(o){return console.error("Document creation failed:",o),null}},updateDocumentTitle:async r=>{if(!t().currentDocument)return;const s=N(r);if(!s.isValid)return;const n=s.sanitized;try{e(e=>{if(!e.currentDocument)return e;const t={...e.currentDocument,title:n,updatedAt:new Date},r=e.documents.map(e=>e.id===t.id?t:e);return S.saveDocuments(r),{currentDocument:t,documents:r}})}catch(o){throw console.error("Document title update failed:",o),o}},deleteDocument:t=>{try{e(e=>{var r;const s=e.documents.filter(e=>e.id!==t),n=(null==(r=e.currentDocument)?void 0:r.id)===t?null:e.currentDocument;return S.saveDocuments(s),n?S.saveCurrentDocumentId(n.id):S.saveCurrentDocumentId(null),{documents:s,currentDocument:n}})}catch(r){throw console.error("Document deletion failed:",r),r}},selectDocument:r=>{try{const s=t().documents.find(e=>e.id===r);if(!s)return;e({currentDocument:s}),S.saveCurrentDocumentId(r)}catch(s){throw console.error("Document selection failed:",s),s}},addParagraphWithoutHistory:(t,r)=>{const s=D(t);if(!s.isValid)return;const n=s.sanitized,o={id:w(),content:n,createdAt:new Date,updatedAt:new Date};e(e=>{if(!e.currentDocument)return e;const t=[...e.currentDocument.paragraphs];void 0!==r&&r>=0&&r<=t.length?t.splice(r,0,o):t.push(o);const s={...e.currentDocument,paragraphs:t,updatedAt:new Date},n=e.documents.map(e=>e.id===s.id?s:e);return S.saveDocuments(n),{currentDocument:s,documents:n}})},addParagraph:(e,r)=>{t().addParagraphWithoutHistory(e,r)},updateParagraph:(r,s)=>{const n=t().currentDocument;if(!n)return;const o=D(s);if(!o.isValid)return;const a=o.sanitized,i=n.paragraphs.find(e=>e.id===r);if(i)try{e(e=>{if(!e.currentDocument)return e;const t={...e.currentDocument,paragraphs:e.currentDocument.paragraphs.map(e=>e.id===r?{...e,content:a,updatedAt:new Date}:e),updatedAt:new Date},s=e.documents.map(e=>e.id===t.id?t:e);return S.saveDocuments(s),{currentDocument:t,documents:s,...I(e,"paragraph_updated","Updated paragraph content",i.content,a)}})}catch(c){throw console.error("Paragraph update failed:",c),c}},deleteParagraph:t=>{e(e=>{if(!e.currentDocument)return e;const r={...e.currentDocument,paragraphs:e.currentDocument.paragraphs.filter(e=>e.id!==t),updatedAt:new Date},s=e.documents.map(e=>e.id===r.id?r:e);return S.saveDocuments(s),{currentDocument:r,documents:s}})},addParagraphAfter:(r,s)=>{const{currentDocument:n}=t();if(!n)return"";const o={id:w(),content:r,createdAt:new Date,updatedAt:new Date},a=n.paragraphs.findIndex(e=>e.id===s),i=[...n.paragraphs];i.splice(a+1,0,o),e(e=>({currentDocument:e.currentDocument?{...e.currentDocument,paragraphs:i}:null,documents:e.documents.map(e=>e.id===n.id?{...e,paragraphs:i}:e)}));const c=t().documents;return S.saveDocuments(c),o.id},reorderParagraphs:(r,s)=>{const{currentDocument:n}=t();if(!n)return;const o=[...n.paragraphs],[a]=o.splice(r,1);o.splice(s,0,a),e(e=>({currentDocument:e.currentDocument?{...e.currentDocument,paragraphs:o}:null,documents:e.documents.map(e=>e.id===n.id?{...e,paragraphs:o}:e)}));const i=t().documents;S.saveDocuments(i)},selectParagraph:t=>{e({selectedParagraphId:t})},replaceParagraphs:t=>{e(e=>{if(!e.currentDocument)return e;const r=t.map(e=>({id:w(),content:e,createdAt:new Date,updatedAt:new Date})),s={...e.currentDocument,paragraphs:r,updatedAt:new Date},n=e.documents.map(e=>e.id===s.id?s:e);return S.saveDocuments(n),{currentDocument:s,documents:n,...I(e,"paragraphs_replaced",`Replaced all paragraphs (${r.length} new)`,e.currentDocument.paragraphs,r)}})},addToClipboard:(r,s,n,o)=>{const a={id:w(),content:r,note:s,savedAt:new Date,sourceParagraphId:n,sourceDocumentId:o};try{e(e=>({clipboard:[a,...e.clipboard]}));const r=t().clipboard;S.saveClipboard(r)}catch(i){throw console.error("Clipboard addition failed:",i),i}},removeFromClipboard:r=>{try{e(e=>({clipboard:e.clipboard.filter(e=>e.id!==r)}));const s=t().clipboard;S.saveClipboard(s)}catch(s){throw console.error("Clipboard removal failed:",s),s}},restoreFromClipboard:(e,r)=>{const s=t(),n=s.clipboard.find(t=>t.id===e);n&&(s.addParagraph(n.content,r),s.removeFromClipboard(e))},updateClipboardNote:(r,s)=>{e(e=>({clipboard:e.clipboard.map(e=>e.id===r?{...e,note:s}:e)}));const n=t().clipboard;S.saveClipboard(n)},setActiveToolTab:t=>{e({activeToolTab:t})},setGlobalPreviewMode:t=>{e({globalPreviewMode:t})},setEditorMode:t=>{e({editorMode:t}),e({globalPreviewMode:"preview"===t})},updateEditorSettings:t=>{e(e=>{const r={...e.editorSettings,...t};return localStorage.setItem("editorSettings",JSON.stringify(r)),{editorSettings:r}})},setSearchTerm:t=>{e({searchTerm:t})}})),L=C(e=>{S.saveDocuments(e)},1e3),A=C(e=>{S.saveClipboard(e)},500);if("undefined"!=typeof window){let e=[],t=[],r=null;const s=E.subscribe(s=>{var n;s.documents!==e&&(e=s.documents,L(s.documents)),s.clipboard!==t&&(t=s.clipboard,A(s.clipboard));const o=(null==(n=s.currentDocument)?void 0:n.id)||null;o!==r&&(r=o,S.saveCurrentDocumentId(o))});window.addEventListener("beforeunload",()=>{var e,t;s(),null==(e=L.flush)||e.call(L),null==(t=A.flush)||t.call(A)})}function T({onOpenSettings:e}){const{documents:t,createDocument:r,selectDocument:s,currentDocument:n}=E();return x.jsxs("div",{className:"h-full flex flex-col",children:[x.jsx("div",{className:"p-4",children:x.jsx("button",{onClick:()=>r(`Document ${t.length+1}`),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-accent text-bg rounded-lg hover:bg-accent-dark transition-colors",children:"âž• New Document"})}),x.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:0===t.length?x.jsxs("div",{className:"text-center text-muted py-8",children:[x.jsx("div",{style:{fontSize:"48px",opacity:.5,marginBottom:"12px"},children:"ðŸ“„"}),x.jsx("p",{className:"text-sm",children:"No documents yet"}),x.jsx("p",{className:"text-xs mt-1",children:"Create your first document to get started"})]}):x.jsx("div",{className:"space-y-1",children:t.map(e=>{var t;return x.jsx("div",{onClick:()=>s(e.id),className:"group px-3 py-3 rounded-lg cursor-pointer transition-colors hover:bg-hover "+((null==n?void 0:n.id)===e.id?"bg-hover":""),children:x.jsx("div",{className:"flex items-start justify-between gap-2",children:x.jsxs("div",{className:"flex-1 min-w-0",children:[x.jsx("h3",{className:"font-medium text-primary truncate",children:e.title}),x.jsx("p",{className:"text-xs text-muted mt-1",children:new Date(e.updatedAt).toLocaleDateString()}),x.jsxs("p",{className:"text-xs text-muted",children:[(null==(t=e.paragraphs)?void 0:t.length)||0," paragraphs"]})]})})},e.id)})})}),e&&x.jsx("div",{className:"p-4 border-t border-border",children:x.jsxs("button",{onClick:e,className:"w-full flex items-center gap-2 px-4 py-2 text-secondary hover:text-primary hover:bg-hover rounded-lg transition-colors",children:["âš™ï¸ ",x.jsx("span",{className:"text-sm font-medium",children:"Settings"})]})})]})}function P({showBorders:t=!0}){var r,s;const{currentDocument:n,updateDocumentTitle:o,addParagraph:a,updateParagraph:i,deleteParagraph:c}=E(),[l,d]=e.useState("");if(!n)return x.jsx("div",{className:"flex-1 flex items-center justify-center text-muted",children:x.jsx("p",{children:"Select or create a document to start writing"})});const u=e=>{e.preventDefault(),l.trim()&&(a(l.trim()),d(""))};return x.jsxs("div",{className:"h-full flex flex-col",children:[x.jsx("div",{className:(t?"border-b border-border":"")+" bg-bg",children:x.jsx("div",{className:"max-w-4xl mx-auto px-8 py-4",children:x.jsx("h1",{onClick:()=>{const e=prompt("Enter new title:",n.title);e&&e.trim()!==n.title&&o(e.trim())},className:"text-2xl font-semibold text-primary cursor-pointer hover:opacity-80 transition-opacity",title:"Click to edit title",children:n.title})})}),x.jsx("div",{className:"flex-1 overflow-y-auto",children:x.jsxs("div",{className:"max-w-4xl w-full mx-auto px-8 py-8",children:[0===(null==(r=n.paragraphs)?void 0:r.length)?x.jsx("div",{className:"text-center py-16 text-muted cursor-text min-h-[400px] flex items-center justify-center",children:x.jsxs("div",{children:[x.jsx("p",{className:"text-lg mb-2",children:"Your document is empty"}),x.jsx("p",{className:"text-sm",children:"Add your first paragraph below"})]})}):x.jsx("div",{className:"space-y-4",children:null==(s=n.paragraphs)?void 0:s.map((e,t)=>x.jsx(z,{paragraph:e,onUpdate:i,onDelete:c,onAddAfter:e=>a(e,t+1)},e.id))}),x.jsxs("form",{onSubmit:u,className:"mt-8",children:[x.jsx("textarea",{value:l,onChange:e=>d(e.target.value),placeholder:"Write your next paragraph...",className:"w-full p-4 border border-border rounded-lg bg-bg text-primary placeholder:text-muted resize-none focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent",rows:3,onKeyDown:e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),u(e))}}),x.jsx("div",{className:"mt-2 flex justify-end",children:x.jsx("button",{type:"submit",className:"px-4 py-2 bg-accent text-bg rounded-lg hover:bg-accent-dark transition-colors disabled:opacity-50",disabled:!l.trim(),children:"Add Paragraph (Ctrl+Enter)"})})]})]})})]})}function z({paragraph:t,onUpdate:r,onDelete:s,onAddAfter:n}){const[o,a]=e.useState(""===t.content),[i,c]=e.useState(t.content),l=()=>{i.trim()!==t.content&&r(t.id,i.trim()),a(!1)},d=()=>{c(t.content),a(!1)};return x.jsxs("div",{className:"group relative p-4 border border-transparent hover:border-border rounded-lg transition-colors",children:[o?x.jsxs("div",{children:[x.jsx("textarea",{value:i,onChange:e=>c(e.target.value),className:"w-full p-3 border border-border rounded-lg bg-bg text-primary resize-none focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent",rows:Math.max(3,i.split("\n").length),autoFocus:!0,onKeyDown:e=>{"Escape"===e.key?d():"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),l())}}),x.jsxs("div",{className:"mt-2 flex gap-2",children:[x.jsx("button",{onClick:l,className:"px-3 py-1 bg-accent text-bg rounded text-sm hover:bg-accent-dark transition-colors",children:"Save (Ctrl+Enter)"}),x.jsx("button",{onClick:d,className:"px-3 py-1 border border-border text-secondary rounded text-sm hover:bg-hover transition-colors",children:"Cancel (Esc)"})]})]}):x.jsx("div",{onClick:()=>a(!0),className:"cursor-text",children:x.jsx("div",{className:"text-primary whitespace-pre-wrap",style:{minHeight:"1.5rem"},children:t.content||"Click to edit..."})}),x.jsxs("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1",children:[x.jsx("button",{onClick:()=>{window.confirm("Delete this paragraph?")&&s(t.id)},className:"p-1 text-red-500 hover:bg-red-50 rounded text-sm",title:"Delete paragraph",children:"ðŸ—‘ï¸"}),x.jsx("button",{onClick:()=>n(""),className:"p-1 text-secondary hover:bg-hover rounded text-sm",title:"Add paragraph after",children:"âž•"})]})]})}function R({onClose:t}){const{currentDocument:r}=E(),[s,n]=e.useState("stats"),{wordCount:o,charCount:a,paragraphCount:i}=e.useMemo(()=>{var e;if(!r)return{wordCount:0,charCount:0,paragraphCount:0};let t=0,s=0;const n=(null==(e=r.paragraphs)?void 0:e.length)||0;return(r.paragraphs||[]).forEach(e=>{const r=e.content||"";s+=r.length;const n=r.trim().split(/\s+/).filter(e=>e.length>0);t+=n.length}),{wordCount:t,charCount:s,paragraphCount:n}},[r]);return x.jsxs("div",{className:"h-full flex flex-col bg-bg",children:[x.jsxs("div",{className:"p-4 border-b border-border",children:[x.jsxs("div",{className:"flex items-center justify-between mb-4",children:[x.jsx("h2",{className:"text-lg font-semibold text-primary",children:"Tools"}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>{if(!r)return;let e=`# ${r.title}\n\n`;(r.paragraphs||[]).forEach(t=>{var r;(null==(r=t.content)?void 0:r.trim())&&(e+=`${t.content}\n\n`)});const t=new Blob([e],{type:"text/markdown"}),s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download=`${r.title.replace(/[^a-z0-9]/gi,"-").toLowerCase()}.md`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)},className:"p-2 hover:bg-hover rounded-lg transition-colors text-secondary hover:text-primary",disabled:!r,title:"Export to Markdown",children:"ðŸ“¥ Export"}),t&&x.jsx("button",{onClick:t,className:"p-2 hover:bg-hover rounded-lg transition-colors text-secondary hover:text-primary",title:"Close Tools Panel",children:"âœ•"})]})]}),x.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[x.jsxs("div",{className:"flex flex-col",title:"Word count",children:[x.jsx("div",{className:"text-2xl font-semibold text-primary",children:o.toLocaleString()}),x.jsx("div",{className:"text-xs text-muted mt-1",children:"words"})]}),x.jsxs("div",{className:"flex flex-col",title:"Character count",children:[x.jsx("div",{className:"text-2xl font-semibold text-primary",children:a.toLocaleString()}),x.jsx("div",{className:"text-xs text-muted mt-1",children:"chars"})]}),x.jsxs("div",{className:"flex flex-col",title:"Paragraph count",children:[x.jsx("div",{className:"text-2xl font-semibold text-primary",children:i}),x.jsx("div",{className:"text-xs text-muted mt-1",children:"paragraphs"})]})]})]}),x.jsx("div",{className:"px-4 py-2 border-b border-border",children:x.jsxs("div",{className:"flex gap-1",children:[x.jsx("button",{onClick:()=>n("stats"),className:"px-3 py-2 text-sm rounded-lg transition-colors "+("stats"===s?"bg-accent text-bg":"text-secondary hover:text-primary hover:bg-hover"),children:"ðŸ“Š Stats"}),x.jsx("button",{onClick:()=>n("clipboard"),className:"px-3 py-2 text-sm rounded-lg transition-colors "+("clipboard"===s?"bg-accent text-bg":"text-secondary hover:text-primary hover:bg-hover"),children:"ðŸ“‹ Clipboard"})]})}),x.jsxs("div",{className:"flex-1 overflow-y-auto",children:["stats"===s&&x.jsx("div",{className:"p-4",children:x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"font-medium text-primary mb-2",children:"Document Info"}),r?x.jsxs("div",{className:"space-y-2 text-sm",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-secondary",children:"Title:"}),x.jsx("span",{className:"text-primary",children:r.title})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-secondary",children:"Created:"}),x.jsx("span",{className:"text-primary",children:new Date(r.createdAt).toLocaleDateString()})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-secondary",children:"Modified:"}),x.jsx("span",{className:"text-primary",children:new Date(r.updatedAt).toLocaleDateString()})]})]}):x.jsx("p",{className:"text-muted text-sm",children:"No document selected"})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-medium text-primary mb-2",children:"Reading Time"}),x.jsxs("div",{className:"text-sm text-secondary",children:["~",Math.ceil(o/200)," minutes"]}),x.jsx("div",{className:"text-xs text-muted mt-1",children:"(assuming 200 words/min)"})]})]})}),"clipboard"===s&&x.jsx(O,{})]})]})}function O(){const[t]=e.useState([]);return x.jsx("div",{className:"p-4",children:x.jsxs("div",{className:"text-center py-8",children:[x.jsx("div",{className:"text-4xl mb-2",children:"ðŸ“‹"}),x.jsx("p",{className:"text-muted font-medium mb-1",children:"Clipboard is empty"}),x.jsx("p",{className:"text-sm text-muted/70",children:"Clipboard functionality coming soon"})]})})}function K({isOpen:t,onClose:r}){const{documents:s,currentDocument:n,selectDocument:o}=E(),[a,i]=e.useState(""),[c,l]=e.useState([]),d=e.useRef(null);e.useEffect(()=>{t&&d.current&&d.current.focus()},[t]),e.useEffect(()=>{if(!a.trim())return void l([]);const e=[];s.forEach(t=>{(t.paragraphs||[]).forEach((r,s)=>{r.content&&r.content.toLowerCase().includes(a.toLowerCase())&&e.push({id:`${t.id}-${r.id}`,documentTitle:t.title,documentId:t.id,paragraphId:r.id,content:r.content,paragraphIndex:s})})}),l(e)},[a,s]);return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-start justify-center pt-20",children:x.jsxs("div",{className:"bg-bg border border-border rounded-lg shadow-lg w-full max-w-2xl mx-4",children:[x.jsx("div",{className:"p-4 border-b border-border",children:x.jsx("input",{ref:d,type:"text",value:a,onChange:e=>i(e.target.value),onKeyDown:e=>{"Escape"===e.key&&r()},placeholder:"Search across all documents...",className:"w-full p-3 bg-bg border border-border rounded-lg text-primary placeholder:text-muted focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent"})}),x.jsx("div",{className:"max-h-80 overflow-y-auto",children:a&&0===c.length?x.jsxs("div",{className:"p-4 text-center text-muted",children:['No results found for "',a,'"']}):c.length>0?x.jsx("div",{className:"p-2",children:c.map(e=>x.jsxs("div",{onClick:()=>(e=>{o(e.documentId),r(),setTimeout(()=>{const t=document.getElementById(`paragraph-${e.paragraphId}`);t&&t.scrollIntoView({behavior:"smooth",block:"center"})},100)})(e),className:"p-3 hover:bg-hover rounded-lg cursor-pointer transition-colors border border-transparent hover:border-border",children:[x.jsx("div",{className:"text-sm text-accent font-medium mb-1",children:e.documentTitle}),x.jsx("div",{className:"text-primary text-sm line-clamp-2",children:e.content})]},e.id))}):null}),x.jsx("div",{className:"p-3 border-t border-border text-center",children:x.jsxs("div",{className:"text-xs text-muted",children:["Press ",x.jsx("kbd",{className:"bg-hover px-1 rounded",children:"Escape"})," to close"]})})]})}):null}function M({isOpen:e,onClose:t}){return e?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:x.jsxs("div",{className:"bg-bg border border-border rounded-lg shadow-lg w-full max-w-md",children:[x.jsxs("div",{className:"p-4 border-b border-border flex items-center justify-between",children:[x.jsx("h2",{className:"text-lg font-semibold text-primary",children:"Settings"}),x.jsx("button",{onClick:t,className:"text-secondary hover:text-primary transition-colors",children:"âœ•"})]}),x.jsx("div",{className:"p-4",children:x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"font-medium text-primary mb-2",children:"Keyboard Shortcuts"}),x.jsxs("div",{className:"space-y-2 text-sm",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-secondary",children:"Search"}),x.jsx("kbd",{className:"bg-hover px-2 py-1 rounded text-xs",children:"Ctrl+F"})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-secondary",children:"Focus Mode"}),x.jsx("kbd",{className:"bg-hover px-2 py-1 rounded text-xs",children:"Ctrl+Shift+F"})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-secondary",children:"Toggle Sidebars"}),x.jsx("kbd",{className:"bg-hover px-2 py-1 rounded text-xs",children:"Ctrl+â† / Ctrl+â†’"})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-secondary",children:"Undo / Redo"}),x.jsx("kbd",{className:"bg-hover px-2 py-1 rounded text-xs",children:"Ctrl+Z / Ctrl+Y"})]})]})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-medium text-primary mb-2",children:"About"}),x.jsx("p",{className:"text-sm text-secondary",children:"Writer v1.0 - A structured writing tool for organizing your thoughts and creating well-structured documents."})]})]})}),x.jsx("div",{className:"p-4 border-t border-border flex justify-end",children:x.jsx("button",{onClick:t,className:"px-4 py-2 bg-accent text-bg rounded-lg hover:bg-accent-dark transition-colors",children:"Close"})})]})}):null}function U({toasts:e,onDismiss:t}){return x.jsx("div",{className:"fixed bottom-4 right-4 z-50 space-y-2",children:e.map(e=>x.jsx(F,{toast:e,onDismiss:()=>t(e.id)},e.id))})}function F({toast:t,onDismiss:r}){e.useEffect(()=>{const e=setTimeout(()=>{r()},5e3);return()=>clearTimeout(e)},[r]);return x.jsx("div",{className:`rounded-lg p-4 shadow-lg max-w-sm ${(()=>{switch(t.variant){case"error":return"bg-red-500 text-white";case"success":return"bg-green-500 text-white";case"warning":return"bg-yellow-500 text-black";default:return"bg-bg border border-border text-primary"}})()} transform transition-all duration-300`,children:x.jsxs("div",{className:"flex justify-between items-start",children:[x.jsxs("div",{className:"flex-1",children:[t.title&&x.jsx("div",{className:"font-medium text-sm mb-1",children:t.title}),t.description&&x.jsx("div",{className:"text-sm opacity-90",children:t.description})]}),x.jsx("button",{onClick:r,className:"ml-2 text-sm opacity-70 hover:opacity-100 transition-opacity",children:"âœ•"})]})})}function $(){const[t,r]=e.useState(()=>{if("undefined"!=typeof window){const e=localStorage.getItem("theme");return"dark"===e||!e&&window.matchMedia("(prefers-color-scheme: dark)").matches}return!1});e.useEffect(()=>{t?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},[t]);return x.jsx("button",{onClick:()=>{r(!t)},className:"p-2 hover:bg-hover rounded-lg transition-colors text-secondary hover:text-primary",title:`Switch to ${t?"light":"dark"} theme`,children:t?"ðŸŒž":"ðŸŒ™"})}function W({side:t,onResize:r}){const[s,n]=e.useState(!1),o=e.useRef(0);e.useEffect(()=>{const e=e=>{if(!s)return;const n="left"===t?e.clientX-o.current:o.current-e.clientX;o.current=e.clientX,r(n)},a=()=>{n(!1)};return s&&(document.addEventListener("mousemove",e),document.addEventListener("mouseup",a),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",a),document.body.style.cursor="",document.body.style.userSelect=""}},[s,t,r]);return x.jsx("div",{className:"absolute top-0 bottom-0 w-1 cursor-col-resize hover:bg-accent transition-colors z-10 "+("left"===t?"right-0":"left-0"),onMouseDown:e=>{e.preventDefault(),n(!0),o.current=e.clientX},style:{width:"4px",marginLeft:"right"===t?"-2px":"0",marginRight:"left"===t?"-2px":"0"}})}function _(){const{currentDocument:t,createDocument:r,loadDocuments:s,editorMode:a,setEditorMode:i,isLoading:c,addParagraphWithoutHistory:l}=E(),[d,u]=e.useState(!1),[m,p]=e.useState(!1),[h,f]=e.useState(()=>{if("undefined"!=typeof window){const e=localStorage.getItem("leftSidebarWidth");return e?parseInt(e):280}return 280}),[g,b]=e.useState(()=>{if("undefined"!=typeof window){const e=localStorage.getItem("rightSidebarWidth");return e?parseInt(e):320}return 320}),[y,v]=e.useState(!1),[j,w]=e.useState(!1),{toasts:N,toast:D,dismiss:C}=function(){const[t,r]=e.useState([]),s=e.useCallback(({title:e,description:t,variant:s="default"})=>{const o=Date.now().toString(),a={id:o,title:e,description:t,variant:s,createdAt:Date.now()};return r(e=>[...e,a]),setTimeout(()=>{n(o)},5e3),o},[]),n=e.useCallback(e=>{r(t=>t.filter(t=>t.id!==e))},[]);return{toasts:t,toast:s,dismiss:n}}(),{undo:S,redo:k}={undo:e.useCallback(()=>{console.log("Undo - not implemented yet")},[]),redo:e.useCallback(()=>{console.log("Redo - not implemented yet")},[])};e.useEffect(()=>{localStorage.setItem("leftSidebarWidth",h.toString())},[h]),e.useEffect(()=>{localStorage.setItem("rightSidebarWidth",g.toString())},[g]);const I=()=>{u(!d)},L=()=>{p(!m)},A=()=>{v(!y)},z=()=>{w(!j)};return e.useEffect(()=>{(async()=>{try{await s();const e=E.getState();if(0===(e.documents||[]).length){await r("Welcome to Writer")&&setTimeout(()=>{l("# Welcome to Writer"),l("This is a **structured writing tool** inspired by Jordan Peterson's Essay.app methodology. It helps you organize your thoughts and create well-structured documents."),l("## Key Features"),l("- **Drag and Drop**: Reorder paragraphs by dragging them with the grip handle on the left"),l("- **Markdown Support**: Write using familiar markdown syntax for formatting"),l("- **Local Storage**: Your documents are automatically saved to your browser's local storage"),l("- **Clipboard**: Save paragraphs for later by clicking the archive icon"),l("## Getting Started"),l("1. Start typing in the text box at the bottom of the screen"),l("2. Press Enter to add your paragraph"),l("3. Drag paragraphs to reorder them"),l("4. Use the tools sidebar to access clipboard and table of contents"),l("> Pro tip: You can collapse the sidebars to focus on your writing!")},100)}}catch(e){console.error("Failed to initialize app:",e),D({title:"Connection Error",description:"Failed to initialize the application. Working in offline mode.",variant:"error"})}})()},[s,r,l,D]),e.useEffect(()=>{const e=e=>{if(!e.metaKey&&!e.ctrlKey||"f"!==e.key||e.shiftKey||(e.preventDefault(),A()),!e.metaKey&&!e.ctrlKey||"z"!==e.key||e.shiftKey||(e.preventDefault(),S()),((e.metaKey||e.ctrlKey)&&e.shiftKey&&"z"===e.key||(e.metaKey||e.ctrlKey)&&"y"===e.key)&&(e.preventDefault(),k()),(e.metaKey||e.ctrlKey)&&e.shiftKey&&"f"===e.key){e.preventDefault();const t="focus"===a?"edit":"focus";i(t),D({title:("focus"===t?"Focus":"Edit")+" mode activated",description:"focus"===t?"Use arrow keys to navigate":"Full editing enabled",variant:"success"})}(e.metaKey||e.ctrlKey)&&"ArrowLeft"===e.key&&(e.preventDefault(),I()),(e.metaKey||e.ctrlKey)&&"ArrowRight"===e.key&&(e.preventDefault(),L())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[y,S,k,a,i,D,d,m]),x.jsxs("div",{className:"h-screen flex bg-bg relative",children:[x.jsx("a",{href:"#main-content",className:"skip-link",children:"Skip to main content"}),x.jsx("a",{href:"#left-sidebar",className:"skip-link",children:"Skip to documents"}),x.jsx("a",{href:"#right-sidebar",className:"skip-link",children:"Skip to tools"}),!d&&x.jsx("button",{onClick:I,className:"absolute left-2 top-4 z-10 p-2 hover:bg-hover rounded-md transition-colors","aria-label":"Open left sidebar","aria-expanded":"false","aria-controls":"left-sidebar",title:"Open left sidebar (Ctrl/Cmd + Left Arrow)",children:x.jsx(n,{className:"w-5 h-5 text-secondary"})}),!m&&x.jsx("button",{onClick:L,className:"absolute right-2 top-4 z-10 p-2 hover:bg-hover rounded-md transition-colors","aria-label":"Open right sidebar","aria-expanded":"false","aria-controls":"right-sidebar",title:"Open right sidebar (Ctrl/Cmd + Right Arrow)",children:x.jsx(o,{className:"w-5 h-5 text-secondary"})}),x.jsxs("aside",{id:"left-sidebar",className:`${d?"":"w-0"} transition-all duration-300 ${d?"border-r border-border":""} bg-bg-secondary flex-shrink-0 overflow-hidden relative`,style:d?{width:`${h}px`}:{width:0},"aria-label":"Documents sidebar","aria-hidden":!d,children:[x.jsxs("div",{className:"h-full flex flex-col",style:{width:`${h}px`},children:[x.jsxs("header",{className:"p-4 flex items-center justify-between",children:[x.jsx("h1",{className:"text-xl font-semibold text-primary font-sans",children:"Writer"}),x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx($,{}),x.jsx("button",{onClick:I,className:"p-1 hover:bg-hover rounded-md transition-colors","aria-label":"Close left sidebar","aria-expanded":"true","aria-controls":"left-sidebar",title:"Close left sidebar (Ctrl/Cmd + Left Arrow)",children:x.jsx(o,{className:"w-5 h-5 text-secondary"})})]})]}),x.jsx("div",{className:"flex-1 overflow-hidden",children:x.jsx(T,{onOpenSettings:z})})]}),d&&x.jsx(W,{side:"left",onResize:e=>{f(t=>Math.max(200,Math.min(400,t+e)))}})]}),x.jsx("main",{id:"main-content",className:"flex-1 flex flex-col min-w-0 overflow-hidden",role:"main","aria-label":"Document editor",children:x.jsx(P,{showBorders:d||m})}),x.jsxs("aside",{id:"right-sidebar",className:`${m?"":"w-0"} transition-all duration-300 ${m?"border-l border-border":""} bg-bg-secondary flex-shrink-0 overflow-hidden relative`,style:m?{width:`${g}px`}:{width:0},"aria-label":"Tools sidebar","aria-hidden":!m,children:[m&&x.jsx(W,{side:"right",onResize:e=>{b(t=>Math.max(260,Math.min(500,t+e)))}}),x.jsx("div",{className:"h-full",style:{width:`${g}px`},children:x.jsx(R,{onClose:L})})]}),x.jsx(K,{isOpen:y,onClose:A}),x.jsx(M,{isOpen:j,onClose:z}),x.jsx(U,{toasts:N,onDismiss:C})]})}const V=localStorage.getItem("pref-theme");"dark"===V?document.body.classList.add("dark"):"light"===V&&document.body.classList.remove("dark"),f.createRoot(document.getElementById("root")).render(x.jsx(r.StrictMode,{children:x.jsx(_,{})}));

<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Claude Code Advanced Features: Hooks, Agents, and MCP Servers | Memo Garcia</title>
<meta name=keywords content><meta name=description content="You&rsquo;ve been using Claude Code for basic tasks. Time to unlock its real power.
This tutorial builds a Python task management API from scratch, progressively adding Claude Code&rsquo;s advanced features. Each step produces observable results. No toy examples, no fluff—just practical patterns you&rsquo;ll use daily.
Prerequisites You need:
Claude Code installed and configured Python 3.11+ uv package manager (curl -LsSf https://astral.sh/uv/install.sh | sh) Basic Python and REST API knowledge Part 1: Project Initialization with Hooks Hooks transform repetitive setup into automated workflows."><link rel=canonical href=https://memo.mx/posts/claude-code-advanced-features/><meta name=google-site-verification content="G-ZRB1GGCC9B"><link crossorigin=anonymous href=/assets/css/stylesheet.d1467e28595903f993a7e37893057cefe5f69aece461c850796bf5b0a3bf422a.css integrity="sha256-0UZ+KFlZA/mTp+N4kwV87+X2muzkYchQeWv1sKO/Qio=" rel="preload stylesheet" as=style><link rel=icon href=https://memo.mx/%20favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://memo.mx/%20favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://memo.mx/%20favicon-32x32.png><link rel=apple-touch-icon href=https://memo.mx/%20apple-touch-icon.png><link rel=mask-icon href=https://memo.mx/%20safari-pinned-tab.svg><meta name=theme-color content="#0d0221"><meta name=msapplication-TileColor content="#0d0221"><link rel=alternate hreflang=en href=https://memo.mx/posts/claude-code-advanced-features/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZRB1GGCC9B"></script><script>var dnt,doNotTrack=!1;if(!0&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZRB1GGCC9B")}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://memo.mx/posts/"},{"@type":"ListItem","position":2,"name":"Claude Code Advanced Features: Hooks, Agents, and MCP Servers","item":"https://memo.mx/posts/claude-code-advanced-features/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Claude Code Advanced Features: Hooks, Agents, and MCP Servers","name":"Claude Code Advanced Features: Hooks, Agents, and MCP Servers","description":"You\u0026rsquo;ve been using Claude Code for basic tasks. Time to unlock its real power.\nThis tutorial builds a Python task management API from scratch, progressively adding Claude Code\u0026rsquo;s advanced features. Each step produces observable results. No toy examples, no fluff—just practical patterns you\u0026rsquo;ll use daily.\nPrerequisites You need:\nClaude Code installed and configured Python 3.11+ uv package manager (curl -LsSf https://astral.sh/uv/install.sh | sh) Basic Python and REST API knowledge Part 1: Project Initialization with Hooks Hooks transform repetitive setup into automated workflows.","keywords":[],"articleBody":"You’ve been using Claude Code for basic tasks. Time to unlock its real power.\nThis tutorial builds a Python task management API from scratch, progressively adding Claude Code’s advanced features. Each step produces observable results. No toy examples, no fluff—just practical patterns you’ll use daily.\nPrerequisites You need:\nClaude Code installed and configured Python 3.11+ uv package manager (curl -LsSf https://astral.sh/uv/install.sh | sh) Basic Python and REST API knowledge Part 1: Project Initialization with Hooks Hooks transform repetitive setup into automated workflows. Start with a fresh project.\nStep 1: Create the Basic Hook Create .claude/hooks.yml:\nhooks: pre_command: - name: \"Python Project Setup\" description: \"Initialize Python environment with uv\" triggers: - pattern: \".*\\\\.py$\" action: \"create\" actions: - type: \"shell\" command: | if [ ! -f \"pyproject.toml\" ]; then uv init --name taskapi --python 3.11 uv add fastapi uvicorn sqlalchemy pydantic echo \"✓ Python environment initialized\" fi Now create your first Python file:\n# main.py from fastapi import FastAPI app = FastAPI(title=\"Task API\") @app.get(\"/health\") def health_check(): return {\"status\": \"healthy\"} Watch the hook trigger automatically. Your environment materializes without manual intervention.\nStep 2: Add Development Hooks Extend .claude/hooks.yml:\nhooks: pre_command: - name: \"Python Project Setup\" # ... previous config ... - name: \"Auto-format on save\" triggers: - pattern: \".*\\\\.py$\" action: \"edit\" actions: - type: \"shell\" command: \"uv run ruff format ${file}\" post_command: - name: \"Type checking\" triggers: - pattern: \".*\\\\.py$\" action: \"edit\" condition: \"git diff --name-only | grep -q '\\\\.py$'\" actions: - type: \"shell\" command: \"uv run mypy ${file} --ignore-missing-imports\" Edit any Python file. Formatting happens automatically. Type errors surface immediately.\nObservable Result Run the API:\nuv run uvicorn main:app --reload Visit http://localhost:8000/health. Your development environment is now self-maintaining.\nPart 2: Specialized Agents Agents bring domain expertise to your project. Each agent excels at specific tasks.\nStep 3: Configure Domain Agents Create .claude/agents.yml:\nagents: api-architect: description: \"REST API design and implementation\" expertise: - \"FastAPI patterns and best practices\" - \"SQLAlchemy ORM optimization\" - \"API versioning strategies\" instructions: | Design APIs following REST principles. Use dependency injection for database sessions. Implement proper error handling with status codes. Always include OpenAPI documentation. database-engineer: description: \"Database schema and query optimization\" expertise: - \"SQLAlchemy model design\" - \"Migration strategies with Alembic\" - \"Query performance optimization\" instructions: | Design normalized schemas. Create appropriate indexes. Use async database operations. Write efficient queries avoiding N+1 problems. test-engineer: description: \"Comprehensive testing implementation\" expertise: - \"pytest fixtures and parametrization\" - \"FastAPI test client usage\" - \"Database test isolation\" instructions: | Write tests before implementation. Use fixtures for test data. Mock external dependencies. Aim for 80% coverage minimum. Step 4: Agent Collaboration Ask Claude to implement a complete task management feature:\n@api-architect @database-engineer Create a task management system with: - CRUD operations for tasks - SQLite database with proper schema - Async database operations - Input validation Claude activates both agents. Watch them collaborate:\n# models.py - Created by @database-engineer from sqlalchemy import Column, Integer, String, Boolean, DateTime from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession from sqlalchemy.orm import declarative_base, sessionmaker from datetime import datetime Base = declarative_base() class Task(Base): __tablename__ = \"tasks\" id = Column(Integer, primary_key=True, index=True) title = Column(String(200), nullable=False, index=True) description = Column(String(1000)) completed = Column(Boolean, default=False, index=True) created_at = Column(DateTime, default=datetime.utcnow) updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow) # Database setup engine = create_async_engine(\"sqlite+aiosqlite:///./tasks.db\") AsyncSessionLocal = sessionmaker(engine, class_=AsyncSession, expire_on_commit=False) async def get_db(): async with AsyncSessionLocal() as session: yield session # schemas.py - Created by @api-architect from pydantic import BaseModel, Field from datetime import datetime from typing import Optional class TaskBase(BaseModel): title: str = Field(..., min_length=1, max_length=200) description: Optional[str] = Field(None, max_length=1000) completed: bool = False class TaskCreate(TaskBase): pass class TaskUpdate(BaseModel): title: Optional[str] = Field(None, min_length=1, max_length=200) description: Optional[str] = Field(None, max_length=1000) completed: Optional[bool] = None class TaskResponse(TaskBase): id: int created_at: datetime updated_at: datetime class Config: from_attributes = True # main.py - Enhanced by @api-architect from fastapi import FastAPI, Depends, HTTPException, status from sqlalchemy.ext.asyncio import AsyncSession from sqlalchemy import select from typing import List from models import Task, get_db, Base, engine from schemas import TaskCreate, TaskUpdate, TaskResponse app = FastAPI(title=\"Task API\", version=\"1.0.0\") @app.on_event(\"startup\") async def startup(): async with engine.begin() as conn: await conn.run_sync(Base.metadata.create_all) @app.post(\"/tasks\", response_model=TaskResponse, status_code=status.HTTP_201_CREATED) async def create_task(task: TaskCreate, db: AsyncSession = Depends(get_db)): db_task = Task(**task.dict()) db.add(db_task) await db.commit() await db.refresh(db_task) return db_task @app.get(\"/tasks\", response_model=List[TaskResponse]) async def list_tasks( skip: int = 0, limit: int = 100, completed: Optional[bool] = None, db: AsyncSession = Depends(get_db) ): query = select(Task) if completed is not None: query = query.where(Task.completed == completed) query = query.offset(skip).limit(limit) result = await db.execute(query) return result.scalars().all() @app.get(\"/tasks/{task_id}\", response_model=TaskResponse) async def get_task(task_id: int, db: AsyncSession = Depends(get_db)): result = await db.execute(select(Task).where(Task.id == task_id)) task = result.scalar_one_or_none() if not task: raise HTTPException(status_code=404, detail=\"Task not found\") return task @app.patch(\"/tasks/{task_id}\", response_model=TaskResponse) async def update_task( task_id: int, task_update: TaskUpdate, db: AsyncSession = Depends(get_db) ): result = await db.execute(select(Task).where(Task.id == task_id)) task = result.scalar_one_or_none() if not task: raise HTTPException(status_code=404, detail=\"Task not found\") update_data = task_update.dict(exclude_unset=True) for field, value in update_data.items(): setattr(task, field, value) await db.commit() await db.refresh(task) return task @app.delete(\"/tasks/{task_id}\", status_code=status.HTTP_204_NO_CONTENT) async def delete_task(task_id: int, db: AsyncSession = Depends(get_db)): result = await db.execute(select(Task).where(Task.id == task_id)) task = result.scalar_one_or_none() if not task: raise HTTPException(status_code=404, detail=\"Task not found\") await db.delete(task) await db.commit() Observable Result Test the API:\n# Create a task curl -X POST http://localhost:8000/tasks \\ -H \"Content-Type: application/json\" \\ -d '{\"title\": \"Build API\", \"description\": \"Implement task management\"}' # List tasks curl http://localhost:8000/tasks Your agents just built a production-ready API with proper separation of concerns.\nPart 3: Output Styles Output styles control how Claude presents information. Different tasks need different formats.\nStep 5: Define Output Styles Create .claude/output-styles.yml:\noutput_styles: concise: description: \"Minimal output for quick iterations\" format: - \"State changes only\" - \"One-line confirmations\" - \"Error details when relevant\" example: | ✓ Created models.py with Task schema ✓ Added 5 API endpoints ✗ Type error in line 45: await required detailed: description: \"Comprehensive explanations for learning\" format: - \"Step-by-step explanations\" - \"Code with inline comments\" - \"Rationale for decisions\" example: | Creating database models: 1. Using SQLAlchemy async for better performance 2. Adding indexes on frequently queried fields 3. Including timestamps for audit trail ```python # Index on 'completed' for filtering active tasks completed = Column(Boolean, index=True) ``` test-results: description: \"Test execution summary\" format: - \"Test count and coverage\" - \"Failed test details\" - \"Performance metrics\" example: | Tests: 12 passed, 2 failed, 14 total Coverage: 87% Duration: 1.2s FAILED: test_task_validation - title too long FAILED: test_concurrent_updates - race condition Step 6: Apply Output Styles Now request tests with specific output:\n@test-engineer --output-style=concise Write tests for all API endpoints Claude responds tersely:\n✓ Created test_api.py with 12 tests ✓ Added fixtures for database isolation ✓ Mocked datetime for consistent testing ✓ All tests passing Need details? Switch styles:\n@test-engineer --output-style=detailed Explain the test isolation strategy Claude elaborates:\nTest Isolation Strategy: 1. **Database Isolation**: Each test gets a fresh database - Create new SQLite instance in memory - Run migrations before each test - Automatic teardown after completion 2. **Fixture Architecture**: ```python @pytest.fixture async def test_db(): # Create test engine with in-memory SQLite engine = create_async_engine(\"sqlite+aiosqlite:///:memory:\") # Create tables async with engine.begin() as conn: await conn.run_sync(Base.metadata.create_all) # Create session async_session = sessionmaker(engine, class_=AsyncSession) yield async_session # Cleanup await engine.dispose() Dependency Override: Replace production database with test instance FastAPI’s dependency injection system No changes to application code required ### Observable Result Run tests with coverage: ```bash uv run pytest --cov=. --cov-report=term-missing Different output styles serve different purposes. Concise for speed, detailed for learning.\nPart 4: MCP Servers MCP (Model Context Protocol) servers extend Claude with external capabilities.\nStep 7: Configure MCP Servers Create .claude/mcp-servers.yml:\nmcp_servers: database: command: \"mcp-server-sqlite\" args: [\"--db-path\", \"./tasks.db\"] description: \"Direct database queries and analysis\" github: command: \"mcp-server-github\" env: GITHUB_TOKEN: \"${GITHUB_TOKEN}\" description: \"Repository management and CI/CD\" memory: command: \"mcp-server-memory\" args: [\"--store-path\", \"./.claude/memory\"] description: \"Persistent context across sessions\" Step 8: Database Analysis via MCP Ask Claude to analyze your database:\nUsing the database MCP server, analyze the task table for optimization opportunities Claude connects directly to SQLite:\n-- Current schema analysis SELECT sql FROM sqlite_master WHERE name = 'tasks'; -- Index usage statistics SELECT * FROM sqlite_stat1 WHERE tbl = 'tasks'; -- Query patterns analysis EXPLAIN QUERY PLAN SELECT * FROM tasks WHERE completed = 0 ORDER BY created_at DESC; Results:\nOptimization Opportunities Found: 1. Missing composite index for common query pattern: CREATE INDEX idx_tasks_completed_created ON tasks(completed, created_at DESC); 2. Text search on title without FTS: Consider adding FTS5 virtual table for full-text search 3. No partition on created_at for archival: Implement archival strategy for old completed tasks Step 9: GitHub Integration Setup CI/CD through MCP:\nUsing the GitHub MCP server, create a workflow for automated testing Claude creates .github/workflows/test.yml:\nname: Test Suite on: push: branches: [main] pull_request: branches: [main] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v3 - name: Install uv run: curl -LsSf https://astral.sh/uv/install.sh | sh - name: Set up Python run: uv python install 3.11 - name: Install dependencies run: uv sync - name: Run tests run: uv run pytest --cov=. --cov-report=xml - name: Upload coverage uses: codecov/codecov-action@v3 with: file: ./coverage.xml Observable Result Push to GitHub. Tests run automatically. MCP servers bridge Claude to external systems.\nPart 5: Complete Orchestration Combine all features into a cohesive workflow.\nStep 10: Orchestration Configuration Create .claude/orchestration.yml:\nworkflows: feature_development: description: \"Complete feature implementation workflow\" steps: - agent: \"api-architect\" action: \"Design API endpoints\" output_style: \"detailed\" - agent: \"database-engineer\" action: \"Create database schema\" hooks: post: [\"Run migrations\"] - agent: \"test-engineer\" action: \"Write tests\" output_style: \"test-results\" - mcp_server: \"database\" action: \"Validate schema performance\" - mcp_server: \"github\" action: \"Create pull request\" performance_optimization: description: \"Database and API optimization\" steps: - mcp_server: \"database\" action: \"Analyze slow queries\" - agent: \"database-engineer\" action: \"Optimize schema\" - agent: \"api-architect\" action: \"Implement caching\" output_style: \"concise\" - hooks: trigger: \"performance_test\" production_deployment: description: \"Deploy to production\" steps: - agent: \"test-engineer\" action: \"Run full test suite\" - mcp_server: \"github\" action: \"Create release\" - hooks: trigger: \"deploy_production\" Step 11: Execute Workflows Implement a new feature end-to-end:\nExecute workflow: feature_development for \"Add task priorities with urgent flag\" Claude orchestrates the entire process:\nAPI Architect designs the priority endpoints Database Engineer adds priority columns with migration Test Engineer writes comprehensive tests MCP Database validates query performance MCP GitHub creates pull request with all changes The complete implementation appears in minutes, not hours.\nStep 12: Advanced Integration Create .claude/integration.yml for complex scenarios:\nintegrations: smart_refactoring: trigger: \"High cyclomatic complexity detected\" sequence: - mcp_server: \"memory\" action: \"Recall previous refactoring patterns\" - agent: \"api-architect\" action: \"Refactor complex endpoints\" - agent: \"test-engineer\" action: \"Ensure behavior preservation\" - hooks: trigger: \"run_mutation_tests\" auto_scaling: trigger: \"Performance threshold exceeded\" sequence: - mcp_server: \"database\" action: \"Identify bottlenecks\" - agent: \"database-engineer\" action: \"Implement read replicas\" - agent: \"api-architect\" action: \"Add connection pooling\" incident_response: trigger: \"Production error detected\" sequence: - mcp_server: \"memory\" action: \"Retrieve similar incidents\" - agent: \"database-engineer\" action: \"Analyze data integrity\" - agent: \"api-architect\" action: \"Implement hotfix\" - agent: \"test-engineer\" action: \"Regression testing\" - mcp_server: \"github\" action: \"Emergency deploy\" Real-World Power You’ve built a complete task management API with:\nAutomated environment setup via hooks Domain-expert agents collaborating on implementation Adaptive output styles for different contexts MCP servers connecting to external systems Orchestrated workflows replacing manual processes This isn’t a toy. It’s how modern AI-assisted development works.\nPerformance Metrics Before Claude Code advanced features:\nInitial setup: 30 minutes API implementation: 2 hours Test writing: 1 hour Database optimization: 45 minutes CI/CD setup: 30 minutes Total: 4 hours 45 minutes After:\nEverything above: 15 minutes With better consistency and documentation Key Patterns Hooks eliminate setup friction. Define once, trigger automatically.\nAgents provide specialized expertise. No more context switching between domains.\nOutput styles match cognitive load. Concise when moving fast, detailed when learning.\nMCP servers break the sandbox. Direct database access, GitHub integration, persistent memory.\nOrchestration creates compound productivity. Workflows execute complex sequences flawlessly.\nNext Steps Your Claude Code setup now runs like a well-oiled machine. Extend it:\nAdd monitoring MCP server for production observability Create specialized agents for your domain Build workflow templates for common patterns Integrate with your existing tool chain The configuration files in this tutorial work immediately. Copy them, customize for your stack, and watch your development velocity transform.\nRepository Find the complete task API with all configurations at github.com/yourusername/taskapi-claude-demo.\nRemember: These features compose. Hooks trigger during agent work. MCP servers provide data to agents. Output styles adapt to workflow stages. The sum exceeds the parts.\nWelcome to augmented development. Your AI assistant just became a development platform.\nBuilt with Claude Code v2.x. Tested on macOS and Linux. Windows users may need path adjustments.\n","wordCount":"2066","inLanguage":"en","datePublished":"2025-01-19T10:00:00-06:00","dateModified":"2025-08-19T19:44:37+09:00","author":{"@type":"Person","name":"Memo Garcia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://memo.mx/posts/claude-code-advanced-features/"},"publisher":{"@type":"Person","name":"Memo Garcia","logo":{"@type":"ImageObject","url":"https://memo.mx/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://memo.mx/ accesskey=h title="Memo Garcia (Alt + H)">Memo Garcia</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://memo.mx/tools title=Tools><span>Tools</span></a></li><li><a href=https://memo.mx/books title=Books><span>Books</span></a></li><li><a href=https://memo.mx/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Claude Code Advanced Features: Hooks, Agents, and MCP Servers</h1><div class=post-meta><span title='2025-01-19 10:00:00 -0600 -0600'>January 19, 2025</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;Memo Garcia</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#prerequisites aria-label=Prerequisites>Prerequisites</a></li><li><a href=#part-1-project-initialization-with-hooks aria-label="Part 1: Project Initialization with Hooks">Part 1: Project Initialization with Hooks</a><ul><li><a href=#step-1-create-the-basic-hook aria-label="Step 1: Create the Basic Hook">Step 1: Create the Basic Hook</a></li><li><a href=#step-2-add-development-hooks aria-label="Step 2: Add Development Hooks">Step 2: Add Development Hooks</a></li><li><a href=#observable-result aria-label="Observable Result">Observable Result</a></li></ul></li><li><a href=#part-2-specialized-agents aria-label="Part 2: Specialized Agents">Part 2: Specialized Agents</a><ul><li><a href=#step-3-configure-domain-agents aria-label="Step 3: Configure Domain Agents">Step 3: Configure Domain Agents</a></li><li><a href=#step-4-agent-collaboration aria-label="Step 4: Agent Collaboration">Step 4: Agent Collaboration</a></li><li><a href=#observable-result-1 aria-label="Observable Result">Observable Result</a></li></ul></li><li><a href=#part-3-output-styles aria-label="Part 3: Output Styles">Part 3: Output Styles</a><ul><li><a href=#step-5-define-output-styles aria-label="Step 5: Define Output Styles">Step 5: Define Output Styles</a></li><li><a href=#step-6-apply-output-styles aria-label="Step 6: Apply Output Styles">Step 6: Apply Output Styles</a></li></ul></li><li><a href=#part-4-mcp-servers aria-label="Part 4: MCP Servers">Part 4: MCP Servers</a><ul><li><a href=#step-7-configure-mcp-servers aria-label="Step 7: Configure MCP Servers">Step 7: Configure MCP Servers</a></li><li><a href=#step-8-database-analysis-via-mcp aria-label="Step 8: Database Analysis via MCP">Step 8: Database Analysis via MCP</a></li><li><a href=#step-9-github-integration aria-label="Step 9: GitHub Integration">Step 9: GitHub Integration</a></li><li><a href=#observable-result-2 aria-label="Observable Result">Observable Result</a></li></ul></li><li><a href=#part-5-complete-orchestration aria-label="Part 5: Complete Orchestration">Part 5: Complete Orchestration</a><ul><li><a href=#step-10-orchestration-configuration aria-label="Step 10: Orchestration Configuration">Step 10: Orchestration Configuration</a></li><li><a href=#step-11-execute-workflows aria-label="Step 11: Execute Workflows">Step 11: Execute Workflows</a></li><li><a href=#step-12-advanced-integration aria-label="Step 12: Advanced Integration">Step 12: Advanced Integration</a></li></ul></li><li><a href=#real-world-power aria-label="Real-World Power">Real-World Power</a><ul><li><a href=#performance-metrics aria-label="Performance Metrics">Performance Metrics</a></li><li><a href=#key-patterns aria-label="Key Patterns">Key Patterns</a></li></ul></li><li><a href=#next-steps aria-label="Next Steps">Next Steps</a></li><li><a href=#repository aria-label=Repository>Repository</a></li></ul></div></details></div><div class=post-content><p>You&rsquo;ve been using Claude Code for basic tasks. Time to unlock its real power.</p><p>This tutorial builds a Python task management API from scratch, progressively adding Claude Code&rsquo;s advanced features. Each step produces observable results. No toy examples, no fluff—just practical patterns you&rsquo;ll use daily.</p><h2 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h2><p>You need:</p><ul><li>Claude Code installed and configured</li><li>Python 3.11+</li><li><code>uv</code> package manager (<code>curl -LsSf https://astral.sh/uv/install.sh | sh</code>)</li><li>Basic Python and REST API knowledge</li></ul><h2 id=part-1-project-initialization-with-hooks>Part 1: Project Initialization with Hooks<a hidden class=anchor aria-hidden=true href=#part-1-project-initialization-with-hooks>#</a></h2><p>Hooks transform repetitive setup into automated workflows. Start with a fresh project.</p><h3 id=step-1-create-the-basic-hook>Step 1: Create the Basic Hook<a hidden class=anchor aria-hidden=true href=#step-1-create-the-basic-hook>#</a></h3><p>Create <code>.claude/hooks.yml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>hooks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pre_command</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Python Project Setup&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Initialize Python environment with uv&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>triggers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>pattern</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;.*\\.py$&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;create&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;shell&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            if [ ! -f &#34;pyproject.toml&#34; ]; then
</span></span></span><span class=line><span class=cl><span class=sd>              uv init --name taskapi --python 3.11
</span></span></span><span class=line><span class=cl><span class=sd>              uv add fastapi uvicorn sqlalchemy pydantic
</span></span></span><span class=line><span class=cl><span class=sd>              echo &#34;✓ Python environment initialized&#34;
</span></span></span><span class=line><span class=cl><span class=sd>            fi</span><span class=w>            
</span></span></span></code></pre></div><p>Now create your first Python file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># main.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&#34;Task API&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/health&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>health_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;healthy&#34;</span><span class=p>}</span>
</span></span></code></pre></div><p>Watch the hook trigger automatically. Your environment materializes without manual intervention.</p><h3 id=step-2-add-development-hooks>Step 2: Add Development Hooks<a hidden class=anchor aria-hidden=true href=#step-2-add-development-hooks>#</a></h3><p>Extend <code>.claude/hooks.yml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>hooks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pre_command</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Python Project Setup&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># ... previous config ...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Auto-format on save&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>triggers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>pattern</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;.*\\.py$&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;edit&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;shell&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;uv run ruff format ${file}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>post_command</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Type checking&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>triggers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>pattern</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;.*\\.py$&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;edit&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>condition</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;git diff --name-only | grep -q &#39;\\.py$&#39;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;shell&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;uv run mypy ${file} --ignore-missing-imports&#34;</span><span class=w>
</span></span></span></code></pre></div><p>Edit any Python file. Formatting happens automatically. Type errors surface immediately.</p><h3 id=observable-result>Observable Result<a hidden class=anchor aria-hidden=true href=#observable-result>#</a></h3><p>Run the API:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv run uvicorn main:app --reload
</span></span></code></pre></div><p>Visit <code>http://localhost:8000/health</code>. Your development environment is now self-maintaining.</p><h2 id=part-2-specialized-agents>Part 2: Specialized Agents<a hidden class=anchor aria-hidden=true href=#part-2-specialized-agents>#</a></h2><p>Agents bring domain expertise to your project. Each agent excels at specific tasks.</p><h3 id=step-3-configure-domain-agents>Step 3: Configure Domain Agents<a hidden class=anchor aria-hidden=true href=#step-3-configure-domain-agents>#</a></h3><p>Create <code>.claude/agents.yml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>agents</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>api-architect</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;REST API design and implementation&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>expertise</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;FastAPI patterns and best practices&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;SQLAlchemy ORM optimization&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;API versioning strategies&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>instructions</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      Design APIs following REST principles.
</span></span></span><span class=line><span class=cl><span class=sd>      Use dependency injection for database sessions.
</span></span></span><span class=line><span class=cl><span class=sd>      Implement proper error handling with status codes.
</span></span></span><span class=line><span class=cl><span class=sd>      Always include OpenAPI documentation.</span><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>database-engineer</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Database schema and query optimization&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>expertise</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;SQLAlchemy model design&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;Migration strategies with Alembic&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;Query performance optimization&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>instructions</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      Design normalized schemas.
</span></span></span><span class=line><span class=cl><span class=sd>      Create appropriate indexes.
</span></span></span><span class=line><span class=cl><span class=sd>      Use async database operations.
</span></span></span><span class=line><span class=cl><span class=sd>      Write efficient queries avoiding N+1 problems.</span><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>test-engineer</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Comprehensive testing implementation&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>expertise</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;pytest fixtures and parametrization&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;FastAPI test client usage&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;Database test isolation&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>instructions</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      Write tests before implementation.
</span></span></span><span class=line><span class=cl><span class=sd>      Use fixtures for test data.
</span></span></span><span class=line><span class=cl><span class=sd>      Mock external dependencies.
</span></span></span><span class=line><span class=cl><span class=sd>      Aim for 80% coverage minimum.</span><span class=w>      
</span></span></span></code></pre></div><h3 id=step-4-agent-collaboration>Step 4: Agent Collaboration<a hidden class=anchor aria-hidden=true href=#step-4-agent-collaboration>#</a></h3><p>Ask Claude to implement a complete task management feature:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@api-architect @database-engineer Create a task management system with:
</span></span><span class=line><span class=cl>- CRUD operations for tasks
</span></span><span class=line><span class=cl>- SQLite database with proper schema
</span></span><span class=line><span class=cl>- Async database operations
</span></span><span class=line><span class=cl>- Input validation
</span></span></code></pre></div><p>Claude activates both agents. Watch them collaborate:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># models.py - Created by @database-engineer</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy</span> <span class=kn>import</span> <span class=n>Column</span><span class=p>,</span> <span class=n>Integer</span><span class=p>,</span> <span class=n>String</span><span class=p>,</span> <span class=n>Boolean</span><span class=p>,</span> <span class=n>DateTime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy.ext.asyncio</span> <span class=kn>import</span> <span class=n>create_async_engine</span><span class=p>,</span> <span class=n>AsyncSession</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy.orm</span> <span class=kn>import</span> <span class=n>declarative_base</span><span class=p>,</span> <span class=n>sessionmaker</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Base</span> <span class=o>=</span> <span class=n>declarative_base</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Task</span><span class=p>(</span><span class=n>Base</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>__tablename__</span> <span class=o>=</span> <span class=s2>&#34;tasks&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>id</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>Integer</span><span class=p>,</span> <span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>title</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>(</span><span class=mi>200</span><span class=p>),</span> <span class=n>nullable</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>(</span><span class=mi>1000</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>completed</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>Boolean</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>DateTime</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>updated_at</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>DateTime</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>,</span> <span class=n>onupdate</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Database setup</span>
</span></span><span class=line><span class=cl><span class=n>engine</span> <span class=o>=</span> <span class=n>create_async_engine</span><span class=p>(</span><span class=s2>&#34;sqlite+aiosqlite:///./tasks.db&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>AsyncSessionLocal</span> <span class=o>=</span> <span class=n>sessionmaker</span><span class=p>(</span><span class=n>engine</span><span class=p>,</span> <span class=n>class_</span><span class=o>=</span><span class=n>AsyncSession</span><span class=p>,</span> <span class=n>expire_on_commit</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_db</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>with</span> <span class=n>AsyncSessionLocal</span><span class=p>()</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=n>session</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># schemas.py - Created by @api-architect</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pydantic</span> <span class=kn>import</span> <span class=n>BaseModel</span><span class=p>,</span> <span class=n>Field</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TaskBase</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>title</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=o>...</span><span class=p>,</span> <span class=n>min_length</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>max_length</span><span class=o>=</span><span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>max_length</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>completed</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TaskCreate</span><span class=p>(</span><span class=n>TaskBase</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TaskUpdate</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>title</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>min_length</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>max_length</span><span class=o>=</span><span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>max_length</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>completed</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TaskResponse</span><span class=p>(</span><span class=n>TaskBase</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    <span class=n>updated_at</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>class</span> <span class=nc>Config</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>from_attributes</span> <span class=o>=</span> <span class=kc>True</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># main.py - Enhanced by @api-architect</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span><span class=p>,</span> <span class=n>Depends</span><span class=p>,</span> <span class=n>HTTPException</span><span class=p>,</span> <span class=n>status</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy.ext.asyncio</span> <span class=kn>import</span> <span class=n>AsyncSession</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy</span> <span class=kn>import</span> <span class=n>select</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>models</span> <span class=kn>import</span> <span class=n>Task</span><span class=p>,</span> <span class=n>get_db</span><span class=p>,</span> <span class=n>Base</span><span class=p>,</span> <span class=n>engine</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>schemas</span> <span class=kn>import</span> <span class=n>TaskCreate</span><span class=p>,</span> <span class=n>TaskUpdate</span><span class=p>,</span> <span class=n>TaskResponse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&#34;Task API&#34;</span><span class=p>,</span> <span class=n>version</span><span class=o>=</span><span class=s2>&#34;1.0.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.on_event</span><span class=p>(</span><span class=s2>&#34;startup&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>startup</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>with</span> <span class=n>engine</span><span class=o>.</span><span class=n>begin</span><span class=p>()</span> <span class=k>as</span> <span class=n>conn</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>conn</span><span class=o>.</span><span class=n>run_sync</span><span class=p>(</span><span class=n>Base</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>create_all</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.post</span><span class=p>(</span><span class=s2>&#34;/tasks&#34;</span><span class=p>,</span> <span class=n>response_model</span><span class=o>=</span><span class=n>TaskResponse</span><span class=p>,</span> <span class=n>status_code</span><span class=o>=</span><span class=n>status</span><span class=o>.</span><span class=n>HTTP_201_CREATED</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>create_task</span><span class=p>(</span><span class=n>task</span><span class=p>:</span> <span class=n>TaskCreate</span><span class=p>,</span> <span class=n>db</span><span class=p>:</span> <span class=n>AsyncSession</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_db</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>db_task</span> <span class=o>=</span> <span class=n>Task</span><span class=p>(</span><span class=o>**</span><span class=n>task</span><span class=o>.</span><span class=n>dict</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>db_task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>db</span><span class=o>.</span><span class=n>refresh</span><span class=p>(</span><span class=n>db_task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>db_task</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/tasks&#34;</span><span class=p>,</span> <span class=n>response_model</span><span class=o>=</span><span class=n>List</span><span class=p>[</span><span class=n>TaskResponse</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>list_tasks</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>skip</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>limit</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>completed</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=p>:</span> <span class=n>AsyncSession</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_db</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>query</span> <span class=o>=</span> <span class=n>select</span><span class=p>(</span><span class=n>Task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>completed</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>query</span> <span class=o>=</span> <span class=n>query</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>Task</span><span class=o>.</span><span class=n>completed</span> <span class=o>==</span> <span class=n>completed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>query</span> <span class=o>=</span> <span class=n>query</span><span class=o>.</span><span class=n>offset</span><span class=p>(</span><span class=n>skip</span><span class=p>)</span><span class=o>.</span><span class=n>limit</span><span class=p>(</span><span class=n>limit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>query</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span><span class=o>.</span><span class=n>scalars</span><span class=p>()</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/tasks/</span><span class=si>{task_id}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>response_model</span><span class=o>=</span><span class=n>TaskResponse</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_task</span><span class=p>(</span><span class=n>task_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>db</span><span class=p>:</span> <span class=n>AsyncSession</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_db</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>select</span><span class=p>(</span><span class=n>Task</span><span class=p>)</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>Task</span><span class=o>.</span><span class=n>id</span> <span class=o>==</span> <span class=n>task_id</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>task</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>scalar_one_or_none</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>task</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>404</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Task not found&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>task</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.patch</span><span class=p>(</span><span class=s2>&#34;/tasks/</span><span class=si>{task_id}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>response_model</span><span class=o>=</span><span class=n>TaskResponse</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>update_task</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>task_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>task_update</span><span class=p>:</span> <span class=n>TaskUpdate</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=p>:</span> <span class=n>AsyncSession</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_db</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>select</span><span class=p>(</span><span class=n>Task</span><span class=p>)</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>Task</span><span class=o>.</span><span class=n>id</span> <span class=o>==</span> <span class=n>task_id</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>task</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>scalar_one_or_none</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>task</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>404</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Task not found&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>update_data</span> <span class=o>=</span> <span class=n>task_update</span><span class=o>.</span><span class=n>dict</span><span class=p>(</span><span class=n>exclude_unset</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>field</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>update_data</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>setattr</span><span class=p>(</span><span class=n>task</span><span class=p>,</span> <span class=n>field</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>db</span><span class=o>.</span><span class=n>refresh</span><span class=p>(</span><span class=n>task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>task</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.delete</span><span class=p>(</span><span class=s2>&#34;/tasks/</span><span class=si>{task_id}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>status_code</span><span class=o>=</span><span class=n>status</span><span class=o>.</span><span class=n>HTTP_204_NO_CONTENT</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>delete_task</span><span class=p>(</span><span class=n>task_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>db</span><span class=p>:</span> <span class=n>AsyncSession</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_db</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>select</span><span class=p>(</span><span class=n>Task</span><span class=p>)</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>Task</span><span class=o>.</span><span class=n>id</span> <span class=o>==</span> <span class=n>task_id</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>task</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>scalar_one_or_none</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>task</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>404</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Task not found&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>db</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=observable-result-1>Observable Result<a hidden class=anchor aria-hidden=true href=#observable-result-1>#</a></h3><p>Test the API:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Create a task</span>
</span></span><span class=line><span class=cl>curl -X POST http://localhost:8000/tasks <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;Content-Type: application/json&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -d <span class=s1>&#39;{&#34;title&#34;: &#34;Build API&#34;, &#34;description&#34;: &#34;Implement task management&#34;}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># List tasks</span>
</span></span><span class=line><span class=cl>curl http://localhost:8000/tasks
</span></span></code></pre></div><p>Your agents just built a production-ready API with proper separation of concerns.</p><h2 id=part-3-output-styles>Part 3: Output Styles<a hidden class=anchor aria-hidden=true href=#part-3-output-styles>#</a></h2><p>Output styles control how Claude presents information. Different tasks need different formats.</p><h3 id=step-5-define-output-styles>Step 5: Define Output Styles<a hidden class=anchor aria-hidden=true href=#step-5-define-output-styles>#</a></h3><p>Create <code>.claude/output-styles.yml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>output_styles</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>concise</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Minimal output for quick iterations&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>format</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;State changes only&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;One-line confirmations&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;Error details when relevant&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      ✓ Created models.py with Task schema
</span></span></span><span class=line><span class=cl><span class=sd>      ✓ Added 5 API endpoints
</span></span></span><span class=line><span class=cl><span class=sd>      ✗ Type error in line 45: await required</span><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>detailed</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Comprehensive explanations for learning&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>format</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;Step-by-step explanations&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;Code with inline comments&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;Rationale for decisions&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      Creating database models:
</span></span></span><span class=line><span class=cl><span class=sd>      1. Using SQLAlchemy async for better performance
</span></span></span><span class=line><span class=cl><span class=sd>      2. Adding indexes on frequently queried fields
</span></span></span><span class=line><span class=cl><span class=sd>      3. Including timestamps for audit trail
</span></span></span><span class=line><span class=cl><span class=sd>      
</span></span></span><span class=line><span class=cl><span class=sd>      ```python
</span></span></span><span class=line><span class=cl><span class=sd>      # Index on &#39;completed&#39; for filtering active tasks
</span></span></span><span class=line><span class=cl><span class=sd>      completed = Column(Boolean, index=True)
</span></span></span><span class=line><span class=cl><span class=sd>      ```</span><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>test-results</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Test execution summary&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>format</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;Test count and coverage&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;Failed test details&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;Performance metrics&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      Tests: 12 passed, 2 failed, 14 total
</span></span></span><span class=line><span class=cl><span class=sd>      Coverage: 87%
</span></span></span><span class=line><span class=cl><span class=sd>      Duration: 1.2s
</span></span></span><span class=line><span class=cl><span class=sd>      
</span></span></span><span class=line><span class=cl><span class=sd>      FAILED: test_task_validation - title too long
</span></span></span><span class=line><span class=cl><span class=sd>      FAILED: test_concurrent_updates - race condition</span><span class=w>      
</span></span></span></code></pre></div><h3 id=step-6-apply-output-styles>Step 6: Apply Output Styles<a hidden class=anchor aria-hidden=true href=#step-6-apply-output-styles>#</a></h3><p>Now request tests with specific output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@test-engineer --output-style=concise Write tests for all API endpoints
</span></span></code></pre></div><p>Claude responds tersely:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>✓ Created test_api.py with 12 tests
</span></span><span class=line><span class=cl>✓ Added fixtures for database isolation
</span></span><span class=line><span class=cl>✓ Mocked datetime for consistent testing
</span></span><span class=line><span class=cl>✓ All tests passing
</span></span></code></pre></div><p>Need details? Switch styles:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@test-engineer --output-style=detailed Explain the test isolation strategy
</span></span></code></pre></div><p>Claude elaborates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Test Isolation Strategy:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. **Database Isolation**: Each test gets a fresh database
</span></span><span class=line><span class=cl>   - Create new SQLite instance in memory
</span></span><span class=line><span class=cl>   - Run migrations before each test
</span></span><span class=line><span class=cl>   - Automatic teardown after completion
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. **Fixture Architecture**:
</span></span><span class=line><span class=cl>   ```python
</span></span><span class=line><span class=cl>   @pytest.fixture
</span></span><span class=line><span class=cl>   async def test_db():
</span></span><span class=line><span class=cl>       # Create test engine with in-memory SQLite
</span></span><span class=line><span class=cl>       engine = create_async_engine(&#34;sqlite+aiosqlite:///:memory:&#34;)
</span></span><span class=line><span class=cl>       
</span></span><span class=line><span class=cl>       # Create tables
</span></span><span class=line><span class=cl>       async with engine.begin() as conn:
</span></span><span class=line><span class=cl>           await conn.run_sync(Base.metadata.create_all)
</span></span><span class=line><span class=cl>       
</span></span><span class=line><span class=cl>       # Create session
</span></span><span class=line><span class=cl>       async_session = sessionmaker(engine, class_=AsyncSession)
</span></span><span class=line><span class=cl>       
</span></span><span class=line><span class=cl>       yield async_session
</span></span><span class=line><span class=cl>       
</span></span><span class=line><span class=cl>       # Cleanup
</span></span><span class=line><span class=cl>       await engine.dispose()
</span></span></code></pre></div><ol start=3><li><strong>Dependency Override</strong>: Replace production database with test instance<ul><li>FastAPI&rsquo;s dependency injection system</li><li>No changes to application code required</li></ul></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>
</span></span><span class=line><span class=cl>### Observable Result
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Run tests with coverage:
</span></span><span class=line><span class=cl>```bash
</span></span><span class=line><span class=cl>uv run pytest --cov=. --cov-report=term-missing
</span></span></code></pre></div><p>Different output styles serve different purposes. Concise for speed, detailed for learning.</p><h2 id=part-4-mcp-servers>Part 4: MCP Servers<a hidden class=anchor aria-hidden=true href=#part-4-mcp-servers>#</a></h2><p>MCP (Model Context Protocol) servers extend Claude with external capabilities.</p><h3 id=step-7-configure-mcp-servers>Step 7: Configure MCP Servers<a hidden class=anchor aria-hidden=true href=#step-7-configure-mcp-servers>#</a></h3><p>Create <code>.claude/mcp-servers.yml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>mcp_servers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>database</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;mcp-server-sqlite&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>args</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;--db-path&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;./tasks.db&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Direct database queries and analysis&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>github</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;mcp-server-github&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>GITHUB_TOKEN</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;${GITHUB_TOKEN}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Repository management and CI/CD&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;mcp-server-memory&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>args</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;--store-path&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;./.claude/memory&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Persistent context across sessions&#34;</span><span class=w>
</span></span></span></code></pre></div><h3 id=step-8-database-analysis-via-mcp>Step 8: Database Analysis via MCP<a hidden class=anchor aria-hidden=true href=#step-8-database-analysis-via-mcp>#</a></h3><p>Ask Claude to analyze your database:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Using the database MCP server, analyze the task table for optimization opportunities
</span></span></code></pre></div><p>Claude connects directly to SQLite:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Current schema analysis
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>sql</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sqlite_master</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;tasks&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Index usage statistics  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sqlite_stat1</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>tbl</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;tasks&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Query patterns analysis
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>EXPLAIN</span><span class=w> </span><span class=n>QUERY</span><span class=w> </span><span class=n>PLAN</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>tasks</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>completed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>Results:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Optimization Opportunities Found:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. Missing composite index for common query pattern:
</span></span><span class=line><span class=cl>   CREATE INDEX idx_tasks_completed_created 
</span></span><span class=line><span class=cl>   ON tasks(completed, created_at DESC);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. Text search on title without FTS:
</span></span><span class=line><span class=cl>   Consider adding FTS5 virtual table for full-text search
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. No partition on created_at for archival:
</span></span><span class=line><span class=cl>   Implement archival strategy for old completed tasks
</span></span></code></pre></div><h3 id=step-9-github-integration>Step 9: GitHub Integration<a hidden class=anchor aria-hidden=true href=#step-9-github-integration>#</a></h3><p>Setup CI/CD through MCP:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Using the GitHub MCP server, create a workflow for automated testing
</span></span></code></pre></div><p>Claude creates <code>.github/workflows/test.yml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Test Suite</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>main]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pull_request</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>main]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Install uv</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>curl -LsSf https://astral.sh/uv/install.sh | sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Set up Python</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>uv python install 3.11</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Install dependencies</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>uv sync</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Run tests</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>uv run pytest --cov=. --cov-report=xml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Upload coverage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>codecov/codecov-action@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>file</span><span class=p>:</span><span class=w> </span><span class=l>./coverage.xml</span><span class=w>
</span></span></span></code></pre></div><h3 id=observable-result-2>Observable Result<a hidden class=anchor aria-hidden=true href=#observable-result-2>#</a></h3><p>Push to GitHub. Tests run automatically. MCP servers bridge Claude to external systems.</p><h2 id=part-5-complete-orchestration>Part 5: Complete Orchestration<a hidden class=anchor aria-hidden=true href=#part-5-complete-orchestration>#</a></h2><p>Combine all features into a cohesive workflow.</p><h3 id=step-10-orchestration-configuration>Step 10: Orchestration Configuration<a hidden class=anchor aria-hidden=true href=#step-10-orchestration-configuration>#</a></h3><p>Create <code>.claude/orchestration.yml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>workflows</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>feature_development</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Complete feature implementation workflow&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;api-architect&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Design API endpoints&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>output_style</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;detailed&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;database-engineer&#34;</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Create database schema&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>hooks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>post</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;Run migrations&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;test-engineer&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Write tests&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>output_style</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;test-results&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>mcp_server</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;database&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Validate schema performance&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>mcp_server</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;github&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Create pull request&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>performance_optimization</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Database and API optimization&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>mcp_server</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;database&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Analyze slow queries&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;database-engineer&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Optimize schema&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;api-architect&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Implement caching&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>output_style</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;concise&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>hooks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;performance_test&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>production_deployment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Deploy to production&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;test-engineer&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Run full test suite&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>mcp_server</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;github&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Create release&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>hooks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;deploy_production&#34;</span><span class=w>
</span></span></span></code></pre></div><h3 id=step-11-execute-workflows>Step 11: Execute Workflows<a hidden class=anchor aria-hidden=true href=#step-11-execute-workflows>#</a></h3><p>Implement a new feature end-to-end:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Execute workflow: feature_development for &#34;Add task priorities with urgent flag&#34;
</span></span></code></pre></div><p>Claude orchestrates the entire process:</p><ol><li><strong>API Architect</strong> designs the priority endpoints</li><li><strong>Database Engineer</strong> adds priority columns with migration</li><li><strong>Test Engineer</strong> writes comprehensive tests</li><li><strong>MCP Database</strong> validates query performance</li><li><strong>MCP GitHub</strong> creates pull request with all changes</li></ol><p>The complete implementation appears in minutes, not hours.</p><h3 id=step-12-advanced-integration>Step 12: Advanced Integration<a hidden class=anchor aria-hidden=true href=#step-12-advanced-integration>#</a></h3><p>Create <code>.claude/integration.yml</code> for complex scenarios:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>integrations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>smart_refactoring</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;High cyclomatic complexity detected&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>sequence</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>mcp_server</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;memory&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Recall previous refactoring patterns&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;api-architect&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Refactor complex endpoints&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;test-engineer&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Ensure behavior preservation&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>hooks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;run_mutation_tests&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>auto_scaling</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Performance threshold exceeded&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>sequence</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>mcp_server</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;database&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Identify bottlenecks&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;database-engineer&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Implement read replicas&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;api-architect&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Add connection pooling&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>incident_response</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>trigger</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Production error detected&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>sequence</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>mcp_server</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;memory&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Retrieve similar incidents&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;database-engineer&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Analyze data integrity&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;api-architect&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Implement hotfix&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;test-engineer&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Regression testing&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>mcp_server</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;github&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Emergency deploy&#34;</span><span class=w>
</span></span></span></code></pre></div><h2 id=real-world-power>Real-World Power<a hidden class=anchor aria-hidden=true href=#real-world-power>#</a></h2><p>You&rsquo;ve built a complete task management API with:</p><ul><li>Automated environment setup via hooks</li><li>Domain-expert agents collaborating on implementation</li><li>Adaptive output styles for different contexts</li><li>MCP servers connecting to external systems</li><li>Orchestrated workflows replacing manual processes</li></ul><p>This isn&rsquo;t a toy. It&rsquo;s how modern AI-assisted development works.</p><h3 id=performance-metrics>Performance Metrics<a hidden class=anchor aria-hidden=true href=#performance-metrics>#</a></h3><p>Before Claude Code advanced features:</p><ul><li>Initial setup: 30 minutes</li><li>API implementation: 2 hours</li><li>Test writing: 1 hour</li><li>Database optimization: 45 minutes</li><li>CI/CD setup: 30 minutes
<strong>Total: 4 hours 45 minutes</strong></li></ul><p>After:</p><ul><li>Everything above: 15 minutes</li><li>With better consistency and documentation</li></ul><h3 id=key-patterns>Key Patterns<a hidden class=anchor aria-hidden=true href=#key-patterns>#</a></h3><ol><li><p><strong>Hooks eliminate setup friction</strong>. Define once, trigger automatically.</p></li><li><p><strong>Agents provide specialized expertise</strong>. No more context switching between domains.</p></li><li><p><strong>Output styles match cognitive load</strong>. Concise when moving fast, detailed when learning.</p></li><li><p><strong>MCP servers break the sandbox</strong>. Direct database access, GitHub integration, persistent memory.</p></li><li><p><strong>Orchestration creates compound productivity</strong>. Workflows execute complex sequences flawlessly.</p></li></ol><h2 id=next-steps>Next Steps<a hidden class=anchor aria-hidden=true href=#next-steps>#</a></h2><p>Your Claude Code setup now runs like a well-oiled machine. Extend it:</p><ol><li>Add monitoring MCP server for production observability</li><li>Create specialized agents for your domain</li><li>Build workflow templates for common patterns</li><li>Integrate with your existing tool chain</li></ol><p>The configuration files in this tutorial work immediately. Copy them, customize for your stack, and watch your development velocity transform.</p><h2 id=repository>Repository<a hidden class=anchor aria-hidden=true href=#repository>#</a></h2><p>Find the complete task API with all configurations at <a href=https://github.com>github.com/yourusername/taskapi-claude-demo</a>.</p><p>Remember: These features compose. Hooks trigger during agent work. MCP servers provide data to agents. Output styles adapt to workflow stages. The sum exceeds the parts.</p><p>Welcome to augmented development. Your AI assistant just became a development platform.</p><hr><p><em>Built with Claude Code v2.x. Tested on macOS and Linux. Windows users may need path adjustments.</em></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://memo.mx/posts/happiness/><span class=title>« Prev</span><br><span>Happiness</span>
</a><a class=next href=https://memo.mx/posts/claude-code-configuration-tutorial/><span class=title>Next »</span><br><span>Mastering Claude Code: From Basic Hooks to Production Workflows</span></a></nav></footer></article></main><footer class=footer></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
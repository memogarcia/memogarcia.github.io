<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>i3 running on WSL2 | Memo Garcia</title>
<meta name=keywords content><meta name=description content='WSL configuration Install i3
sudo apt install i3 -y Create an init script
vim ~/src/scripts/i3launch.sh #!/bin/zsh source ~/.zshrc # If not running interactively, don&#39;t do anything [ -z "$PS1" ] && return export DISPLAY=$(awk &#39;/nameserver / {print $2; exit}&#39; /etc/resolv.conf 2>/dev/null):0 export LIBGL_ALWAYS_INDIRECT=1 dbus_status=$(service dbus status) if [[ $dbus_status = *"is not running"* ]]; then sudo service dbus --full-restart fi i3 To run WSL2 as root
wsl.exe -d Ubuntu-20.04 -u root -- /bin/bash Windows configuration Install vcxsrv from powershell'><link rel=canonical href=https://memo.mx/posts/i3wm-wsl2/><meta name=google-site-verification content="G-ZRB1GGCC9B"><link crossorigin=anonymous href=/assets/css/stylesheet.d1467e28595903f993a7e37893057cefe5f69aece461c850796bf5b0a3bf422a.css integrity="sha256-0UZ+KFlZA/mTp+N4kwV87+X2muzkYchQeWv1sKO/Qio=" rel="preload stylesheet" as=style><link rel=icon href=https://memo.mx/%20favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://memo.mx/%20favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://memo.mx/%20favicon-32x32.png><link rel=apple-touch-icon href=https://memo.mx/%20apple-touch-icon.png><link rel=mask-icon href=https://memo.mx/%20safari-pinned-tab.svg><meta name=theme-color content=" #2e2e33"><meta name=msapplication-TileColor content=" #2e2e33"><link rel=alternate hreflang=en href=https://memo.mx/posts/i3wm-wsl2/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZRB1GGCC9B"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZRB1GGCC9B")}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://memo.mx/posts/"},{"@type":"ListItem","position":2,"name":"i3 running on WSL2","item":"https://memo.mx/posts/i3wm-wsl2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"i3 running on WSL2","name":"i3 running on WSL2","description":"WSL configuration Install i3\nsudo apt install i3 -y Create an init script\nvim ~/src/scripts/i3launch.sh #!/bin/zsh source ~/.zshrc # If not running interactively, don\u0026#39;t do anything [ -z \u0026#34;$PS1\u0026#34; ] \u0026amp;\u0026amp; return export DISPLAY=$(awk \u0026#39;/nameserver / {print $2; exit}\u0026#39; /etc/resolv.conf 2\u0026gt;/dev/null):0 export LIBGL_ALWAYS_INDIRECT=1 dbus_status=$(service dbus status) if [[ $dbus_status = *\u0026#34;is not running\u0026#34;* ]]; then sudo service dbus --full-restart fi i3 To run WSL2 as root\nwsl.exe -d Ubuntu-20.04 -u root -- /bin/bash Windows configuration Install vcxsrv from powershell","keywords":[],"articleBody":"WSL configuration Install i3\nsudo apt install i3 -y Create an init script\nvim ~/src/scripts/i3launch.sh #!/bin/zsh source ~/.zshrc # If not running interactively, don't do anything [ -z \"$PS1\" ] \u0026\u0026 return export DISPLAY=$(awk '/nameserver / {print $2; exit}' /etc/resolv.conf 2\u003e/dev/null):0 export LIBGL_ALWAYS_INDIRECT=1 dbus_status=$(service dbus status) if [[ $dbus_status = *\"is not running\"* ]]; then sudo service dbus --full-restart fi i3 To run WSL2 as root\nwsl.exe -d Ubuntu-20.04 -u root -- /bin/bash Windows configuration Install vcxsrv from powershell\nwinget install vcxsrv With WSL2 you need to configure your firewall to allow WSL and vcxsrv to communicate.\nSearch for Windows Defender Firewall with Advanced Security and do the following:\nCreate an inbound rule:\nname: wsl2 rule type: port port type: tcp port number: 6000 Narrow the scope of your inbound rule:\nRight click -\u003e Properties -\u003e scope -\u003e Remote IP addresses -\u003e Add 172.16.0.0/12 Search for VcXsrv windows xserver inbound rules and make sure the 4 rules are enabled and in allow mode\nStartup i3 script from Windows vcxsrv.vbs\ncode vcxsrv.vbs Set shell = CreateObject(\"WScript.Shell\" ) shell.Run \"\"\"C:\\Program Files\\VcXsrv\\vcxsrv.exe\"\" :0 -screen 0 @1 -ac -engine 1 -nodecoration -wgl\" WScript.Sleep 200 shell.Run \"wsl.exe -d YOUR_DISTRO -u YOUR_USER -- /bin/zsh ~/src/scripts/i3launch.sh\", 0 And just run your script from powershell\n.\\vcxsrv.vbs You should see this screen.\ni3 configuration Up to you.\nReferences Running i3 Desktop with WSL on Windows 10 How to set up working X11 forwarding on WSL2 WSL Windows Toolbar Launcher ","wordCount":"240","inLanguage":"en","datePublished":"2020-09-23T14:53:23+01:00","dateModified":"2025-01-17T18:11:11+09:00","author":{"@type":"Person","name":"Memo Garcia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://memo.mx/posts/i3wm-wsl2/"},"publisher":{"@type":"Organization","name":"Memo Garcia","logo":{"@type":"ImageObject","url":"https://memo.mx/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://memo.mx/ accesskey=h title="Memo Garcia (Alt + H)">Memo Garcia</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://memo.mx/dayjob title=$DAYJOB><span>$DAYJOB</span></a></li><li><a href=https://memo.mx/startup title=Startup><span>Startup</span></a></li><li><a href=https://memo.mx/youtube title=YouTube><span>YouTube</span></a></li><li><a href=https://memo.mx/books title=Books><span>Books</span></a></li><li><a href=https://memo.mx/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>i3 running on WSL2</h1><div class=post-meta><span title='2020-09-23 14:53:23 +0100 +0100'>September 23, 2020</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Memo Garcia</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#wsl-configuration aria-label="WSL configuration">WSL configuration</a></li><li><a href=#windows-configuration aria-label="Windows configuration">Windows configuration</a></li><li><a href=#i3-configuration aria-label="i3 configuration">i3 configuration</a></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><h2 id=wsl-configuration>WSL configuration<a hidden class=anchor aria-hidden=true href=#wsl-configuration>#</a></h2><ol><li><p>Install i3</p><pre><code> sudo apt install i3 -y
</code></pre></li><li><p>Create an init script</p><pre><code> vim ~/src/scripts/i3launch.sh
</code></pre></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/bin/zsh
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=nb>source</span> ~/.zshrc
</span></span><span class=line><span class=cl><span class=c1># If not running interactively, don&#39;t do anything</span>
</span></span><span class=line><span class=cl><span class=o>[</span> -z <span class=s2>&#34;</span><span class=nv>$PS1</span><span class=s2>&#34;</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>DISPLAY</span><span class=o>=</span><span class=k>$(</span>awk <span class=s1>&#39;/nameserver / {print $2; exit}&#39;</span> /etc/resolv.conf 2&gt;/dev/null<span class=k>)</span>:0
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LIBGL_ALWAYS_INDIRECT</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>dbus_status</span><span class=o>=</span><span class=k>$(</span>service dbus status<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=nv>$dbus_status</span> <span class=o>=</span> *<span class=s2>&#34;is not running&#34;</span>* <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>  sudo service dbus --full-restart
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>i3
</span></span></code></pre></div><p>To run WSL2 as root</p><pre><code>wsl.exe -d Ubuntu-20.04 -u root -- /bin/bash
</code></pre><h2 id=windows-configuration>Windows configuration<a hidden class=anchor aria-hidden=true href=#windows-configuration>#</a></h2><ol><li><p>Install <code>vcxsrv</code> from powershell</p><pre><code> winget install vcxsrv
</code></pre></li></ol><p>With WSL2 you need to configure your firewall to allow <code>WSL</code> and <code>vcxsrv</code> to communicate.</p><p>Search for <code>Windows Defender Firewall with Advanced Security</code> and do the following:</p><ol start=2><li><p>Create an inbound rule:</p><pre><code> name: wsl2
 rule type: port
 port type: tcp
 port number: 6000
</code></pre></li><li><p>Narrow the scope of your inbound rule:</p><pre><code> Right click -&gt; Properties -&gt; scope -&gt; Remote IP addresses -&gt; Add

 172.16.0.0/12
</code></pre></li><li><p>Search for <code>VcXsrv windows xserver</code> inbound rules and make sure the 4 rules are <code>enabled</code> and in <code>allow</code> mode</p></li></ol><p><img loading=lazy src=/img/wsl.png alt=firewall1></p><ol start=5><li><p>Startup i3 script from Windows <code>vcxsrv.vbs</code></p><pre><code> code vcxsrv.vbs
</code></pre></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Set </span><span class=n>shell</span> <span class=p>=</span> <span class=n>CreateObject</span><span class=p>(</span><span class=s2>&#34;WScript.Shell&#34;</span> <span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>shell</span><span class=p>.</span><span class=py>Run</span> <span class=s2>&#34;&#34;&#34;C:\Program Files\VcXsrv\vcxsrv.exe&#34;&#34; :0 -screen 0 @1 -ac -engine 1 -nodecoration -wgl&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>WScript</span><span class=p>.</span><span class=nb>Sleep </span><span class=mf>200</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>shell</span><span class=p>.</span><span class=py>Run</span> <span class=s2>&#34;wsl.exe -d YOUR_DISTRO -u YOUR_USER -- /bin/zsh ~/src/scripts/i3launch.sh&#34;</span><span class=p>,</span> <span class=mf>0</span>
</span></span></code></pre></div><ol start=6><li><p>And just run your script from powershell</p><pre><code> .\vcxsrv.vbs
</code></pre></li></ol><p>You should see this screen.</p><p><img loading=lazy src=/img/i3.png alt=i3></p><h2 id=i3-configuration>i3 configuration<a hidden class=anchor aria-hidden=true href=#i3-configuration>#</a></h2><p>Up to you.</p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://techzerker.com/2020-04-19-wsl-i3-windows/>Running i3 Desktop with WSL on Windows 10</a></li><li><a href=https://stackoverflow.com/questions/61110603/how-to-set-up-working-x11-forwarding-on-wsl2>How to set up working X11 forwarding on WSL2</a></li><li><a href=https://github.com/cascadium/wsl-windows-toolbar-launcher/blob/master/README.md#troubleshooting>WSL Windows Toolbar Launcher</a></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://memo.mx/posts/git-multiple-identities/><span class=title>« Prev</span><br><span>Setup multiple git identities and pgp keys</span>
</a><a class=next href=https://memo.mx/posts/doc-fzf/><span class=title>Next »</span><br><span>Modular CLI Documentation Fuzzy Finder</span></a></nav></footer></article></main><footer class=footer></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
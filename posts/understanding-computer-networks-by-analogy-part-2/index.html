<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Understanding Computer Networks by Analogy: Part 2 - Cities as the Internet | Memo Garcia</title>
<meta name=keywords content><meta name=description content="Think of the internet as a city full of buildings and streets.
Routers are concierges, gateways are elevators, packets are envelopes, and DNS is the city directory that keeps everyone from getting lost.
License for this chapter: CC BY-NC-ND 4.0
What This Chapter Covers In Part 1, we stayed inside a single building: your local network (LAN).
In this chapter, we step outside into the city and follow one envelope on its journey across the internet."><link rel=canonical href=https://memo.mx/posts/understanding-computer-networks-by-analogy-part-2/><meta name=google-site-verification content="G-ZRB1GGCC9B"><link crossorigin=anonymous href=/assets/css/stylesheet.d1467e28595903f993a7e37893057cefe5f69aece461c850796bf5b0a3bf422a.css integrity="sha256-0UZ+KFlZA/mTp+N4kwV87+X2muzkYchQeWv1sKO/Qio=" rel="preload stylesheet" as=style><link rel=icon href=https://memo.mx/%20favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://memo.mx/%20favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://memo.mx/%20favicon-32x32.png><link rel=apple-touch-icon href=https://memo.mx/%20apple-touch-icon.png><link rel=mask-icon href=https://memo.mx/%20safari-pinned-tab.svg><meta name=theme-color content="#0d0221"><meta name=msapplication-TileColor content="#0d0221"><link rel=alternate hreflang=en href=https://memo.mx/posts/understanding-computer-networks-by-analogy-part-2/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZRB1GGCC9B"></script><script>var dnt,doNotTrack=!1;if(!0&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZRB1GGCC9B")}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://memo.mx/posts/"},{"@type":"ListItem","position":2,"name":"Understanding Computer Networks by Analogy: Part 2 - Cities as the Internet","item":"https://memo.mx/posts/understanding-computer-networks-by-analogy-part-2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Understanding Computer Networks by Analogy: Part 2 - Cities as the Internet","name":"Understanding Computer Networks by Analogy: Part 2 - Cities as the Internet","description":"Think of the internet as a city full of buildings and streets.\nRouters are concierges, gateways are elevators, packets are envelopes, and DNS is the city directory that keeps everyone from getting lost.\nLicense for this chapter: CC BY-NC-ND 4.0\nWhat This Chapter Covers In Part 1, we stayed inside a single building: your local network (LAN).\nIn this chapter, we step outside into the city and follow one envelope on its journey across the internet.","keywords":[],"articleBody":" Think of the internet as a city full of buildings and streets.\nRouters are concierges, gateways are elevators, packets are envelopes, and DNS is the city directory that keeps everyone from getting lost.\nLicense for this chapter: CC BY-NC-ND 4.0\nWhat This Chapter Covers In Part 1, we stayed inside a single building: your local network (LAN).\nIn this chapter, we step outside into the city and follow one envelope on its journey across the internet.\nBy the end of this chapter, you should be able to:\nExplain what a default gateway is and when your device uses it. Describe what routers do and how they use routing tables and routing protocols. Understand packets, ports, sockets, and encapsulation. Compare TCP and UDP and know when each is appropriate. Explain what DNS does and why it matters for everyday networking. Chapter 2: Cities as the Internet In Part 1, we explored your building: rooms (devices), doors (interfaces), hallways (links), and floors (subnets).\nBut your friend doesn’t live in your building. They live across town, in a different building entirely. To reach them, your envelope has to leave your floor, exit your building, and navigate the city’s streets.\nIn this city:\nEach building is a separate network. Streets and intersections are the links between networks. Concierges at each lobby are routers, deciding where to send your envelope next. A city directory (DNS) helps turn names into precise addresses. We’ll follow your envelope step by step, from your room to your friend’s room across the city.\n2.1 The Elevator to Other Floors: Your Gateway Imagine you’re standing in the hallway on the 10th floor, holding a letter for your friend.\nYou know she lives on the 25th floor of a building across town.\nYou can walk up and down your hallway all day and never reach her.\nTo leave your floor, you need the elevator.\nIn networking terms, that elevator is your default gateway.\nEvery time your device sends a message, it quietly answers one question:\n“Is this destination on my floor, or somewhere else?”\nIf the destination is on your floor (same subnet), your device can deliver the message directly by “walking down the hallway.” If the destination is on another floor or building (another subnet), it hands the envelope to the elevator: the default gateway. The elevator doesn’t open your envelope or care about the contents.\nIt just reads the outside, knows the destination is not on your floor, and takes the envelope to the lobby, where the concierge (router) can decide the next step.\nChecklist:\nSame floor → walk the hallway directly.\nDifferent floor / building → take the elevator (send to the default gateway).\nIn networking terms The default gateway is usually the IP address of a router on your local network. Your device compares the destination IP with its own IP + subnet mask: If they share the same network prefix → destination is local. If not → destination is remote → send to the default gateway. Before it can send frames to the gateway, your device needs the gateway’s MAC address, so it uses ARP to find it. Technical Deep Dive Default Gateway\nThe IP address of the router on your subnet that handles traffic that is not local. Your device learns this address via manual configuration or automatically (e.g. via DHCP).\nThe Decision Process\nTake your own IP and subnet mask. Take the destination IP and apply the same subnet mask. If the resulting network addresses match → send directly on the LAN. If they differ → send to the default gateway. ARP (Address Resolution Protocol)\nIP uses logical addresses (room numbers). Ethernet uses MAC addresses (door IDs).\nARP is the “Who lives in this room?” shout down the hallway:\nYour device broadcasts: “Who has IP 192.168.1.1?” The gateway replies: “That’s me, my MAC is AA:BB:CC:11:22:33.” Your device caches this mapping for a short time. ASCII Diagram – The Decision to Leave the Subnet +----------------------------------------------------+ | Your Laptop (192.168.1.101) | | | | Destination: 8.8.8.8 (Google's DNS Server) | | My Subnet Mask: 255.255.255.0 | | | | Logical Check: | | Is (8.8.8.8 AND 255.255.255.0) == 192.168.1.0 ? | | Result: No. | | | | Conclusion: Destination is on a different network.| | Send the packet to the gateway. | | | | Next Step: | | Who is my gateway? It's 192.168.1.1. | | What is its MAC address? (Send ARP request) | | Send packet to gateway's MAC address. | | | +----------------------------------------------------+ 2.2 The Concierge with the Map: The Router You step out of the elevator into the lobby.\nBehind the desk stands a calm concierge with a binder full of maps and directions.\nThe concierge is your router.\nThe concierge does not personally carry your envelope all the way across town.\nInstead, they do one simple and powerful thing:\nLook at the destination address and decide the next best place to send the envelope.\nThat binder of maps is the router’s routing table.\nA router does not need to know every possible path to every building in the city.\nIt only needs to know:\nWhich exits lead to which areas. Which neighbor concierges to send certain types of mail to. Where to send mail if it doesn’t recognize the destination (the default route). Examples from the concierge’s binder:\n“For floors 10–20 in this building → use the north elevator bank.” “For the building across the street (Building 101) → use the east-wing exit.” “For anything I don’t recognize → send it to the central post office downtown.” (default route) This hop-by-hop approach scales to the entire internet:\nEach router makes a local decision based on its routing table. A series of good local decisions creates a working end-to-end path. Routers keep their maps up to date in two main ways:\nStatic routes – manually configured entries. Dynamic routing protocols – routers exchange information with one another automatically. Mini case: The router is the network’s concierge, and its routing table is its map.\nIt doesn’t know the whole journey, just the smartest next hop.\nTechnical Deep Dive Routing Table\nA router’s internal table of “how to reach which networks.”\nTypical fields:\nDestination network + subnet mask. Next hop (the IP of the next router). Outgoing interface (which port to use). Metric (cost) to compare multiple possible routes. Static Routes\nManually configured entries:\nSimple, predictable, and don’t change automatically. Good for small, stable networks. Don’t adapt to failures or new paths without manual updates. Dynamic Routing Protocols Routers can talk to each other to keep routes up to date.\nInterior Gateway Protocols (IGPs) – used within one organization or autonomous system.\nExamples: OSPF, EIGRP, IS-IS.\nTheir job is to find efficient paths inside one network.\nExterior Gateway Protocol (EGP) – used between organizations on the internet.\nToday, the internet effectively uses a single EGP: BGP (Border Gateway Protocol).\nBGP is less about fastest path and more about policy:\nWhich routes are allowed? Which routes are preferred? Which paths reflect business relationships and agreements? Time To Live (TTL)\nWhat if a route is misconfigured and your envelope gets stuck bouncing between two concierges forever?\nTo prevent this, every IP packet has a TTL (Time To Live):\nStarts as a number like 64 or 128. Each router that forwards the packet subtracts 1. If TTL reaches 0, the router drops the packet and sends an ICMP “Time Exceeded” message back. The traceroute command uses this mechanism to map the path packets take.\nExample Routing Table (Simplified) Destination Next Hop Interface Metric ---------------------------------------------------- 192.168.1.0/24 (Connected) eth0 0 10.0.0.0/8 192.168.1.1 eth0 10 172.16.0.0/12 10.5.1.1 eth2 25 0.0.0.0/0 (Default) 203.0.113.1 eth1 100 Interpretation:\nTo reach the local floor (192.168.1.0/24) → send directly out eth0. To reach the corporate campus (10.0.0.0/8) → send to 192.168.1.1. To reach a partner network (172.16.0.0/12) → send to 10.5.1.1 via eth2. For anywhere else on the internet → use the default route via 203.0.113.1. 2.3 Envelopes and Mail Slots: Packets and Ports So far, we’ve focused on paths and guides.\nNow let’s look more closely at the thing being carried: the envelope itself.\nAn envelope is clever:\nThe outside has the addresses and postal markings. The inside has the message itself. In networking, a packet is your envelope:\nThe outside is the header (addressing + control information). The inside is the payload (your actual data). But there is another important detail: the mail slot.\nThink about a large office building.\nOne street address might contain:\nFinance on floor 3. Legal on floor 4. Marketing on floor 5. You don’t want a legal summons delivered to the cafeteria.\nThe building needs a way to deliver envelopes to the right department.\nIn networking, those mail slots are port numbers.\nA single computer can run many services at once:\nWeb server Email server SSH server Databases APIs Port numbers let the operating system act like a mailroom clerk:\n“Anything for slot 443 → deliver to the secure web server (HTTPS).” “Slot 22 → deliver to the SSH service.” “Slot 3306 → deliver to the MySQL database.” When your device sends a message, it also chooses a temporary return slot for itself: an ephemeral port. This is like using a temporary mailbox ID in the return address so that replies get back to the exact application that started the conversation.\nKey ideas:\nPackets are envelopes.\nPort numbers are labeled mail slots.\nSockets (IP + port) are the full combination of address + slot.\nTechnical Deep Dive Packet\nThe basic unit of data that routers forward.\nIncludes:\nOne or more headers (Ethernet, IP, TCP/UDP). The payload (your application data). Port Numbers (16-bit, 0–65535)\nWell-known ports (0–1023)\nReserved for standard services; require admin privileges.\nExamples: FTP (21), SSH (22), DNS (53), HTTP (80), HTTPS (443). Registered ports (1024–49151)\nUsed by applications that want predictable port assignments.\nExamples: MySQL (3306), PostgreSQL (5432). Dynamic / private / ephemeral ports (49152–65535)\nUsed temporarily by clients for outbound connections. Socket\nA specific endpoint: IP:Port, e.g. 198.51.100.10:443.\nThis combination identifies one side of a connection.\nEncapsulation\nAs your data goes down the stack:\nThe application data is wrapped in TCP or UDP. That is wrapped in an IP header. That is wrapped in an Ethernet header. Each layer adds its own envelope around your letter.\nPacket Header Analogy (Encapsulation) +--------------------------------------------------------------------+ | Outermost Envelope: Ethernet Frame (local hallway) | | TO: Concierge's Door (MAC) FROM: Your Door (MAC) | | | | +----------------------------------------------------------------+| | | Second Envelope: IP Packet (city-wide journey) || | | TO: Friend's Building (IP) FROM: Your Building (IP) || | | || | | +------------------------------------------------------------+|| | | | Third Envelope: TCP Segment (specific mail slot) ||| | | | TO: Friend's Mail Slot (Port) ||| | | | FROM: Your Mail Slot (Port) ||| | | | ||| | | | +----------------------------------------------------+ ||| | | | | Your Actual Letter | ||| | | | | (Payload) | ||| | | | +----------------------------------------------------+ ||| | | | ||| | | +------------------------------------------------------------+|| | | || | +----------------------------------------------------------------+| | | +--------------------------------------------------------------------+ 2.4 Registered Mail vs Postcards: TCP and UDP Even if your envelope reaches the right building, room, and mail slot, the style of conversation matters.\nProtocols define the rules of the conversation:\nHow we start and end it. How we confirm delivery. How we handle loss and reordering. For most applications on the internet, the two main protocols at this layer are TCP and UDP.\nTCP – Registered Mail with Tracking TCP (Transmission Control Protocol) is like registered mail with tracking and delivery confirmation:\nBefore any data is exchanged, both sides perform a three-way handshake:\nSYN – “I’d like to start a formal conversation. Are you ready?” SYN-ACK – “I received your request and I’m ready.” ACK – “Great, I got your acknowledgment. Let’s begin.” Once the connection is established:\nEach packet is numbered. The receiver sends acknowledgments for what it has received. Missing packets are detected and re-sent. TCP adjusts its sending rate to avoid overwhelming the network (congestion control). TCP is ideal when:\nEvery byte matters. Order matters. A bit of extra delay is acceptable. Common use cases:\nWeb browsing over HTTP/HTTPS. File downloads and uploads. Email protocols. UDP – Fast, No-Frills Postcard UDP (User Datagram Protocol) is like dropping a postcard in the mailbox:\nNo handshake. No automatic retransmission. No guarantee of order. Why use it?\nVery low overhead. No waiting for acknowledgments. Ideal when freshness is more important than perfection. Use cases:\nLive audio and video. Online gaming. DNS queries. VoIP. If a UDP packet is lost, the application decides whether to ignore it or request a retry.\nCore concepts:\nTCP – careful, reliable, and ordered (registered mail).\nUDP – simple, fast, and best-effort (postcard).\nTechnical Deep Dive TCP\nConnection-oriented (three-way handshake). Reliable and ordered delivery (sequence numbers + acknowledgments). Flow control (sliding window) so senders don’t overwhelm receivers. Congestion control (algorithms like CUBIC, BBR) to react to network conditions. UDP\nConnectionless (no handshake). No reliability guarantees; packets may be lost or reordered. Very small header; more of the packet is real data. Often used as a base layer for higher-level protocols that add their own reliability. QUIC (on top of UDP)\nA modern transport protocol that: Runs over UDP. Implements its own reliability and congestion control. Encrypts data by default. Forms the basis of HTTP/3, the latest generation of web transport. Comparison Table – TCP vs UDP | Feature | TCP (Registered Mail) | UDP (Postcard) | |--------------|----------------------------------------|------------------------------------| | Connection | Connection-oriented (handshake) | Connectionless | | Reliability | High (guaranteed delivery \u0026 order) | Low (no guarantees) | | Ordering | In-order delivery | No guaranteed order | | Speed | Slower (more overhead, more checks) | Faster (less overhead) | | Header Size | 20 bytes or more | 8 bytes | | Typical Use | Web, email, file transfer | Streaming, gaming, DNS, VoIP | 2.5 The City Directory: DNS You have your envelope, you know how to reach the streets, and you know routers will guide it.\nBut there is a problem:\nYour letter is addressed to “My Friend, Akihabara”, not:\nTokyo, Chiyoda City, Kanda-Hanaokacho 1-1\nYou have a name, but the city needs a precise address.\nEnter the city directory: the Domain Name System (DNS).\nDNS is the internet’s address book. It does one main job, millions of times per second:\nTranslate human-friendly names (like google.com) into machine-friendly IP addresses (like 142.250.196.78).\nThe process looks like this:\nYour device wants to reach friends-apartment.tokyo. It asks a DNS server: “What is the IP address for friends-apartment.tokyo?” The DNS server looks it up (or asks other DNS servers). It replies with the IP address. With that IP address, your router now knows which building to start sending the envelope toward. To avoid asking the directory every time:\nThe first time you look up an address, you remember it. Your computer does the same: it stores recent DNS results in a cache, speeding up future requests. Key idea: DNS turns names into addresses so that routers can do their job.\nTechnical Deep Dive DNS (Domain Name System)\nA hierarchical, distributed naming system. Maps names (domains) to records (A, AAAA, CNAME, etc.). DNS Query\nA client sending a request like “What is the IP for example.com?” The DNS server responds with records that answer the question. DNS Cache\nStored locally by your OS, browser, or recursive DNS resolver. Each record has a TTL (time to live) after which it must be refreshed. Recursive DNS Server\nDoes the work on your behalf: If it doesn’t know the answer, it queries other DNS servers. It walks the hierarchy (root → TLD → authoritative) until it finds the authoritative answer. Authoritative DNS Server\nHolds the official records for a domain. Answers questions like: “What is the IPv4 address for www.example.com?” “Which mail server handles email for this domain?” Recap and Small Exercises What You Should Now Be Able to Explain By the end of this chapter, you should be comfortable describing:\nThe default gateway as the elevator out of your floor. Routers as concierges that know the next hop but not the entire path. Packets as envelopes and ports as labeled mail slots. The difference between TCP and UDP and when each is appropriate. DNS as the city directory that converts names into IP addresses. Exercises Find Your Default Gateway\nOn your computer, find: Your IP address. Your subnet mask. Your default gateway. Check whether a destination (e.g. 8.8.8.8) is on your subnet or not. Run a Traceroute\nRun traceroute (or tracert on Windows) to a website you use often. Count how many “concierges” (routers) your packets go through. Notice where the latency (round-trip time) increases. List Open Connections\nUse a command like netstat or ss to view active connections. For a browser tab, identify: Local IP and port (your side). Remote IP and port (server side). Interpret them as sockets (IP:Port) and map them to services (e.g. port 443 → HTTPS). Inspect DNS Resolution\nUse tools like nslookup, dig, or your browser’s developer tools to see DNS lookups. Look up a hostname and examine: The IP address returned. The TTL. Try again later and see whether the request is served from cache or re-resolved. In the next part, we’ll move from city streets to hotels as the cloud.\nYou’ll see how cloud providers carve up giant buildings into virtual floors and rooms (VPCs, subnets, endpoints) that you can rent and connect to the rest of the city.\n","wordCount":"2910","inLanguage":"en","datePublished":"2025-10-18T22:39:16+09:00","dateModified":"2025-11-13T22:11:49+09:00","author":{"@type":"Person","name":"Memo Garcia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://memo.mx/posts/understanding-computer-networks-by-analogy-part-2/"},"publisher":{"@type":"Person","name":"Memo Garcia","logo":{"@type":"ImageObject","url":"https://memo.mx/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://memo.mx/ accesskey=h title="Memo Garcia (Alt + H)">Memo Garcia</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://memo.mx/labs/ title=Labs><span>Labs</span></a></li><li><a href=https://memo.mx/books/ title=Books><span>Books</span></a></li><li><a href=https://memo.mx/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Understanding Computer Networks by Analogy: Part 2 - Cities as the Internet</h1><div class=post-meta><span title='2025-10-18 22:39:16 +0900 +0900'>October 18, 2025</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;Memo Garcia</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#what-this-chapter-covers aria-label="What This Chapter Covers">What This Chapter Covers</a></li><li><a href=#chapter-2-cities-as-the-internet aria-label="Chapter 2: Cities as the Internet">Chapter 2: Cities as the Internet</a></li><li><a href=#21-the-elevator-to-other-floors-your-gateway aria-label="2.1 The Elevator to Other Floors: Your Gateway">2.1 The Elevator to Other Floors: Your Gateway</a><ul><li><a href=#in-networking-terms aria-label="In networking terms">In networking terms</a></li><li><a href=#technical-deep-dive aria-label="Technical Deep Dive">Technical Deep Dive</a><ul><li><a href=#ascii-diagram--the-decision-to-leave-the-subnet aria-label="ASCII Diagram – The Decision to Leave the Subnet">ASCII Diagram – The Decision to Leave the Subnet</a></li></ul></li></ul></li><li><a href=#22-the-concierge-with-the-map-the-router aria-label="2.2 The Concierge with the Map: The Router">2.2 The Concierge with the Map: The Router</a><ul><li><a href=#technical-deep-dive-1 aria-label="Technical Deep Dive">Technical Deep Dive</a><ul><li><a href=#example-routing-table-simplified aria-label="Example Routing Table (Simplified)">Example Routing Table (Simplified)</a></li></ul></li></ul></li><li><a href=#23-envelopes-and-mail-slots-packets-and-ports aria-label="2.3 Envelopes and Mail Slots: Packets and Ports">2.3 Envelopes and Mail Slots: Packets and Ports</a><ul><li><a href=#technical-deep-dive-2 aria-label="Technical Deep Dive">Technical Deep Dive</a><ul><li><a href=#packet-header-analogy-encapsulation aria-label="Packet Header Analogy (Encapsulation)">Packet Header Analogy (Encapsulation)</a></li></ul></li></ul></li><li><a href=#24-registered-mail-vs-postcards-tcp-and-udp aria-label="2.4 Registered Mail vs Postcards: TCP and UDP">2.4 Registered Mail vs Postcards: TCP and UDP</a><ul><li><a href=#tcp--registered-mail-with-tracking aria-label="TCP – Registered Mail with Tracking">TCP – Registered Mail with Tracking</a></li><li><a href=#udp--fast-no-frills-postcard aria-label="UDP – Fast, No-Frills Postcard">UDP – Fast, No-Frills Postcard</a></li><li><a href=#technical-deep-dive-3 aria-label="Technical Deep Dive">Technical Deep Dive</a><ul><li><a href=#comparison-table--tcp-vs-udp aria-label="Comparison Table – TCP vs UDP">Comparison Table – TCP vs UDP</a></li></ul></li></ul></li><li><a href=#25-the-city-directory-dns aria-label="2.5 The City Directory: DNS">2.5 The City Directory: DNS</a><ul><li><a href=#technical-deep-dive-4 aria-label="Technical Deep Dive">Technical Deep Dive</a></li></ul></li><li><a href=#recap-and-small-exercises aria-label="Recap and Small Exercises">Recap and Small Exercises</a><ul><li><a href=#what-you-should-now-be-able-to-explain aria-label="What You Should Now Be Able to Explain">What You Should Now Be Able to Explain</a></li><li><a href=#exercises aria-label=Exercises>Exercises</a></li></ul></li></ul></div></details></div><div class=post-content><blockquote><p>Think of the internet as a city full of buildings and streets.<br>Routers are concierges, gateways are elevators, packets are envelopes, and DNS is the city directory that keeps everyone from getting lost.</p></blockquote><p>License for this chapter: CC BY-NC-ND 4.0</p><hr><h2 id=what-this-chapter-covers>What This Chapter Covers<a hidden class=anchor aria-hidden=true href=#what-this-chapter-covers>#</a></h2><p>In Part 1, we stayed inside a single building: your local network (LAN).<br>In this chapter, we step outside into the city and follow one envelope on its journey across the internet.</p><p>By the end of this chapter, you should be able to:</p><ul><li>Explain what a <strong>default gateway</strong> is and when your device uses it.</li><li>Describe what <strong>routers</strong> do and how they use <strong>routing tables</strong> and <strong>routing protocols</strong>.</li><li>Understand <strong>packets</strong>, <strong>ports</strong>, <strong>sockets</strong>, and <strong>encapsulation</strong>.</li><li>Compare <strong>TCP</strong> and <strong>UDP</strong> and know when each is appropriate.</li><li>Explain what <strong>DNS</strong> does and why it matters for everyday networking.</li></ul><hr><h2 id=chapter-2-cities-as-the-internet>Chapter 2: Cities as the Internet<a hidden class=anchor aria-hidden=true href=#chapter-2-cities-as-the-internet>#</a></h2><p>In Part 1, we explored your building: rooms (devices), doors (interfaces), hallways (links), and floors (subnets).</p><p>But your friend doesn’t live in your building. They live across town, in a different building entirely. To reach them, your envelope has to leave your floor, exit your building, and navigate the city’s streets.</p><p>In this city:</p><ul><li>Each <strong>building</strong> is a separate network.</li><li><strong>Streets and intersections</strong> are the links between networks.</li><li><strong>Concierges</strong> at each lobby are <strong>routers</strong>, deciding where to send your envelope next.</li><li>A <strong>city directory</strong> (DNS) helps turn names into precise addresses.</li></ul><p>We’ll follow your envelope step by step, from your room to your friend’s room across the city.</p><hr><h2 id=21-the-elevator-to-other-floors-your-gateway>2.1 The Elevator to Other Floors: Your Gateway<a hidden class=anchor aria-hidden=true href=#21-the-elevator-to-other-floors-your-gateway>#</a></h2><p>Imagine you’re standing in the hallway on the 10th floor, holding a letter for your friend.<br>You know she lives on the 25th floor of a building across town.</p><p>You can walk up and down your hallway all day and never reach her.<br>To leave your floor, you need the elevator.</p><p>In networking terms, that elevator is your <strong>default gateway</strong>.</p><p>Every time your device sends a message, it quietly answers one question:</p><blockquote><p>“Is this destination on my floor, or somewhere else?”</p></blockquote><ul><li>If the destination is on your <strong>floor</strong> (same subnet), your device can deliver the message directly by “walking down the hallway.”</li><li>If the destination is on <strong>another floor or building</strong> (another subnet), it hands the envelope to the elevator: the <strong>default gateway</strong>.</li></ul><p>The elevator doesn’t open your envelope or care about the contents.<br>It just reads the outside, knows the destination is not on your floor, and takes the envelope to the <strong>lobby</strong>, where the concierge (router) can decide the next step.</p><blockquote><p><strong>Checklist:</strong><br>Same floor → walk the hallway directly.<br>Different floor / building → take the elevator (send to the default gateway).</p></blockquote><h3 id=in-networking-terms>In networking terms<a hidden class=anchor aria-hidden=true href=#in-networking-terms>#</a></h3><ul><li>The <strong>default gateway</strong> is usually the IP address of a router on your local network.</li><li>Your device compares the <strong>destination IP</strong> with its own <strong>IP + subnet mask</strong>:<ul><li>If they share the same network prefix → destination is local.</li><li>If not → destination is remote → send to the default gateway.</li></ul></li><li>Before it can send frames to the gateway, your device needs the gateway’s <strong>MAC address</strong>, so it uses <strong>ARP</strong> to find it.</li></ul><h3 id=technical-deep-dive>Technical Deep Dive<a hidden class=anchor aria-hidden=true href=#technical-deep-dive>#</a></h3><ul><li><p><strong>Default Gateway</strong><br>The IP address of the router on your subnet that handles traffic that is not local. Your device learns this address via manual configuration or automatically (e.g. via DHCP).</p></li><li><p><strong>The Decision Process</strong></p><ol><li>Take your own IP and subnet mask.</li><li>Take the destination IP and apply the same subnet mask.</li><li>If the resulting network addresses match → send directly on the LAN.</li><li>If they differ → send to the default gateway.</li></ol></li><li><p><strong>ARP (Address Resolution Protocol)</strong><br>IP uses logical addresses (room numbers). Ethernet uses MAC addresses (door IDs).<br>ARP is the “Who lives in this room?” shout down the hallway:</p><ul><li>Your device broadcasts: “Who has IP <code>192.168.1.1</code>?”</li><li>The gateway replies: “That’s me, my MAC is <code>AA:BB:CC:11:22:33</code>.”</li><li>Your device caches this mapping for a short time.</li></ul></li></ul><h4 id=ascii-diagram--the-decision-to-leave-the-subnet>ASCII Diagram – The Decision to Leave the Subnet<a hidden class=anchor aria-hidden=true href=#ascii-diagram--the-decision-to-leave-the-subnet>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>+----------------------------------------------------+
</span></span><span class=line><span class=cl>| Your Laptop (192.168.1.101)                        |
</span></span><span class=line><span class=cl>|                                                    |
</span></span><span class=line><span class=cl>|  Destination: 8.8.8.8 (Google&#39;s DNS Server)        |
</span></span><span class=line><span class=cl>|  My Subnet Mask: 255.255.255.0                     |
</span></span><span class=line><span class=cl>|                                                    |
</span></span><span class=line><span class=cl>|  Logical Check:                                    |
</span></span><span class=line><span class=cl>|    Is (8.8.8.8 AND 255.255.255.0) == 192.168.1.0 ? |
</span></span><span class=line><span class=cl>|    Result: No.                                     |
</span></span><span class=line><span class=cl>|                                                    |
</span></span><span class=line><span class=cl>|  Conclusion: Destination is on a different network.|
</span></span><span class=line><span class=cl>|              Send the packet to the gateway.       |
</span></span><span class=line><span class=cl>|                                                    |
</span></span><span class=line><span class=cl>|  Next Step:                                        |
</span></span><span class=line><span class=cl>|    Who is my gateway? It&#39;s 192.168.1.1.            |
</span></span><span class=line><span class=cl>|    What is its MAC address? (Send ARP request)     |
</span></span><span class=line><span class=cl>|    Send packet to gateway&#39;s MAC address.           |
</span></span><span class=line><span class=cl>|                                                    |
</span></span><span class=line><span class=cl>+----------------------------------------------------+
</span></span></code></pre></div><hr><h2 id=22-the-concierge-with-the-map-the-router>2.2 The Concierge with the Map: The Router<a hidden class=anchor aria-hidden=true href=#22-the-concierge-with-the-map-the-router>#</a></h2><p>You step out of the elevator into the lobby.<br>Behind the desk stands a calm concierge with a binder full of maps and directions.</p><p>The concierge is your <strong>router</strong>.</p><p>The concierge does not personally carry your envelope all the way across town.<br>Instead, they do one simple and powerful thing:</p><blockquote><p>Look at the destination address and decide the <strong>next best place</strong> to send the envelope.</p></blockquote><p>That binder of maps is the router’s <strong>routing table</strong>.</p><p>A router does not need to know every possible path to every building in the city.<br>It only needs to know:</p><ul><li>Which exits lead to which areas.</li><li>Which neighbor concierges to send certain types of mail to.</li><li>Where to send mail if it doesn’t recognize the destination (the <strong>default route</strong>).</li></ul><p>Examples from the concierge’s binder:</p><ul><li>“For floors 10–20 in this building → use the north elevator bank.”</li><li>“For the building across the street (Building 101) → use the east-wing exit.”</li><li>“For anything I don’t recognize → send it to the central post office downtown.” (default route)</li></ul><p>This <strong>hop-by-hop</strong> approach scales to the entire internet:</p><ul><li>Each router makes a <strong>local</strong> decision based on its routing table.</li><li>A series of good local decisions creates a working end-to-end path.</li></ul><p>Routers keep their maps up to date in two main ways:</p><ul><li><strong>Static routes</strong> – manually configured entries.</li><li><strong>Dynamic routing protocols</strong> – routers exchange information with one another automatically.</li></ul><blockquote><p><strong>Mini case:</strong> The router is the network’s concierge, and its routing table is its map.<br>It doesn’t know the whole journey, just the smartest next hop.</p></blockquote><h3 id=technical-deep-dive-1>Technical Deep Dive<a hidden class=anchor aria-hidden=true href=#technical-deep-dive-1>#</a></h3><ul><li><p><strong>Routing Table</strong><br>A router’s internal table of “how to reach which networks.”<br>Typical fields:</p><ul><li>Destination network + subnet mask.</li><li>Next hop (the IP of the next router).</li><li>Outgoing interface (which port to use).</li><li>Metric (cost) to compare multiple possible routes.</li></ul></li><li><p><strong>Static Routes</strong><br>Manually configured entries:</p><ul><li>Simple, predictable, and don’t change automatically.</li><li>Good for small, stable networks.</li><li>Don’t adapt to failures or new paths without manual updates.</li></ul></li><li><p><strong>Dynamic Routing Protocols</strong>
Routers can talk to each other to keep routes up to date.</p><ul><li><p><strong>Interior Gateway Protocols (IGPs)</strong> – used <strong>within</strong> one organization or autonomous system.<br>Examples: <strong>OSPF</strong>, <strong>EIGRP</strong>, IS-IS.<br>Their job is to find efficient paths inside one network.</p></li><li><p><strong>Exterior Gateway Protocol (EGP)</strong> – used <strong>between</strong> organizations on the internet.<br>Today, the internet effectively uses a single EGP: <strong>BGP</strong> (Border Gateway Protocol).<br>BGP is less about fastest path and more about <strong>policy</strong>:</p><ul><li>Which routes are allowed?</li><li>Which routes are preferred?</li><li>Which paths reflect business relationships and agreements?</li></ul></li></ul></li><li><p><strong>Time To Live (TTL)</strong><br>What if a route is misconfigured and your envelope gets stuck bouncing between two concierges forever?</p><p>To prevent this, every IP packet has a <strong>TTL</strong> (Time To Live):</p><ul><li>Starts as a number like 64 or 128.</li><li>Each router that forwards the packet subtracts 1.</li><li>If TTL reaches 0, the router drops the packet and sends an ICMP “Time Exceeded” message back.</li></ul><p>The <code>traceroute</code> command uses this mechanism to map the path packets take.</p></li></ul><h4 id=example-routing-table-simplified>Example Routing Table (Simplified)<a hidden class=anchor aria-hidden=true href=#example-routing-table-simplified>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Destination         Next Hop      Interface    Metric
</span></span><span class=line><span class=cl>----------------------------------------------------
</span></span><span class=line><span class=cl>192.168.1.0/24      (Connected)   eth0         0
</span></span><span class=line><span class=cl>10.0.0.0/8          192.168.1.1   eth0        10
</span></span><span class=line><span class=cl>172.16.0.0/12       10.5.1.1      eth2        25
</span></span><span class=line><span class=cl>0.0.0.0/0 (Default) 203.0.113.1   eth1       100
</span></span></code></pre></div><p>Interpretation:</p><ol><li>To reach the <strong>local floor</strong> (<code>192.168.1.0/24</code>) → send directly out <code>eth0</code>.</li><li>To reach the <strong>corporate campus</strong> (<code>10.0.0.0/8</code>) → send to <code>192.168.1.1</code>.</li><li>To reach a <strong>partner network</strong> (<code>172.16.0.0/12</code>) → send to <code>10.5.1.1</code> via <code>eth2</code>.</li><li>For <strong>anywhere else on the internet</strong> → use the default route via <code>203.0.113.1</code>.</li></ol><hr><h2 id=23-envelopes-and-mail-slots-packets-and-ports>2.3 Envelopes and Mail Slots: Packets and Ports<a hidden class=anchor aria-hidden=true href=#23-envelopes-and-mail-slots-packets-and-ports>#</a></h2><p>So far, we’ve focused on <strong>paths</strong> and <strong>guides</strong>.<br>Now let’s look more closely at the thing being carried: the envelope itself.</p><p>An envelope is clever:</p><ul><li>The outside has the <strong>addresses</strong> and postal markings.</li><li>The inside has the <strong>message</strong> itself.</li></ul><p>In networking, a <strong>packet</strong> is your envelope:</p><ul><li>The outside is the <strong>header</strong> (addressing + control information).</li><li>The inside is the <strong>payload</strong> (your actual data).</li></ul><p>But there is another important detail: the <strong>mail slot</strong>.</p><p>Think about a large office building.<br>One street address might contain:</p><ul><li>Finance on floor 3.</li><li>Legal on floor 4.</li><li>Marketing on floor 5.</li></ul><p>You don’t want a legal summons delivered to the cafeteria.<br>The building needs a way to deliver envelopes to the <strong>right department</strong>.</p><p>In networking, those mail slots are <strong>port numbers</strong>.</p><p>A single computer can run many services at once:</p><ul><li>Web server</li><li>Email server</li><li>SSH server</li><li>Databases</li><li>APIs</li></ul><p>Port numbers let the operating system act like a <strong>mailroom clerk</strong>:</p><ul><li>“Anything for slot <strong>443</strong> → deliver to the secure web server (HTTPS).”</li><li>“Slot <strong>22</strong> → deliver to the SSH service.”</li><li>“Slot <strong>3306</strong> → deliver to the MySQL database.”</li></ul><p>When your device sends a message, it also chooses a temporary <strong>return slot</strong> for itself: an <strong>ephemeral port</strong>. This is like using a temporary mailbox ID in the return address so that replies get back to the exact application that started the conversation.</p><blockquote><p><strong>Key ideas:</strong><br>Packets are envelopes.<br>Port numbers are labeled mail slots.<br>Sockets (IP + port) are the full combination of address + slot.</p></blockquote><h3 id=technical-deep-dive-2>Technical Deep Dive<a hidden class=anchor aria-hidden=true href=#technical-deep-dive-2>#</a></h3><ul><li><p><strong>Packet</strong><br>The basic unit of data that routers forward.<br>Includes:</p><ul><li>One or more headers (Ethernet, IP, TCP/UDP).</li><li>The payload (your application data).</li></ul></li><li><p><strong>Port Numbers</strong> (16-bit, 0–65535)</p><ul><li><strong>Well-known ports (0–1023)</strong><br>Reserved for standard services; require admin privileges.<br>Examples: FTP (21), SSH (22), DNS (53), HTTP (80), HTTPS (443).</li><li><strong>Registered ports (1024–49151)</strong><br>Used by applications that want predictable port assignments.<br>Examples: MySQL (3306), PostgreSQL (5432).</li><li><strong>Dynamic / private / ephemeral ports (49152–65535)</strong><br>Used temporarily by clients for outbound connections.</li></ul></li><li><p><strong>Socket</strong><br>A specific endpoint: <code>IP:Port</code>, e.g. <code>198.51.100.10:443</code>.<br>This combination identifies one side of a connection.</p></li><li><p><strong>Encapsulation</strong><br>As your data goes down the stack:</p><ul><li>The application data is wrapped in <strong>TCP or UDP</strong>.</li><li>That is wrapped in an <strong>IP</strong> header.</li><li>That is wrapped in an <strong>Ethernet</strong> header.</li></ul><p>Each layer adds its own envelope around your letter.</p></li></ul><h4 id=packet-header-analogy-encapsulation>Packet Header Analogy (Encapsulation)<a hidden class=anchor aria-hidden=true href=#packet-header-analogy-encapsulation>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>+--------------------------------------------------------------------+
</span></span><span class=line><span class=cl>| Outermost Envelope: Ethernet Frame (local hallway)                 |
</span></span><span class=line><span class=cl>|  TO: Concierge&#39;s Door (MAC)  FROM: Your Door (MAC)                 |
</span></span><span class=line><span class=cl>|                                                                    |
</span></span><span class=line><span class=cl>|  +----------------------------------------------------------------+|
</span></span><span class=line><span class=cl>|  | Second Envelope: IP Packet (city-wide journey)                 ||
</span></span><span class=line><span class=cl>|  |  TO: Friend&#39;s Building (IP)  FROM: Your Building (IP)          ||
</span></span><span class=line><span class=cl>|  |                                                                ||
</span></span><span class=line><span class=cl>|  |  +------------------------------------------------------------+||
</span></span><span class=line><span class=cl>|  |  | Third Envelope: TCP Segment (specific mail slot)           |||
</span></span><span class=line><span class=cl>|  |  |   TO: Friend&#39;s Mail Slot (Port)                            |||
</span></span><span class=line><span class=cl>|  |  |   FROM: Your Mail Slot (Port)                              |||
</span></span><span class=line><span class=cl>|  |  |                                                            |||
</span></span><span class=line><span class=cl>|  |  |   +----------------------------------------------------+   |||
</span></span><span class=line><span class=cl>|  |  |   |                Your Actual Letter                  |   |||
</span></span><span class=line><span class=cl>|  |  |   |                    (Payload)                       |   |||
</span></span><span class=line><span class=cl>|  |  |   +----------------------------------------------------+   |||
</span></span><span class=line><span class=cl>|  |  |                                                            |||
</span></span><span class=line><span class=cl>|  |  +------------------------------------------------------------+||
</span></span><span class=line><span class=cl>|  |                                                                ||
</span></span><span class=line><span class=cl>|  +----------------------------------------------------------------+|
</span></span><span class=line><span class=cl>|                                                                    |
</span></span><span class=line><span class=cl>+--------------------------------------------------------------------+
</span></span></code></pre></div><hr><h2 id=24-registered-mail-vs-postcards-tcp-and-udp>2.4 Registered Mail vs Postcards: TCP and UDP<a hidden class=anchor aria-hidden=true href=#24-registered-mail-vs-postcards-tcp-and-udp>#</a></h2><p>Even if your envelope reaches the right building, room, and mail slot, the <strong>style of conversation</strong> matters.</p><p>Protocols define the rules of the conversation:</p><ul><li>How we start and end it.</li><li>How we confirm delivery.</li><li>How we handle loss and reordering.</li></ul><p>For most applications on the internet, the two main protocols at this layer are <strong>TCP</strong> and <strong>UDP</strong>.</p><h3 id=tcp--registered-mail-with-tracking>TCP – Registered Mail with Tracking<a hidden class=anchor aria-hidden=true href=#tcp--registered-mail-with-tracking>#</a></h3><p>TCP (Transmission Control Protocol) is like <strong>registered mail</strong> with tracking and delivery confirmation:</p><ul><li><p>Before any data is exchanged, both sides perform a <strong>three-way handshake</strong>:</p><ol><li><strong>SYN</strong> – “I’d like to start a formal conversation. Are you ready?”</li><li><strong>SYN-ACK</strong> – “I received your request and I’m ready.”</li><li><strong>ACK</strong> – “Great, I got your acknowledgment. Let’s begin.”</li></ol></li><li><p>Once the connection is established:</p><ul><li>Each packet is numbered.</li><li>The receiver sends <strong>acknowledgments</strong> for what it has received.</li><li>Missing packets are detected and re-sent.</li><li>TCP adjusts its sending rate to avoid overwhelming the network (congestion control).</li></ul></li></ul><p>TCP is ideal when:</p><ul><li>Every byte matters.</li><li>Order matters.</li><li>A bit of extra delay is acceptable.</li></ul><p>Common use cases:</p><ul><li>Web browsing over HTTP/HTTPS.</li><li>File downloads and uploads.</li><li>Email protocols.</li></ul><h3 id=udp--fast-no-frills-postcard>UDP – Fast, No-Frills Postcard<a hidden class=anchor aria-hidden=true href=#udp--fast-no-frills-postcard>#</a></h3><p>UDP (User Datagram Protocol) is like dropping a <strong>postcard</strong> in the mailbox:</p><ul><li>No handshake.</li><li>No automatic retransmission.</li><li>No guarantee of order.</li></ul><p>Why use it?</p><ul><li>Very low overhead.</li><li>No waiting for acknowledgments.</li><li>Ideal when <strong>freshness</strong> is more important than <strong>perfection</strong>.</li></ul><p>Use cases:</p><ul><li>Live audio and video.</li><li>Online gaming.</li><li>DNS queries.</li><li>VoIP.</li></ul><p>If a UDP packet is lost, the application decides whether to ignore it or request a retry.</p><blockquote><p><strong>Core concepts:</strong><br>TCP – careful, reliable, and ordered (registered mail).<br>UDP – simple, fast, and best-effort (postcard).</p></blockquote><h3 id=technical-deep-dive-3>Technical Deep Dive<a hidden class=anchor aria-hidden=true href=#technical-deep-dive-3>#</a></h3><ul><li><p><strong>TCP</strong></p><ul><li>Connection-oriented (three-way handshake).</li><li>Reliable and ordered delivery (sequence numbers + acknowledgments).</li><li>Flow control (sliding window) so senders don’t overwhelm receivers.</li><li>Congestion control (algorithms like CUBIC, BBR) to react to network conditions.</li></ul></li><li><p><strong>UDP</strong></p><ul><li>Connectionless (no handshake).</li><li>No reliability guarantees; packets may be lost or reordered.</li><li>Very small header; more of the packet is real data.</li><li>Often used as a base layer for higher-level protocols that add their own reliability.</li></ul></li><li><p><strong>QUIC (on top of UDP)</strong></p><ul><li>A modern transport protocol that:<ul><li>Runs over UDP.</li><li>Implements its own reliability and congestion control.</li><li>Encrypts data by default.</li></ul></li><li>Forms the basis of <strong>HTTP/3</strong>, the latest generation of web transport.</li></ul></li></ul><h4 id=comparison-table--tcp-vs-udp>Comparison Table – TCP vs UDP<a hidden class=anchor aria-hidden=true href=#comparison-table--tcp-vs-udp>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>| Feature       | TCP (Registered Mail)                 | UDP (Postcard)                     |
</span></span><span class=line><span class=cl>|--------------|----------------------------------------|------------------------------------|
</span></span><span class=line><span class=cl>| Connection   | Connection-oriented (handshake)        | Connectionless                     |
</span></span><span class=line><span class=cl>| Reliability  | High (guaranteed delivery <span class=err>&amp;</span> order)     | Low (no guarantees)                |
</span></span><span class=line><span class=cl>| Ordering     | In-order delivery                      | No guaranteed order                |
</span></span><span class=line><span class=cl>| Speed        | Slower (more overhead, more checks)    | Faster (less overhead)             |
</span></span><span class=line><span class=cl>| Header Size  | 20 bytes or more                       | 8 bytes                            |
</span></span><span class=line><span class=cl>| Typical Use  | Web, email, file transfer              | Streaming, gaming, DNS, VoIP       |
</span></span></code></pre></div><hr><h2 id=25-the-city-directory-dns>2.5 The City Directory: DNS<a hidden class=anchor aria-hidden=true href=#25-the-city-directory-dns>#</a></h2><p>You have your envelope, you know how to reach the streets, and you know routers will guide it.<br>But there is a problem:</p><p>Your letter is addressed to <strong>“My Friend, Akihabara”</strong>, not:</p><blockquote><p>Tokyo, Chiyoda City, Kanda-Hanaokacho 1-1</p></blockquote><p>You have a <strong>name</strong>, but the city needs a <strong>precise address</strong>.</p><p>Enter the <strong>city directory</strong>: the Domain Name System (DNS).</p><p>DNS is the internet’s <strong>address book</strong>. It does one main job, millions of times per second:</p><blockquote><p>Translate human-friendly names (like <code>google.com</code>) into machine-friendly IP addresses (like <code>142.250.196.78</code>).</p></blockquote><p>The process looks like this:</p><ol><li>Your device wants to reach <code>friends-apartment.tokyo</code>.</li><li>It asks a DNS server: “What is the IP address for <code>friends-apartment.tokyo</code>?”</li><li>The DNS server looks it up (or asks other DNS servers).</li><li>It replies with the IP address.</li><li>With that IP address, your router now knows which <strong>building</strong> to start sending the envelope toward.</li></ol><p>To avoid asking the directory every time:</p><ul><li>The first time you look up an address, you remember it.</li><li>Your computer does the same: it stores recent DNS results in a <strong>cache</strong>, speeding up future requests.</li></ul><blockquote><p><strong>Key idea:</strong> DNS turns names into addresses so that routers can do their job.</p></blockquote><h3 id=technical-deep-dive-4>Technical Deep Dive<a hidden class=anchor aria-hidden=true href=#technical-deep-dive-4>#</a></h3><ul><li><p><strong>DNS (Domain Name System)</strong></p><ul><li>A hierarchical, distributed naming system.</li><li>Maps names (domains) to records (A, AAAA, CNAME, etc.).</li></ul></li><li><p><strong>DNS Query</strong></p><ul><li>A client sending a request like “What is the IP for <code>example.com</code>?”</li><li>The DNS server responds with records that answer the question.</li></ul></li><li><p><strong>DNS Cache</strong></p><ul><li>Stored locally by your OS, browser, or recursive DNS resolver.</li><li>Each record has a <strong>TTL</strong> (time to live) after which it must be refreshed.</li></ul></li><li><p><strong>Recursive DNS Server</strong></p><ul><li>Does the work on your behalf:<ul><li>If it doesn’t know the answer, it queries other DNS servers.</li><li>It walks the hierarchy (root → TLD → authoritative) until it finds the authoritative answer.</li></ul></li></ul></li><li><p><strong>Authoritative DNS Server</strong></p><ul><li>Holds the official records for a domain.</li><li>Answers questions like:<ul><li>“What is the IPv4 address for <code>www.example.com</code>?”</li><li>“Which mail server handles email for this domain?”</li></ul></li></ul></li></ul><hr><h2 id=recap-and-small-exercises>Recap and Small Exercises<a hidden class=anchor aria-hidden=true href=#recap-and-small-exercises>#</a></h2><h3 id=what-you-should-now-be-able-to-explain>What You Should Now Be Able to Explain<a hidden class=anchor aria-hidden=true href=#what-you-should-now-be-able-to-explain>#</a></h3><p>By the end of this chapter, you should be comfortable describing:</p><ul><li>The <strong>default gateway</strong> as the elevator out of your floor.</li><li>Routers as <strong>concierges</strong> that know the next hop but not the entire path.</li><li><strong>Packets</strong> as envelopes and <strong>ports</strong> as labeled mail slots.</li><li>The difference between <strong>TCP</strong> and <strong>UDP</strong> and when each is appropriate.</li><li><strong>DNS</strong> as the city directory that converts names into IP addresses.</li></ul><h3 id=exercises>Exercises<a hidden class=anchor aria-hidden=true href=#exercises>#</a></h3><ol><li><p><strong>Find Your Default Gateway</strong></p><ul><li>On your computer, find:<ul><li>Your IP address.</li><li>Your subnet mask.</li><li>Your default gateway.</li></ul></li><li>Check whether a destination (e.g. <code>8.8.8.8</code>) is on your subnet or not.</li></ul></li><li><p><strong>Run a Traceroute</strong></p><ul><li>Run <code>traceroute</code> (or <code>tracert</code> on Windows) to a website you use often.</li><li>Count how many “concierges” (routers) your packets go through.</li><li>Notice where the latency (round-trip time) increases.</li></ul></li><li><p><strong>List Open Connections</strong></p><ul><li>Use a command like <code>netstat</code> or <code>ss</code> to view active connections.</li><li>For a browser tab, identify:<ul><li>Local IP and port (your side).</li><li>Remote IP and port (server side).</li></ul></li><li>Interpret them as sockets (<code>IP:Port</code>) and map them to services (e.g. port 443 → HTTPS).</li></ul></li><li><p><strong>Inspect DNS Resolution</strong></p><ul><li>Use tools like <code>nslookup</code>, <code>dig</code>, or your browser’s developer tools to see DNS lookups.</li><li>Look up a hostname and examine:<ul><li>The IP address returned.</li><li>The TTL.</li></ul></li><li>Try again later and see whether the request is served from cache or re-resolved.</li></ul></li></ol><hr><p>In the next part, we’ll move from city streets to <strong>hotels as the cloud</strong>.<br>You’ll see how cloud providers carve up giant buildings into virtual floors and rooms (VPCs, subnets, endpoints) that you can rent and connect to the rest of the city.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://memo.mx/posts/understanding-computer-networks-by-analogy-appendices/><span class=title>« Prev</span><br><span>Understanding Computer Networks by Analogy: Appendices</span>
</a><a class=next href=https://memo.mx/posts/understanding-computer-networks-by-analogy-part-3/><span class=title>Next »</span><br><span>Understanding Computer Networks by Analogy: Part 3 - Hotels as the Cloud</span></a></nav></footer></article></main><footer class=footer></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
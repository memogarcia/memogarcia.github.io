<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Understanding Computer Networks by Analogy: Part 2 - The Hotel City (Cloud) | Memo Garcia</title>
<meta name=keywords content><meta name=description content="Part II: The Hotel City (Cloud) Moving to the cloud feels like moving into a serviced hotel. You do not build the walls or run the elevators. You rent space, bring your rules, and let the hotel handle power, plumbing, and staff. In this part, we take our building and city mental model and extend it to hotels, private floors, and the pathways that connect everything.
We keep the same first principles: who am I talking to, how do I reach them, and do I have permission."><link rel=canonical href=https://memo.mx/posts/understanding-computer-networks-by-analogy-part-2/><meta name=google-site-verification content="G-ZRB1GGCC9B"><link crossorigin=anonymous href=/assets/css/stylesheet.d1467e28595903f993a7e37893057cefe5f69aece461c850796bf5b0a3bf422a.css integrity="sha256-0UZ+KFlZA/mTp+N4kwV87+X2muzkYchQeWv1sKO/Qio=" rel="preload stylesheet" as=style><link rel=icon href=https://memo.mx/%20favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://memo.mx/%20favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://memo.mx/%20favicon-32x32.png><link rel=apple-touch-icon href=https://memo.mx/%20apple-touch-icon.png><link rel=mask-icon href=https://memo.mx/%20safari-pinned-tab.svg><meta name=theme-color content="#0d0221"><meta name=msapplication-TileColor content="#0d0221"><link rel=alternate hreflang=en href=https://memo.mx/posts/understanding-computer-networks-by-analogy-part-2/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZRB1GGCC9B"></script><script>var dnt,doNotTrack=!1;if(!0&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZRB1GGCC9B")}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://memo.mx/posts/"},{"@type":"ListItem","position":2,"name":"Understanding Computer Networks by Analogy: Part 2 - The Hotel City (Cloud)","item":"https://memo.mx/posts/understanding-computer-networks-by-analogy-part-2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Understanding Computer Networks by Analogy: Part 2 - The Hotel City (Cloud)","name":"Understanding Computer Networks by Analogy: Part 2 - The Hotel City (Cloud)","description":"Part II: The Hotel City (Cloud) Moving to the cloud feels like moving into a serviced hotel. You do not build the walls or run the elevators. You rent space, bring your rules, and let the hotel handle power, plumbing, and staff. In this part, we take our building and city mental model and extend it to hotels, private floors, and the pathways that connect everything.\nWe keep the same first principles: who am I talking to, how do I reach them, and do I have permission.","keywords":[],"articleBody":"Part II: The Hotel City (Cloud) Moving to the cloud feels like moving into a serviced hotel. You do not build the walls or run the elevators. You rent space, bring your rules, and let the hotel handle power, plumbing, and staff. In this part, we take our building and city mental model and extend it to hotels, private floors, and the pathways that connect everything.\nWe keep the same first principles: who am I talking to, how do I reach them, and do I have permission. Address, path, permission. Room, hallway, guard.\nChapter 18: Cloud Computing: Hotels and Serviced Offices Think of a cloud provider as a chain of well run hotels across the city. Instead of owning a building and fixing leaky pipes at 2 a.m., you rent space and focus on your work. The hotel keeps the lights on, the elevators smooth, and the housekeeping staff ready.\nYou can rent a single room to try an idea. You can expand to a cluster of rooms for a busy week. You can even reserve an entire floor if you need stability and privacy. The pricing is simple at first glance. You pay for the rooms and services you use. The footnotes matter, though. Extra room service and cross hallway deliveries show up on the bill. Ask me how I know.\nThe big win is elasticity. When a conference comes to town, the hotel can give you extra rooms for a short time. When it is quiet, you release space and your costs drop. You do not need to buy a building for a one week event.\nYou do not control the wiring behind the walls. That is the trade you make for speed and convenience. The hotel gives you strong controls at the doors and in the hallways, but they keep some keys to keep the whole place running safely.\nCallback to our letter story. The cloud is not a new city. It is part of the same city, but with hotels that let you move faster. You still write an envelope, pick a path, and follow the directory. You just do it inside someone else’s building.\nCloud is a hotel. Rent what you need, scale up and down, and let the staff run the building while you focus on your work.\nChapter 19: Your Private Floor in the Cloud (VPCs and Endpoints) In a good hotel you can reserve a private floor. The hallways are yours, the doors are yours, and you decide who can visit. That is a Virtual Private Cloud, or VPC.\nInside your private floor, you lay out subnets like wings of the floor. One wing for public facing rooms, one for private back office rooms, and one for shared services. The elevator bank connects your wings to other floors and to the street. You choose which elevators stop on your floor. You choose which rooms have a peephole to the street and which stay entirely private.\nSometimes you need a service that lives in the hotel itself, like the hotel kitchen or laundry. You do not want to send a runner out onto the street for every request. VPC endpoints are service doors inside your private floor. You reach hotel services over your own hallways. No street traffic needed.\nThere are two useful styles of service doors. Interface endpoints feel like a door to a specific room on your floor. Gateway style endpoints feel like a special chute in the hallway. Both keep your traffic inside the hotel.\nThe picture bends here. A VPC is not a single physical floor. It is a private set of hallways that the hotel carves out for you across one or more floors. The privacy is real, even if the walls are virtual.\nA VPC is your private floor. Use endpoints as service doors to keep errands off the street.\nChapter 20: Serverless: Room Service on Demand Some days you do not want to run a kitchen. You just want food to arrive when you ring. That is serverless. You place an order, the hotel prepares it, and you only pay for what you eat.\nServerless functions are short lived helpers. You hand them a task and they do it quickly, then disappear. No need to keep a staff member idle for the next call. The hotel schedules the staff for you.\nNetworking still matters. Your order needs to reach the right kitchen. If your function should stay on private hallways, you give it a door on your VPC. If it only needs to go out, you give it a path through your outbound staff exit. If it needs to reach a hotel service privately, you use an endpoint. The pattern is the same. Address, path, permission.\nThere are a few practical quirks. Sometimes the kitchen is cold and needs a minute to heat up before the first meal. That is a cold start. Sometimes the hotel limits how long a serverless helper can run. You split bigger meals into smaller courses. If you try to carry heavy boxes through the lobby, you might hit size limits. Plan around the furniture.\nCallback to Chapters 12 and 13. You still pick the right slot and the right language. Serverless does not remove protocols. It just removes your need to run the oven.\nServerless is room service. You still choose the path and rules, but the hotel runs the kitchen and staff.\nChapter 21: Security Groups vs NACLs (Hotel Guards vs Hallway Rules) Security in the hotel has two layers that work together. Security Groups are door guards. Network ACLs are hallway rules.\nDoor guards stand at each room. They check the conversation in context. If your room started a chat with a neighbor, replies are allowed back in. If a stranger knocks out of the blue, the guard checks a short list of allowed slots and sources. Everything else is a polite no. That is a stateful rule set.\nHallway rules live on the wing itself. They are posted like traffic signs. They do not remember previous conversations. They simply say what is allowed to pass in either direction. That is a stateless list. Use it to block obviously bad routes or to set broad wing wide policy.\nThe pattern that scales. Use door guards to express what each room needs. Use hallway rules sparingly to set guardrails. When you hit a problem, follow the envelope from room, to guard, to hallway rule, to the next hop. The culprit will show itself.\nThink room first, then hallway. Security Groups are per door and stateful. NACLs are per wing and stateless.\nChapter 22: Internet vs NAT Gateways; Public and Private Subnets On your private floor, some rooms face the street and others are tucked inside. Public subnets are the street facing wing. Private subnets are interior rooms with no direct street window.\nTo welcome guests from the street, you need an Internet Gateway. It is the hotel’s main entrance for your floor. Routes that point at this entrance make your street facing rooms reachable, subject to your guards at the doors.\nFor rooms that only need to make outbound trips, you use a NAT Gateway. Think of it as a staffed exit that lets your staff go out, pick up supplies, and come back, without giving the street a clear line of sight into the room. The front desk clerk rewrites the return address to the main building address and keeps a ledger to route replies back to the right room.\nOne cost hint for your future self. Trips through the NAT exit often carry a per trip fee and can add a distance charge. Keep heavy errands inside the hotel using endpoints when you can.\nNAT translates addresses and ports. It is not a firewall. Keep explicit allow and deny rules at your guards.\nLoad Balancers vs Gateways Gateways are building entrances and exits. They connect your floor to the public street or to other parts of the hotel. Load balancers are traffic coordinators for a cluster of identical rooms. They stand at a small desk in front of several doors that all provide the same service and decide which door should take the next visitor.\nTwo common styles help:\nL4 (transport) load balancers: Look only at addressing and port info, like “deliver to any web worker on slot 443.” Fast, simple, and great for TCP/UDP traffic. L7 (application) load balancers: Peek at the contents, like HTTP paths or headers. They can route “/images” to one set of rooms and “/api” to another, rewrite addresses, and terminate TLS. Why it matters: gateways make you reachable or provide egress; load balancers distribute work across many identical rooms. You often use both together, a public entrance (Internet Gateway) plus a load balancer in front of your web rooms, with guards at every boundary.\nInternet Gateway is your street entrance for public rooms. NAT Gateway is your outbound only exit for private rooms.\nChapter 23: VPC Peering and Private Service Endpoints Sometimes you need to visit another company’s floor in another hotel. Other times you only need a safe hatch to their kitchen. Different needs, different paths.\nVPC Peering is a private hallway between two private floors. Rooms on either side can speak as if they share a building map. It is simple and fast, but it is point to point. One hallway per pair. The city becomes a web of private hallways if you connect many floors.\nPrivate service endpoints are like service hatches. You do not open a general hallway. You create a private slot to a specific service on the other side. Your traffic stays off the street and only reaches the service you name. Great for using a partner’s kitchen without giving access to their whole floor.\nThe picture bends here. Some providers implement these hatches with additional relays behind the scenes. The privacy is still strong, but the path is mediated by the hotel. Remember first principles. Address, path, permission.\nPeering is a private hallway between floors. Private endpoints are a narrow hatch directly to a named service.\nChapter 24: Hybrid Connectivity (VPN and Dedicated Private Links) You still have your original office building back home. You want a steady path between it and your new hotel floor. Two common choices help.\nSite to site VPN is a secure tunnel over the public streets. Imagine a marked shuttle that carries sealed envelopes between your building and the hotel at regular intervals. It is quick to set up and works well, but it shares the road with everyone else.\nDedicated private links are like leasing a private elevator between your building and the hotel. Predictable, quiet, and reserved. They take longer to arrange and cost more, but they give you consistency when every minute counts.\nOften you start with a shuttle and move to a private elevator when traffic and reliability demands grow. Both rely on the same idea. Build a clear path, set clear rules, and keep good maps at both ends.\nVPN is a secure shuttle on public streets. Dedicated links are private elevators. Choose based on speed, cost, and consistency.\nChapter 25: Cloud DNS and Service Discovery Inside the hotel, names also matter. You might have private names that never appear in the city directory. The hotel runs a front desk directory for your private floor.\nCloud DNS lets you create zones for internal names. Your rooms ask the local clerk, and the clerk answers from a private list. You can split answers based on who is asking. Staff get one set of directions. Guests get another. That is split horizon.\nService discovery adds a moving piece. Some services scale up and down during the day. Rather than pinning a single room number, you publish a name that maps to whichever rooms are currently on shift. Your apps ask the directory for the name and get a fresh list of doors to try.\nCallback to Chapter 14. Same idea as DNS, but scoped to the hotel and tuned for change. Caching still applies, TTL still matters, and authoritative sources still speak with authority.\nUse cloud DNS for private names and service discovery to track rooms that scale up and down.\nChapter 26: IAM and Roles: Badges and Permissions Identity is the first key. In a real hotel, badges decide which floors you can reach and which rooms you can open. In the cloud, IAM plays that role.\nEvery person and every service carries an identity. Policies describe what that identity can do. You grant a role to a service so it can fetch secrets or write to storage without sharing a master key. You grant a temporary badge to a contractor that expires when the job ends.\nLeast privilege is the habit to build early. Give each person and service only what they need. Audit your badges and lock away master keys. Your future self will sleep better, and so will your auditor.\nCallback to Chapter 15. Guards check lists, not vibes, and IAM is the source of those lists. If a request reaches a door, the guard checks both the network rules and the identity of the visitor before opening.\nTreat identity as your first key. Use roles for services, least privilege for everyone, and rotate keys.\nChapter 27: VPC Flow Logs and Monitoring Even in a calm hotel, you want cameras in the hallways and a visitor log at the desk. Not to snoop, but to debug, explain, and improve.\nVPC flow logs record who tried to talk to whom, on which slot, and whether the guard allowed it. They do not capture the contents of the conversation, just the addressing and result. That is usually enough to answer, why can this room not reach that service, or, who is knocking on this door every minute.\nMetrics add the heartbeat. Requests per minute, error rates, and average waiting times tell you when a hallway is getting crowded or when a service is tired. Traces show the path an envelope took through multiple rooms so you can find the slow staircase.\nThe habit to build. When something breaks, follow the envelope and check the logs at each boundary. Room, door guard, hallway rule, concierge, and the next building. The answer is rarely magic. It is a missing rule, a wrong map, or a busy elevator.\nTurn on flow logs and watch your metrics. When in doubt, follow the envelope and check each boundary.\n","wordCount":"2410","inLanguage":"en","datePublished":"2025-10-18T22:39:16+09:00","dateModified":"2025-10-19T11:35:29+09:00","author":{"@type":"Person","name":"Memo Garcia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://memo.mx/posts/understanding-computer-networks-by-analogy-part-2/"},"publisher":{"@type":"Person","name":"Memo Garcia","logo":{"@type":"ImageObject","url":"https://memo.mx/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://memo.mx/ accesskey=h title="Memo Garcia (Alt + H)">Memo Garcia</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://memo.mx/books/ title=Books><span>Books</span></a></li><li><a href=https://memo.mx/labs/ title=Labs><span>Labs</span></a></li><li><a href=https://memo.mx/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Understanding Computer Networks by Analogy: Part 2 - The Hotel City (Cloud)</h1><div class=post-meta><span title='2025-10-18 22:39:16 +0900 +0900'>October 18, 2025</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;Memo Garcia</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#part-ii-the-hotel-city-cloud aria-label="Part II: The Hotel City (Cloud)">Part II: The Hotel City (Cloud)</a><ul><li><a href=#chapter-18-cloud-computing-hotels-and-serviced-offices aria-label="Chapter 18: Cloud Computing: Hotels and Serviced Offices">Chapter 18: Cloud Computing: Hotels and Serviced Offices</a></li><li><a href=#chapter-19-your-private-floor-in-the-cloud-vpcs-and-endpoints aria-label="Chapter 19: Your Private Floor in the Cloud (VPCs and Endpoints)">Chapter 19: Your Private Floor in the Cloud (VPCs and Endpoints)</a></li><li><a href=#chapter-20-serverless-room-service-on-demand aria-label="Chapter 20: Serverless: Room Service on Demand">Chapter 20: Serverless: Room Service on Demand</a></li><li><a href=#chapter-21-security-groups-vs-nacls-hotel-guards-vs-hallway-rules aria-label="Chapter 21: Security Groups vs NACLs (Hotel Guards vs Hallway Rules)">Chapter 21: Security Groups vs NACLs (Hotel Guards vs Hallway Rules)</a></li><li><a href=#chapter-22-internet-vs-nat-gateways-public-and-private-subnets aria-label="Chapter 22: Internet vs NAT Gateways; Public and Private Subnets">Chapter 22: Internet vs NAT Gateways; Public and Private Subnets</a><ul><li><a href=#load-balancers-vs-gateways aria-label="Load Balancers vs Gateways">Load Balancers vs Gateways</a></li></ul></li><li><a href=#chapter-23-vpc-peering-and-private-service-endpoints aria-label="Chapter 23: VPC Peering and Private Service Endpoints">Chapter 23: VPC Peering and Private Service Endpoints</a></li><li><a href=#chapter-24-hybrid-connectivity-vpn-and-dedicated-private-links aria-label="Chapter 24: Hybrid Connectivity (VPN and Dedicated Private Links)">Chapter 24: Hybrid Connectivity (VPN and Dedicated Private Links)</a></li><li><a href=#chapter-25-cloud-dns-and-service-discovery aria-label="Chapter 25: Cloud DNS and Service Discovery">Chapter 25: Cloud DNS and Service Discovery</a></li><li><a href=#chapter-26-iam-and-roles-badges-and-permissions aria-label="Chapter 26: IAM and Roles: Badges and Permissions">Chapter 26: IAM and Roles: Badges and Permissions</a></li><li><a href=#chapter-27-vpc-flow-logs-and-monitoring aria-label="Chapter 27: VPC Flow Logs and Monitoring">Chapter 27: VPC Flow Logs and Monitoring</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=part-ii-the-hotel-city-cloud>Part II: The Hotel City (Cloud)<a hidden class=anchor aria-hidden=true href=#part-ii-the-hotel-city-cloud>#</a></h1><p>Moving to the cloud feels like moving into a serviced hotel. You do not build the walls or run the elevators. You rent space, bring your rules, and let the hotel handle power, plumbing, and staff. In this part, we take our building and city mental model and extend it to hotels, private floors, and the pathways that connect everything.</p><p>We keep the same first principles: who am I talking to, how do I reach them, and do I have permission. Address, path, permission. Room, hallway, guard.</p><h2 id=chapter-18-cloud-computing-hotels-and-serviced-offices>Chapter 18: Cloud Computing: Hotels and Serviced Offices<a hidden class=anchor aria-hidden=true href=#chapter-18-cloud-computing-hotels-and-serviced-offices>#</a></h2><p>Think of a cloud provider as a chain of well run hotels across the city. Instead of owning a building and fixing leaky pipes at 2 a.m., you rent space and focus on your work. The hotel keeps the lights on, the elevators smooth, and the housekeeping staff ready.</p><p>You can rent a single room to try an idea. You can expand to a cluster of rooms for a busy week. You can even reserve an entire floor if you need stability and privacy. The pricing is simple at first glance. You pay for the rooms and services you use. The footnotes matter, though. Extra room service and cross hallway deliveries show up on the bill. Ask me how I know.</p><p>The big win is elasticity. When a conference comes to town, the hotel can give you extra rooms for a short time. When it is quiet, you release space and your costs drop. You do not need to buy a building for a one week event.</p><blockquote><p>You do not control the wiring behind the walls. That is the trade you make for speed and convenience. The hotel gives you strong controls at the doors and in the hallways, but they keep some keys to keep the whole place running safely.</p></blockquote><p>Callback to our letter story. The cloud is not a new city. It is part of the same city, but with hotels that let you move faster. You still write an envelope, pick a path, and follow the directory. You just do it inside someone else’s building.</p><blockquote><p>Cloud is a hotel. Rent what you need, scale up and down, and let the staff run the building while you focus on your work.</p></blockquote><h2 id=chapter-19-your-private-floor-in-the-cloud-vpcs-and-endpoints>Chapter 19: Your Private Floor in the Cloud (VPCs and Endpoints)<a hidden class=anchor aria-hidden=true href=#chapter-19-your-private-floor-in-the-cloud-vpcs-and-endpoints>#</a></h2><p>In a good hotel you can reserve a private floor. The hallways are yours, the doors are yours, and you decide who can visit. That is a Virtual Private Cloud, or VPC.</p><p>Inside your private floor, you lay out subnets like wings of the floor. One wing for public facing rooms, one for private back office rooms, and one for shared services. The elevator bank connects your wings to other floors and to the street. You choose which elevators stop on your floor. You choose which rooms have a peephole to the street and which stay entirely private.</p><p>Sometimes you need a service that lives in the hotel itself, like the hotel kitchen or laundry. You do not want to send a runner out onto the street for every request. VPC endpoints are service doors inside your private floor. You reach hotel services over your own hallways. No street traffic needed.</p><p>There are two useful styles of service doors. Interface endpoints feel like a door to a specific room on your floor. Gateway style endpoints feel like a special chute in the hallway. Both keep your traffic inside the hotel.</p><blockquote><p>The picture bends here. A VPC is not a single physical floor. It is a private set of hallways that the hotel carves out for you across one or more floors. The privacy is real, even if the walls are virtual.</p></blockquote><blockquote><p>A VPC is your private floor. Use endpoints as service doors to keep errands off the street.</p></blockquote><h2 id=chapter-20-serverless-room-service-on-demand>Chapter 20: Serverless: Room Service on Demand<a hidden class=anchor aria-hidden=true href=#chapter-20-serverless-room-service-on-demand>#</a></h2><p>Some days you do not want to run a kitchen. You just want food to arrive when you ring. That is serverless. You place an order, the hotel prepares it, and you only pay for what you eat.</p><p>Serverless functions are short lived helpers. You hand them a task and they do it quickly, then disappear. No need to keep a staff member idle for the next call. The hotel schedules the staff for you.</p><p>Networking still matters. Your order needs to reach the right kitchen. If your function should stay on private hallways, you give it a door on your VPC. If it only needs to go out, you give it a path through your outbound staff exit. If it needs to reach a hotel service privately, you use an endpoint. The pattern is the same. Address, path, permission.</p><p>There are a few practical quirks. Sometimes the kitchen is cold and needs a minute to heat up before the first meal. That is a cold start. Sometimes the hotel limits how long a serverless helper can run. You split bigger meals into smaller courses. If you try to carry heavy boxes through the lobby, you might hit size limits. Plan around the furniture.</p><p>Callback to Chapters 12 and 13. You still pick the right slot and the right language. Serverless does not remove protocols. It just removes your need to run the oven.</p><blockquote><p>Serverless is room service. You still choose the path and rules, but the hotel runs the kitchen and staff.</p></blockquote><h2 id=chapter-21-security-groups-vs-nacls-hotel-guards-vs-hallway-rules>Chapter 21: Security Groups vs NACLs (Hotel Guards vs Hallway Rules)<a hidden class=anchor aria-hidden=true href=#chapter-21-security-groups-vs-nacls-hotel-guards-vs-hallway-rules>#</a></h2><p>Security in the hotel has two layers that work together. Security Groups are door guards. Network ACLs are hallway rules.</p><p>Door guards stand at each room. They check the conversation in context. If your room started a chat with a neighbor, replies are allowed back in. If a stranger knocks out of the blue, the guard checks a short list of allowed slots and sources. Everything else is a polite no. That is a stateful rule set.</p><p>Hallway rules live on the wing itself. They are posted like traffic signs. They do not remember previous conversations. They simply say what is allowed to pass in either direction. That is a stateless list. Use it to block obviously bad routes or to set broad wing wide policy.</p><p>The pattern that scales. Use door guards to express what each room needs. Use hallway rules sparingly to set guardrails. When you hit a problem, follow the envelope from room, to guard, to hallway rule, to the next hop. The culprit will show itself.</p><blockquote><p>Think room first, then hallway. Security Groups are per door and stateful. NACLs are per wing and stateless.</p></blockquote><h2 id=chapter-22-internet-vs-nat-gateways-public-and-private-subnets>Chapter 22: Internet vs NAT Gateways; Public and Private Subnets<a hidden class=anchor aria-hidden=true href=#chapter-22-internet-vs-nat-gateways-public-and-private-subnets>#</a></h2><p>On your private floor, some rooms face the street and others are tucked inside. Public subnets are the street facing wing. Private subnets are interior rooms with no direct street window.</p><p>To welcome guests from the street, you need an Internet Gateway. It is the hotel’s main entrance for your floor. Routes that point at this entrance make your street facing rooms reachable, subject to your guards at the doors.</p><p>For rooms that only need to make outbound trips, you use a NAT Gateway. Think of it as a staffed exit that lets your staff go out, pick up supplies, and come back, without giving the street a clear line of sight into the room. The front desk clerk rewrites the return address to the main building address and keeps a ledger to route replies back to the right room.</p><p>One cost hint for your future self. Trips through the NAT exit often carry a per trip fee and can add a distance charge. Keep heavy errands inside the hotel using endpoints when you can.</p><blockquote><p>NAT translates addresses and ports. It is not a firewall. Keep explicit allow and deny rules at your guards.</p></blockquote><h3 id=load-balancers-vs-gateways>Load Balancers vs Gateways<a hidden class=anchor aria-hidden=true href=#load-balancers-vs-gateways>#</a></h3><p>Gateways are building entrances and exits. They connect your floor to the public street or to other parts of the hotel. <strong>Load balancers</strong> are traffic coordinators for a cluster of identical rooms. They stand at a small desk in front of several doors that all provide the same service and decide which door should take the next visitor.</p><p>Two common styles help:</p><ul><li><strong>L4 (transport) load balancers:</strong> Look only at addressing and port info, like “deliver to any web worker on slot 443.” Fast, simple, and great for TCP/UDP traffic.</li><li><strong>L7 (application) load balancers:</strong> Peek at the contents, like HTTP paths or headers. They can route
“/images” to one set of rooms and “/api” to another, rewrite addresses, and terminate TLS.</li></ul><p>Why it matters: gateways make you reachable or provide egress; load balancers distribute work across many identical rooms. You often use both together, a public entrance (Internet Gateway) plus a load balancer in front of your web rooms, with guards at every boundary.</p><blockquote><p>Internet Gateway is your street entrance for public rooms. NAT Gateway is your outbound only exit for private rooms.</p></blockquote><h2 id=chapter-23-vpc-peering-and-private-service-endpoints>Chapter 23: VPC Peering and Private Service Endpoints<a hidden class=anchor aria-hidden=true href=#chapter-23-vpc-peering-and-private-service-endpoints>#</a></h2><p>Sometimes you need to visit another company’s floor in another hotel. Other times you only need a safe hatch to their kitchen. Different needs, different paths.</p><p>VPC Peering is a private hallway between two private floors. Rooms on either side can speak as if they share a building map. It is simple and fast, but it is point to point. One hallway per pair. The city becomes a web of private hallways if you connect many floors.</p><p>Private service endpoints are like service hatches. You do not open a general hallway. You create a private slot to a specific service on the other side. Your traffic stays off the street and only reaches the service you name. Great for using a partner’s kitchen without giving access to their whole floor.</p><blockquote><p>The picture bends here. Some providers implement these hatches with additional relays behind the scenes. The privacy is still strong, but the path is mediated by the hotel. Remember first principles. Address, path, permission.</p></blockquote><blockquote><p>Peering is a private hallway between floors. Private endpoints are a narrow hatch directly to a named service.</p></blockquote><h2 id=chapter-24-hybrid-connectivity-vpn-and-dedicated-private-links>Chapter 24: Hybrid Connectivity (VPN and Dedicated Private Links)<a hidden class=anchor aria-hidden=true href=#chapter-24-hybrid-connectivity-vpn-and-dedicated-private-links>#</a></h2><p>You still have your original office building back home. You want a steady path between it and your new hotel floor. Two common choices help.</p><p>Site to site VPN is a secure tunnel over the public streets. Imagine a marked shuttle that carries sealed envelopes between your building and the hotel at regular intervals. It is quick to set up and works well, but it shares the road with everyone else.</p><p>Dedicated private links are like leasing a private elevator between your building and the hotel. Predictable, quiet, and reserved. They take longer to arrange and cost more, but they give you consistency when every minute counts.</p><p>Often you start with a shuttle and move to a private elevator when traffic and reliability demands grow. Both rely on the same idea. Build a clear path, set clear rules, and keep good maps at both ends.</p><blockquote><p>VPN is a secure shuttle on public streets. Dedicated links are private elevators. Choose based on speed, cost, and consistency.</p></blockquote><h2 id=chapter-25-cloud-dns-and-service-discovery>Chapter 25: Cloud DNS and Service Discovery<a hidden class=anchor aria-hidden=true href=#chapter-25-cloud-dns-and-service-discovery>#</a></h2><p>Inside the hotel, names also matter. You might have private names that never appear in the city directory. The hotel runs a front desk directory for your private floor.</p><p>Cloud DNS lets you create zones for internal names. Your rooms ask the local clerk, and the clerk answers from a private list. You can split answers based on who is asking. Staff get one set of directions. Guests get another. That is split horizon.</p><p>Service discovery adds a moving piece. Some services scale up and down during the day. Rather than pinning a single room number, you publish a name that maps to whichever rooms are currently on shift. Your apps ask the directory for the name and get a fresh list of doors to try.</p><p>Callback to Chapter 14. Same idea as DNS, but scoped to the hotel and tuned for change. Caching still applies, TTL still matters, and authoritative sources still speak with authority.</p><blockquote><p>Use cloud DNS for private names and service discovery to track rooms that scale up and down.</p></blockquote><h2 id=chapter-26-iam-and-roles-badges-and-permissions>Chapter 26: IAM and Roles: Badges and Permissions<a hidden class=anchor aria-hidden=true href=#chapter-26-iam-and-roles-badges-and-permissions>#</a></h2><p>Identity is the first key. In a real hotel, badges decide which floors you can reach and which rooms you can open. In the cloud, IAM plays that role.</p><p>Every person and every service carries an identity. Policies describe what that identity can do. You grant a role to a service so it can fetch secrets or write to storage without sharing a master key. You grant a temporary badge to a contractor that expires when the job ends.</p><p>Least privilege is the habit to build early. Give each person and service only what they need. Audit your badges and lock away master keys. Your future self will sleep better, and so will your auditor.</p><p>Callback to Chapter 15. Guards check lists, not vibes, and IAM is the source of those lists. If a request reaches a door, the guard checks both the network rules and the identity of the visitor before opening.</p><blockquote><p>Treat identity as your first key. Use roles for services, least privilege for everyone, and rotate keys.</p></blockquote><h2 id=chapter-27-vpc-flow-logs-and-monitoring>Chapter 27: VPC Flow Logs and Monitoring<a hidden class=anchor aria-hidden=true href=#chapter-27-vpc-flow-logs-and-monitoring>#</a></h2><p>Even in a calm hotel, you want cameras in the hallways and a visitor log at the desk. Not to snoop, but to debug, explain, and improve.</p><p>VPC flow logs record who tried to talk to whom, on which slot, and whether the guard allowed it. They do not capture the contents of the conversation, just the addressing and result. That is usually enough to answer, why can this room not reach that service, or, who is knocking on this door every minute.</p><p>Metrics add the heartbeat. Requests per minute, error rates, and average waiting times tell you when a hallway is getting crowded or when a service is tired. Traces show the path an envelope took through multiple rooms so you can find the slow staircase.</p><p>The habit to build. When something breaks, follow the envelope and check the logs at each boundary. Room, door guard, hallway rule, concierge, and the next building. The answer is rarely magic. It is a missing rule, a wrong map, or a busy elevator.</p><blockquote><p>Turn on flow logs and watch your metrics. When in doubt, follow the envelope and check each boundary.</p></blockquote></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://memo.mx/posts/understanding-computer-networks-by-analogy-appendices/><span class=title>« Prev</span><br><span>Understanding Computer Networks by Analogy: Appendices</span>
</a><a class=next href=https://memo.mx/posts/understanding-computer-networks-by-analogy-part-3/><span class=title>Next »</span><br><span>Understanding Computer Networks by Analogy: Part 3 - Streets, Names, and Guards</span></a></nav></footer></article></main><footer class=footer></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Multi Region Cloud Training Lab: Part 4 - AWS Identity (IRSA vs Pod Identity) | Memo Garcia</title>
<meta name=keywords content><meta name=description content="Problem: Let workloads call AWS without node credentials.
Assumptions/Constraints
Cost note: Two clusters, not two AWS regions. Choose one path: IRSA or EKS Pod Identity. Do not mix for the same service account. ASCII Diagram
IRSA path Pod Identity path +-----------------------------+ +-----------------------------+ | [Pod + SA aws-sa] | | [Pod + SA aws-sa] | | token (OIDC projected) | | request to EKS agent | +--------------|--------------+ +--------------|--------------+ v v [IAM OIDC Provider] [EKS Pod Identity Agent] | | v v [STS AssumeRoleWithWebIdentity] [STS AssumeRole] | | v v [Temp creds] [Temp creds] \________________________________________/ | v [AWS APIs] Notes: IRSA supports Fargate and non EKS clusters with OIDC; Pod Identity is EKS only."><link rel=canonical href=https://memo.mx/posts/multi-region-series-part-4-identity/><meta name=google-site-verification content="G-ZRB1GGCC9B"><link crossorigin=anonymous href=/assets/css/stylesheet.d1467e28595903f993a7e37893057cefe5f69aece461c850796bf5b0a3bf422a.css integrity="sha256-0UZ+KFlZA/mTp+N4kwV87+X2muzkYchQeWv1sKO/Qio=" rel="preload stylesheet" as=style><link rel=icon href=https://memo.mx/%20favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://memo.mx/%20favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://memo.mx/%20favicon-32x32.png><link rel=apple-touch-icon href=https://memo.mx/%20apple-touch-icon.png><link rel=mask-icon href=https://memo.mx/%20safari-pinned-tab.svg><meta name=theme-color content="#0d0221"><meta name=msapplication-TileColor content="#0d0221"><link rel=alternate hreflang=en href=https://memo.mx/posts/multi-region-series-part-4-identity/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZRB1GGCC9B"></script><script>var dnt,doNotTrack=!1;if(!0&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZRB1GGCC9B")}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://memo.mx/posts/"},{"@type":"ListItem","position":2,"name":"Multi Region Cloud Training Lab: Part 4 - AWS Identity (IRSA vs Pod Identity)","item":"https://memo.mx/posts/multi-region-series-part-4-identity/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Multi Region Cloud Training Lab: Part 4 - AWS Identity (IRSA vs Pod Identity)","name":"Multi Region Cloud Training Lab: Part 4 - AWS Identity (IRSA vs Pod Identity)","description":"Problem: Let workloads call AWS without node credentials.\nAssumptions/Constraints\nCost note: Two clusters, not two AWS regions. Choose one path: IRSA or EKS Pod Identity. Do not mix for the same service account. ASCII Diagram\nIRSA path Pod Identity path +-----------------------------+ +-----------------------------+ | [Pod + SA aws-sa] | | [Pod + SA aws-sa] | | token (OIDC projected) | | request to EKS agent | +--------------|--------------+ +--------------|--------------+ v v [IAM OIDC Provider] [EKS Pod Identity Agent] | | v v [STS AssumeRoleWithWebIdentity] [STS AssumeRole] | | v v [Temp creds] [Temp creds] \\________________________________________/ | v [AWS APIs] Notes: IRSA supports Fargate and non EKS clusters with OIDC; Pod Identity is EKS only.","keywords":[],"articleBody":"Problem: Let workloads call AWS without node credentials.\nAssumptions/Constraints\nCost note: Two clusters, not two AWS regions. Choose one path: IRSA or EKS Pod Identity. Do not mix for the same service account. ASCII Diagram\nIRSA path Pod Identity path +-----------------------------+ +-----------------------------+ | [Pod + SA aws-sa] | | [Pod + SA aws-sa] | | token (OIDC projected) | | request to EKS agent | +--------------|--------------+ +--------------|--------------+ v v [IAM OIDC Provider] [EKS Pod Identity Agent] | | v v [STS AssumeRoleWithWebIdentity] [STS AssumeRole] | | v v [Temp creds] [Temp creds] \\________________________________________/ | v [AWS APIs] Notes: IRSA supports Fargate and non EKS clusters with OIDC; Pod Identity is EKS only. Steps (IRSA)\nCreate an IAM role that trusts the cluster OIDC provider and service account. Annotate the workload service account with the role ARN. Example trust policy snippet\n{ \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": { \"Federated\": \"arn:aws:iam:::oidc-provider/\" }, \"Action\": \"sts:AssumeRoleWithWebIdentity\", \"Condition\": { \"StringEquals\": { \":sub\": \"system:serviceaccount:echo:aws-sa\" } } } ] } Kubernetes service account\napiVersion: v1 kind: ServiceAccount metadata: name: aws-sa namespace: echo annotations: eks.amazonaws.com/role-arn: arn:aws:iam:::role/echo-irsa-role Steps (EKS Pod Identity)\nCreate an IAM role. Bind it to a namespace and service account with a Pod Identity association. Example association\naws eks create-pod-identity-association \\ --cluster-name prod-us \\ --namespace echo \\ --service-account aws-sa \\ --role-arn arn:aws:iam:::role/echo-podid-role Verification/DoD\nA pod using aws-sa can call sts:GetCallerIdentity and returns the role. Note: IRSA vs EKS Pod Identity\nPlatform scope: IRSA works for EKS and other Kubernetes clusters that use an IAM OIDC provider, including self managed clusters on EC2 and EKS Anywhere. EKS Pod Identity is EKS only and does not support EKS Anywhere or self managed clusters. Node and runtime support: Pod Identity currently supports Linux EC2 worker nodes and does not support Fargate or Windows pods. IRSA supports both EC2 and Fargate. Setup model: IRSA requires an IAM OIDC provider per cluster and trust policy conditions that match a Kubernetes service account. Pods use a projected web identity token. Pod Identity uses an EKS managed agent (DaemonSet) and a Pod Identity association API; the agent vends credentials to pods. Cross account and reuse: Both can access resources in other accounts. Pod Identity added simplified cross account support in 2025. IRSA uses standard cross account trust policies. Pod Identity helps reuse the same role across multiple clusters without editing OIDC trust per cluster. References\nEKS Pod Identity docs (limits and setup): https://docs.aws.amazon.com/eks/latest/userguide/pod-identities.html EKS Pod Identity cross account update (2025 06 12): https://aws.amazon.com/about-aws/whats-new/2025/06/amazon-eks-pod-identity-cross-account-access IRSA overview: https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html IRSA SDK/credential chain notes: https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts-minimum-sdk.html Fargate execution role and IRSA note: https://docs.aws.amazon.com/eks/latest/userguide/pod-execution-role.html Previous: Part 3 · Next: Part 5\n","wordCount":"435","inLanguage":"en","datePublished":"2025-10-17T09:13:00-07:00","dateModified":"2025-12-01T22:41:54+09:00","author":{"@type":"Person","name":"Memo Garcia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://memo.mx/posts/multi-region-series-part-4-identity/"},"publisher":{"@type":"Person","name":"Memo Garcia","logo":{"@type":"ImageObject","url":"https://memo.mx/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://memo.mx/ accesskey=h title="Memo Garcia (Alt + H)">Memo Garcia</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://memo.mx/labs/ title=Labs><span>Labs</span></a></li><li><a href=https://memo.mx/books/ title=Books><span>Books</span></a></li><li><a href=https://memo.mx/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Multi Region Cloud Training Lab: Part 4 - AWS Identity (IRSA vs Pod Identity)</h1><div class=post-meta><span title='2025-10-17 09:13:00 -0700 -0700'>October 17, 2025</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Memo Garcia</div></header><div class=post-content><p>Problem: Let workloads call AWS without node credentials.</p><p>Assumptions/Constraints</p><ul><li>Cost note: Two clusters, not two AWS regions.</li><li>Choose one path: IRSA or EKS Pod Identity. Do not mix for the same service account.</li></ul><p>ASCII Diagram</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>              IRSA path                           Pod Identity path
</span></span><span class=line><span class=cl>  +-----------------------------+          +-----------------------------+
</span></span><span class=line><span class=cl>  | [Pod + SA aws-sa]           |          | [Pod + SA aws-sa]           |
</span></span><span class=line><span class=cl>  |   token (OIDC projected)    |          |   request to EKS agent      |
</span></span><span class=line><span class=cl>  +--------------|--------------+          +--------------|--------------+
</span></span><span class=line><span class=cl>                 v                                        v
</span></span><span class=line><span class=cl>         [IAM OIDC Provider]                      [EKS Pod Identity Agent]
</span></span><span class=line><span class=cl>                 |                                        |
</span></span><span class=line><span class=cl>                 v                                        v
</span></span><span class=line><span class=cl>         [STS AssumeRoleWithWebIdentity]          [STS AssumeRole]
</span></span><span class=line><span class=cl>                 |                                        |
</span></span><span class=line><span class=cl>                 v                                        v
</span></span><span class=line><span class=cl>             [Temp creds]                           [Temp creds]
</span></span><span class=line><span class=cl>                 \________________________________________/
</span></span><span class=line><span class=cl>                                  |
</span></span><span class=line><span class=cl>                                  v
</span></span><span class=line><span class=cl>                               [AWS APIs]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Notes: IRSA supports Fargate and non EKS clusters with OIDC; Pod Identity is EKS only.
</span></span></code></pre></div><p>Steps (IRSA)</p><ol><li>Create an IAM role that trusts the cluster OIDC provider and service account.</li><li>Annotate the workload service account with the role ARN.</li></ol><p>Example trust policy snippet</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Version&#34;</span><span class=p>:</span> <span class=s2>&#34;2012-10-17&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Statement&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Effect&#34;</span><span class=p>:</span> <span class=s2>&#34;Allow&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Principal&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;Federated&#34;</span><span class=p>:</span> <span class=s2>&#34;arn:aws:iam::&lt;acct&gt;:oidc-provider/&lt;cluster-oidc&gt;&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Action&#34;</span><span class=p>:</span> <span class=s2>&#34;sts:AssumeRoleWithWebIdentity&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Condition&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;StringEquals&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;&lt;cluster-oidc&gt;:sub&#34;</span><span class=p>:</span> <span class=s2>&#34;system:serviceaccount:echo:aws-sa&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Kubernetes service account</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ServiceAccount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>aws-sa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>echo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>eks.amazonaws.com/role-arn</span><span class=p>:</span><span class=w> </span><span class=l>arn:aws:iam::&lt;acct&gt;:role/echo-irsa-role</span><span class=w>
</span></span></span></code></pre></div><p>Steps (EKS Pod Identity)</p><ol><li>Create an IAM role.</li><li>Bind it to a namespace and service account with a Pod Identity association.</li></ol><p>Example association</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws eks create-pod-identity-association <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --cluster-name prod-us <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace <span class=nb>echo</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --service-account aws-sa <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --role-arn arn:aws:iam::&lt;acct&gt;:role/echo-podid-role
</span></span></code></pre></div><p>Verification/DoD</p><ul><li>A pod using <code>aws-sa</code> can call <code>sts:GetCallerIdentity</code> and returns the role.</li></ul><p>Note: IRSA vs EKS Pod Identity</p><ul><li>Platform scope: IRSA works for EKS and other Kubernetes clusters that use an IAM OIDC provider, including self managed clusters on EC2 and EKS Anywhere. EKS Pod Identity is EKS only and does not support EKS Anywhere or self managed clusters.</li><li>Node and runtime support: Pod Identity currently supports Linux EC2 worker nodes and does not support Fargate or Windows pods. IRSA supports both EC2 and Fargate.</li><li>Setup model: IRSA requires an IAM OIDC provider per cluster and trust policy conditions that match a Kubernetes service account. Pods use a projected web identity token. Pod Identity uses an EKS managed agent (DaemonSet) and a Pod Identity association API; the agent vends credentials to pods.</li><li>Cross account and reuse: Both can access resources in other accounts. Pod Identity added simplified cross account support in 2025. IRSA uses standard cross account trust policies. Pod Identity helps reuse the same role across multiple clusters without editing OIDC trust per cluster.</li></ul><p>References</p><ul><li>EKS Pod Identity docs (limits and setup): <a href=https://docs.aws.amazon.com/eks/latest/userguide/pod-identities.html>https://docs.aws.amazon.com/eks/latest/userguide/pod-identities.html</a></li><li>EKS Pod Identity cross account update (2025 06 12): <a href=https://aws.amazon.com/about-aws/whats-new/2025/06/amazon-eks-pod-identity-cross-account-access>https://aws.amazon.com/about-aws/whats-new/2025/06/amazon-eks-pod-identity-cross-account-access</a></li><li>IRSA overview: <a href=https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html>https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html</a></li><li>IRSA SDK/credential chain notes: <a href=https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts-minimum-sdk.html>https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts-minimum-sdk.html</a></li><li>Fargate execution role and IRSA note: <a href=https://docs.aws.amazon.com/eks/latest/userguide/pod-execution-role.html>https://docs.aws.amazon.com/eks/latest/userguide/pod-execution-role.html</a></li></ul><p>Previous: <a href=/posts/multi-region-series-part-3-istio/>Part 3</a> · Next: <a href=/posts/multi-region-series-part-5-app/>Part 5</a></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://memo.mx/posts/multi-region-series-part-5-app/><span class=title>« Prev</span><br><span>Multi Region Cloud Training Lab: Part 5 - Sample App and Overlays</span>
</a><a class=next href=https://memo.mx/posts/multi-region-series-part-3-istio/><span class=title>Next »</span><br><span>Multi Region Cloud Training Lab: Part 3 - Istio Multi Region Mesh</span></a></nav></footer></article></main><footer class=footer></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
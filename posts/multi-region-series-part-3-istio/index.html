<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Multi Region Cloud Training Lab: Part 3 - Istio Multi Region Mesh | Memo Garcia</title>
<meta name=keywords content><meta name=description content="Problem: Enable east to west traffic and consistent policy across clusters.
Assumptions/Constraints
Cost note: Two clusters stand in for two regions. Same meshID, same trust domain, distinct network per cluster. ASCII Diagram
Cross cluster via gateway + ServiceEntry (no istioctl) +-----------+ mTLS mesh +-----------+ | Cluster US|<=============>| Cluster EU| | istiod | | istiod | | east-west | <---15443---- | east-west | | gateway | | gateway | | echo svc | | echo svc | +-----------+ +-----------+ meshID=training-mesh, trustDomain=corp."><link rel=canonical href=https://memo.mx/posts/multi-region-series-part-3-istio/><meta name=google-site-verification content="G-ZRB1GGCC9B"><link crossorigin=anonymous href=/assets/css/stylesheet.d1467e28595903f993a7e37893057cefe5f69aece461c850796bf5b0a3bf422a.css integrity="sha256-0UZ+KFlZA/mTp+N4kwV87+X2muzkYchQeWv1sKO/Qio=" rel="preload stylesheet" as=style><link rel=icon href=https://memo.mx/%20favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://memo.mx/%20favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://memo.mx/%20favicon-32x32.png><link rel=apple-touch-icon href=https://memo.mx/%20apple-touch-icon.png><link rel=mask-icon href=https://memo.mx/%20safari-pinned-tab.svg><meta name=theme-color content="#0d0221"><meta name=msapplication-TileColor content="#0d0221"><link rel=alternate hreflang=en href=https://memo.mx/posts/multi-region-series-part-3-istio/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZRB1GGCC9B"></script><script>var dnt,doNotTrack=!1;if(!0&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZRB1GGCC9B")}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://memo.mx/posts/"},{"@type":"ListItem","position":2,"name":"Multi Region Cloud Training Lab: Part 3 - Istio Multi Region Mesh","item":"https://memo.mx/posts/multi-region-series-part-3-istio/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Multi Region Cloud Training Lab: Part 3 - Istio Multi Region Mesh","name":"Multi Region Cloud Training Lab: Part 3 - Istio Multi Region Mesh","description":"Problem: Enable east to west traffic and consistent policy across clusters.\nAssumptions/Constraints\nCost note: Two clusters stand in for two regions. Same meshID, same trust domain, distinct network per cluster. ASCII Diagram\nCross cluster via gateway + ServiceEntry (no istioctl) +-----------+ mTLS mesh +-----------+ | Cluster US|\u0026lt;=============\u0026gt;| Cluster EU| | istiod | | istiod | | east-west | \u0026lt;---15443---- | east-west | | gateway | | gateway | | echo svc | | echo svc | +-----------+ +-----------+ meshID=training-mesh, trustDomain=corp.","keywords":[],"articleBody":"Problem: Enable east to west traffic and consistent policy across clusters.\nAssumptions/Constraints\nCost note: Two clusters stand in for two regions. Same meshID, same trust domain, distinct network per cluster. ASCII Diagram\nCross cluster via gateway + ServiceEntry (no istioctl) +-----------+ mTLS mesh +-----------+ | Cluster US|\u003c=============\u003e| Cluster EU| | istiod | | istiod | | east-west | \u003c---15443---- | east-west | | gateway | | gateway | | echo svc | | echo svc | +-----------+ +-----------+ meshID=training-mesh, trustDomain=corp.local networks: us-net, eu-net; locality prefers same cluster Steps\nInstall Istio on each cluster with matching meshID and trustDomain, unique network. Expose an east west gateway in each cluster. Configure cross cluster routing using east west gateways and ServiceEntry. No istioctl. Example (Helm values excerpt)\n# values-istio.yaml global: meshID: training-mesh trustDomain: corp.local network: us-net # use eu-net in EU cluster pilot: env: PILOT_ENABLE_MULTINETWORK: \"true\" Install\n# US cluster helm upgrade --install istio-base istio/base -n istio-system --create-namespace helm upgrade --install istiod istio/istiod -n istio-system -f values-istio.yaml --set global.network=us-net --wait # EU cluster helm upgrade --install istio-base istio/base -n istio-system --create-namespace --kube-context prod-eu-west-1 helm upgrade --install istiod istio/istiod -n istio-system -f values-istio.yaml --kube-context prod-eu-west-1 --set global.network=eu-net --wait East west gateway\napiVersion: install.istio.io/v1alpha1 kind: IstioOperator metadata: name: eastwest-gw namespace: istio-system spec: profile: empty components: ingressGateways: - name: istio-eastwestgateway enabled: true label: { istio: eastwestgateway } k8s: service: { type: LoadBalancer } Cross cluster ServiceEntry (call EU from US through EU gateway)\napiVersion: networking.istio.io/v1beta1 kind: ServiceEntry metadata: name: echo-eu-through-gateway namespace: echo spec: hosts: - echo.eu.mesh.local addresses: - 240.0.0.2/32 ports: - number: 80 name: http protocol: HTTP resolution: DNS location: MESH_EXTERNAL endpoints: - address: ports: { http: 15443 } locality: eu Verification/DoD\nFrom US cluster, curl http://echo.eu.mesh.local returns region=eu through gateway. Local traffic continues to prefer local cluster by default. Observability install (Helm)\n# US cluster helm repo add prometheus-community https://prometheus-community.github.io/helm-charts helm repo add kiali https://kiali.org/helm-charts helm repo update kubectl --context prod-us-east-1 create ns observability --dry-run=client -o yaml | kubectl --context prod-us-east-1 apply -f - helm --kube-context prod-us-east-1 upgrade --install kube-prometheus-stack prometheus-community/kube-prometheus-stack -n observability \\ --set grafana.service.type=LoadBalancer --set prometheus.service.type=LoadBalancer --set alertmanager.service.type=LoadBalancer --wait helm --kube-context prod-us-east-1 upgrade --install kiali kiali/kiali-server -n istio-system --set auth.strategy=anonymous --set service.type=LoadBalancer --wait # EU cluster (repeat with prod-eu-west-1) kubectl --context prod-eu-west-1 create ns observability --dry-run=client -o yaml | kubectl --context prod-eu-west-1 apply -f - helm --kube-context prod-eu-west-1 upgrade --install kube-prometheus-stack prometheus-community/kube-prometheus-stack -n observability \\ --set grafana.service.type=LoadBalancer --set prometheus.service.type=LoadBalancer --set alertmanager.service.type=LoadBalancer --wait helm --kube-context prod-eu-west-1 upgrade --install kiali kiali/kiali-server -n istio-system --set auth.strategy=anonymous --set service.type=LoadBalancer --wait Previous: Part 2 · Next: Part 4\n","wordCount":"421","inLanguage":"en","datePublished":"2025-10-17T09:12:00-07:00","dateModified":"2025-10-19T11:53:26+09:00","author":{"@type":"Person","name":"Memo Garcia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://memo.mx/posts/multi-region-series-part-3-istio/"},"publisher":{"@type":"Person","name":"Memo Garcia","logo":{"@type":"ImageObject","url":"https://memo.mx/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://memo.mx/ accesskey=h title="Memo Garcia (Alt + H)">Memo Garcia</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://memo.mx/labs/ title=Labs><span>Labs</span></a></li><li><a href=https://memo.mx/books/ title=Books><span>Books</span></a></li><li><a href=https://memo.mx/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Multi Region Cloud Training Lab: Part 3 - Istio Multi Region Mesh</h1><div class=post-meta><span title='2025-10-17 09:12:00 -0700 -0700'>October 17, 2025</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Memo Garcia</div></header><div class=post-content><p>Problem: Enable east to west traffic and consistent policy across clusters.</p><p>Assumptions/Constraints</p><ul><li>Cost note: Two clusters stand in for two regions.</li><li>Same <code>meshID</code>, same trust domain, distinct <code>network</code> per cluster.</li></ul><p>ASCII Diagram</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>  Cross cluster via gateway + ServiceEntry (no istioctl)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   +-----------+   mTLS mesh   +-----------+
</span></span><span class=line><span class=cl>   | Cluster US|&lt;=============&gt;| Cluster EU|
</span></span><span class=line><span class=cl>   | istiod    |               | istiod    |
</span></span><span class=line><span class=cl>   | east-west | &lt;---15443---- | east-west |
</span></span><span class=line><span class=cl>   | gateway   |               | gateway   |
</span></span><span class=line><span class=cl>   | echo svc  |               | echo svc  |
</span></span><span class=line><span class=cl>   +-----------+               +-----------+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  meshID=training-mesh, trustDomain=corp.local
</span></span><span class=line><span class=cl>  networks: us-net, eu-net; locality prefers same cluster
</span></span></code></pre></div><p>Steps</p><ol><li>Install Istio on each cluster with matching meshID and trustDomain, unique network.</li><li>Expose an east west gateway in each cluster.</li><li>Configure cross cluster routing using east west gateways and ServiceEntry. No istioctl.</li></ol><p>Example (Helm values excerpt)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># values-istio.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>global</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>meshID</span><span class=p>:</span><span class=w> </span><span class=l>training-mesh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trustDomain</span><span class=p>:</span><span class=w> </span><span class=l>corp.local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>network</span><span class=p>:</span><span class=w> </span><span class=l>us-net </span><span class=w> </span><span class=c># use eu-net in EU cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>pilot</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>PILOT_ENABLE_MULTINETWORK</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span></code></pre></div><p>Install</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># US cluster</span>
</span></span><span class=line><span class=cl>helm upgrade --install istio-base istio/base -n istio-system --create-namespace
</span></span><span class=line><span class=cl>helm upgrade --install istiod istio/istiod -n istio-system -f values-istio.yaml --set global.network<span class=o>=</span>us-net --wait
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># EU cluster</span>
</span></span><span class=line><span class=cl>helm upgrade --install istio-base istio/base -n istio-system --create-namespace --kube-context prod-eu-west-1
</span></span><span class=line><span class=cl>helm upgrade --install istiod istio/istiod -n istio-system -f values-istio.yaml --kube-context prod-eu-west-1 --set global.network<span class=o>=</span>eu-net --wait
</span></span></code></pre></div><p>East west gateway</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>install.istio.io/v1alpha1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>IstioOperator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>eastwest-gw</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>istio-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>profile</span><span class=p>:</span><span class=w> </span><span class=l>empty</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>components</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ingressGateways</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>istio-eastwestgateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>label</span><span class=p>:</span><span class=w> </span>{<span class=w> </span><span class=nt>istio</span><span class=p>:</span><span class=w> </span><span class=l>eastwestgateway }</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>k8s</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>service</span><span class=p>:</span><span class=w> </span>{<span class=w> </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>LoadBalancer }</span><span class=w>
</span></span></span></code></pre></div><p>Cross cluster ServiceEntry (call EU from US through EU gateway)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>networking.istio.io/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ServiceEntry</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>echo-eu-through-gateway</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>echo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo.eu.mesh.local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>addresses</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=m>240.0.0.2</span><span class=l>/32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>number</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>HTTP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resolution</span><span class=p>:</span><span class=w> </span><span class=l>DNS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>location</span><span class=p>:</span><span class=w> </span><span class=l>MESH_EXTERNAL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>&lt;EU_EASTWEST_LB_DNS&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ports</span><span class=p>:</span><span class=w> </span>{<span class=w> </span><span class=nt>http</span><span class=p>:</span><span class=w> </span><span class=m>15443</span><span class=w> </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>locality</span><span class=p>:</span><span class=w> </span><span class=l>eu</span><span class=w>
</span></span></span></code></pre></div><p>Verification/DoD</p><ul><li>From US cluster, <code>curl http://echo.eu.mesh.local</code> returns <code>region=eu</code> through gateway.</li><li>Local traffic continues to prefer local cluster by default.</li></ul><p>Observability install (Helm)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># US cluster</span>
</span></span><span class=line><span class=cl>helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
</span></span><span class=line><span class=cl>helm repo add kiali https://kiali.org/helm-charts
</span></span><span class=line><span class=cl>helm repo update
</span></span><span class=line><span class=cl>kubectl --context prod-us-east-1 create ns observability --dry-run<span class=o>=</span>client -o yaml <span class=p>|</span> kubectl --context prod-us-east-1 apply -f -
</span></span><span class=line><span class=cl>helm --kube-context prod-us-east-1 upgrade --install kube-prometheus-stack prometheus-community/kube-prometheus-stack -n observability <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set grafana.service.type<span class=o>=</span>LoadBalancer --set prometheus.service.type<span class=o>=</span>LoadBalancer --set alertmanager.service.type<span class=o>=</span>LoadBalancer --wait
</span></span><span class=line><span class=cl>helm --kube-context prod-us-east-1 upgrade --install kiali kiali/kiali-server -n istio-system --set auth.strategy<span class=o>=</span>anonymous --set service.type<span class=o>=</span>LoadBalancer --wait
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># EU cluster (repeat with prod-eu-west-1)</span>
</span></span><span class=line><span class=cl>kubectl --context prod-eu-west-1 create ns observability --dry-run<span class=o>=</span>client -o yaml <span class=p>|</span> kubectl --context prod-eu-west-1 apply -f -
</span></span><span class=line><span class=cl>helm --kube-context prod-eu-west-1 upgrade --install kube-prometheus-stack prometheus-community/kube-prometheus-stack -n observability <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set grafana.service.type<span class=o>=</span>LoadBalancer --set prometheus.service.type<span class=o>=</span>LoadBalancer --set alertmanager.service.type<span class=o>=</span>LoadBalancer --wait
</span></span><span class=line><span class=cl>helm --kube-context prod-eu-west-1 upgrade --install kiali kiali/kiali-server -n istio-system --set auth.strategy<span class=o>=</span>anonymous --set service.type<span class=o>=</span>LoadBalancer --wait
</span></span></code></pre></div><p>Previous: <a href=/posts/multi-region-series-part-2-argocd/>Part 2</a> · Next: <a href=/posts/multi-region-series-part-4-identity/>Part 4</a></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://memo.mx/posts/multi-region-series-part-4-identity/><span class=title>« Prev</span><br><span>Multi Region Cloud Training Lab: Part 4 - AWS Identity (IRSA vs Pod Identity)</span>
</a><a class=next href=https://memo.mx/posts/multi-region-series-part-2-argocd/><span class=title>Next »</span><br><span>Multi Region Cloud Training Lab: Part 2 - GitOps with Argo CD</span></a></nav></footer></article></main><footer class=footer></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>